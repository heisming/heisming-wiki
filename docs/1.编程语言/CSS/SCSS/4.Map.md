# Map

Sass 的 map 常常被称为数据地图，也有人称其为数组，因为他总是以**`key:value`**成对的出现，但其更像是一个 **`JSON`** 数据。

```scss
{
  "empoloyees": [
    { "firstName": "John", "lastName": "Doe" },  
    { "firstName": "Anna", "lastName": "Smith" },  
    { "firstName": "Peter", "lastName": "Jones" }
  ]
}
```

 Sass 的 map 长得与 JSON 极其相似：

```scss
$map: (
  $key1: value1,
  $key2: value2,
  $key3: value3
);
```

1、首先有一个类似于 Sass 的变量一样，用个 $ 加上命名空间来声明 map。

2、后面紧接是一个小括号 ()

3、将数据以 `key:value` 的形式赋予，其中 key 和 value 是成对出现

4、并且每对之间使用逗号 (,) 分隔，其中最后一组后面没有逗号。



其中键 key 是用来查找相关联的值 value。使用 map 可以很容易收集键的值和动态插入。

```scss
$default-color: #fff !default;
$primary-color: #22ae39 !default;
```

使用 map 可以更好的进行管理：

```scss
$color: (
  default: #fff,
  primary: #22ae39
);
```

如果哪一天，需要新增加颜色变量值，在 map 中可以非常随意的添加：

```scss
$color: (
    default: #fff,
    primary: #22ae39,
    negative: #d9534f
);
```



## map 嵌套 map

```scss
$map: (
    key1: value1,
    key2: (
        key-1: value-1,
        key-2: value-2,
    ),
    key3: value3
);
```

### 网页换皮肤的项目

```scss
$theme-color: (
    default: (
        bgcolor: #fff,
        text-color: #444,
        link-color: #39f
    ),
    primary:(
        bgcolor: #000,
        text-color:#fff,
        link-color: #93f
    ),
    negative: (
        bgcolor: #f36,
        text-color: #fefefe,
        link-color: #d4e
    )
);
```



## Maps的函数

### map-get(`$map`, `$key`)

根据给定的 $key 值，返回 $map 中相关的值，如果 $key 不存在 $map中，将返回 null 值。

- $map：定义好的 map。
- $key：需要遍历的 key。

```scss
$social-colors: (
  dribble: #ea4c89,
  facebook: #3b5998,
  github: #177575,
  google: #db4437,
  twitter: #55acee
);
```

假设要获取 facebook 键值对应的值 #3b5998，我们就可以使用 map-get() 函数来实现：

```scss
.btn-dribble{
  color: map-get($social-colors, facebook);
}
```

编译出来的CSS：

```css
.btn-dribble {
  color: #3b5998;
}
```

假设 $social-colors 这个 map 没有 $weibo 这个 key:

```scss
.btn-weibo{
  font-size: 12px;
  color: map-get($social-colors, weibo);
}
```

此时编译出来的是CSS：

```css
.btn-weibo {
  font-size: 12px;
}
```

如果 $key 不在 $map 中，不会编译出 CSS

其实在 Sass 中，`map-get($social- colors, weibo)`返回了一个 null 值，也没有任何错误或者警告信息。

**这样不利于排错，解决方案map-has-key**



### map-has-key(`$map`, `$key`)

根据给定的 key 值判断 map 是否有对应的 value 值，如果有返回 true，否则返回 false。

当 $key 不在 $map 中时，使用 `map-get($map, $key)`函数将返回一个 null 值，但对于开发人员，并看不到任何提示信息。

```scss
@if map-has-key($social-colors, facebook) {
  .btn-facebook {
     color: map-get($social-colors, facebook);
  }
} @else {
  @warn "No color found for facebook in $social-colors map. Preoperty committed"
}
```

编译：

```css
.btn-facebook {
  color: #3b5998;
}
```

#### 自定义一个函数

```scss
@function colors($color) {
  @if not map-has-key($social-colors, $color) {
    @warn "No color found for `#{$color}`
  }
  @return map-get($social-colors, $color)
}
```

有了这个函数之后，就可以这样使用

```scss
.btn-dribble {
    color: colors(dribble);
}
.btn-facebook {
    color: colors(facebook);
}
.btn-github {
    color: colors(github);
}
.btn-google {
    color: colors(google);
}
.btn-twitter {
    color: colors(twitter);
}
.btn-weibo {
    color: colors(weibo);
}
```

编译出来的 CSS:

```css
.btn-dribble {
  color: #ea4c89;
}

.btn-facebook {
  color: #3b5998;
}

.btn-github {
  color: #171515;
}

.btn-google {
  color: #db4437;
}

.btn-twitter {
  color: #55acee;
}
```

使用 @each：

```scss
@each $social-network, $social-color in $social-colors {
  .btn-#{$social-network} {
    color: colors($social-network);
  }
}

/*
for({ key, value } in list) {
...
}
*/
```



### map-keys(`$map`)

返回 map 中所有的 key。

这些值赋予给一个变量，那他就是一个列表。

```scss
$list: map-keys($social-colors);
```

相当于：

```scss
$list: "dribble","facebook","github","google","twitter";
```

#### [修改自定义一个函数](#自定义一个函数)

```SCSS
@function colors($color){
    $names: map-keys($social-colors);
    @if not index($names,$color){
        @warn "Waring: `#{$color} is not a valid color name.`";
    }
    @return map-get($social-colors,$color);
}
```

用map-key s将 $social-colors 这个 map 的所有 key 取出，并赋予给一个名 为 $names 的列表。

然后通过 index($names,$color) 返回 $color 在 $names 位置

如果这个位置不存在，将返回提示信息，如果存在将返回正确的值。

```scss
.btn-weibo{
    color: colors(weibo);
}
// Waring: `#{$color} is not a valid color name.`
```

同样，也可以通过 @each 或者 @for 遍历出所有值：

@each:

```SCSS
@each $name in map-keys($social-colors){
    .btn-#{$name}{
        color: colors($name);
    }
}
```

@for:

```SCSS
@for $i from 1 through length(map-keys($social-colors)){
    .btn-#{nth(map-keys($social-colors),$i)} {
        color: colors(nth(map-keys($social-colors),$i));
    }
}
```

虽然使用的方法不一样，但最终得到的 CSS 是一样的：

```CSS
.btn-dribble {
  color: #ea4c89;
}

.btn-facebook {
  color: #3b5998;
}

.btn-github {
  color: #171515;
}

.btn-google {
  color: #db4437;
}

.btn-twitter {
  color: #55acee;
}
```



### map-values(`$map`)

返回 $map中所有的 value值，可以说也将是一个列表。有相同的 value 也将会全部获取出来。

```scss
map-values($social-colors)
```

将会返回：

```scss
#ea4c89,#3b5998,#171515,#db4437,#55acee
```



### map-merge(`$map1`,  `$map2`)

将两个 map 合并成一个新的 map。

```scss
$color: (
    text: #f36,
    link: #f63,
    border: #ddd,
    backround: #fff
);
$typo:(
    font-size: 12px,
    line-height: 1.6
);
```

合并

```scss
$newmap: map-merge($color, $typo);
```

将会生成一个新的 map:

```scss
$newmap:(
    text: #f36,
    link: #f63,
    border: #ddd,
    background: #fff,
    font-size: 12px,
    line-height: 1.6
);
```

`$map1` 和 `$map2` 中有相同的 $key 名，那么将 `$map2` 中的 $key 会取代 `$map1` 中的：

```SCSS
$color: (
    text: #f36,
    link: #f63,
    border: #ddd,
    backround: #fff
);
$typo:(
    font-size: 12px,
    line-height: 1.6,
    border: #ccc,
    background: #000
);
```

执行：

```SCSS
$newmap: map-merge($color,$typo);
```

得到的新 map:

```SCSS
$newmap:(
    text: #f36,
    link: #f63,
    font-size: 12px,
    line-height: 1.6,
    border: #ccc,
    background: #000
);
```



### map-remove(`$map`, `$key`)

从 map 中删除一个 key，返回一个新 map。

```scss
$map:map-remove($social-colors,dribble);
```

返回的是一个新 map:

```scss
$map:(
    facebook: #3b5998,
    github: #171515,
    google: #db4437,
    twitter: #55acee
);
```

如果删除的 key 并不存在于 $map 中，返回的新 map 和以前的 map 一样。

```scss
$map:map-remove($social-colors, weibo);
```

返回的值：

```scss
$map: (
    dribble: #ea4c89,
    facebook: #3b5998,
    github: #171515,
    google: #db4437,
    twitter: #55acee
);
```



### keywords(`$args`)

返回一个函数的参数，这个参数可以动态的设置 key 和 value。

可以通过混合宏或函数的参数变创建 map。

参数也是成对出现，其中 `$args` 变成 key(会自动去掉$符号)，而 `$args` 对应的值就是value。

```scss
@mixin map($args...) {
  @debug keywords($args);
}
@include map (
  $dribble: #ea4c89,
  $facebook: #3b5998,
  $github: #171515,
  $google: #db4437,
  $twitter: #55acee
)
```

在命令终端可以看到一个输入的 @debug 信息：

```sh
 DEBUG: (dribble: #ea4c89, facebook: #3b5998, github: #171515, google: #db4437, twitter: #55acee)
```