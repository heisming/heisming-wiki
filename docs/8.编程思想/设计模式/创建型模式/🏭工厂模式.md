# ğŸ­å·¥å‚æ¨¡å¼

## å®šä¹‰
å·¥å‚æ¨¡å¼æ˜¯ç”±ä¸€ä¸ªæ–¹æ³•æ¥å†³å®šåˆ°åº•è¦åˆ›å»ºå“ªä¸ªç±»çš„å®ä¾‹ï¼Œè€Œè¿™äº›å®ä¾‹ç»å¸¸éƒ½æ‹¥æœ‰ç›¸åŒçš„æ¥å£ã€‚è¿™ç§æ¨¡å¼ä¸»è¦ç”¨åœ¨æ‰€å®ä¾‹åŒ–çš„ç±»å‹åœ¨ç¼–è¯‘æœŸå¹¶ä¸èƒ½ç¡®å®šï¼Œè€Œæ˜¯åœ¨æ‰§è¡ŒæœŸå†³å®šçš„æƒ…å†µã€‚

## ç”Ÿæ´»ä¸­çš„ä¾‹å­
è¯•æƒ³ä½ å»éº¦å½“åŠ³ä¹°ä¸€ä¸ªæ±‰å ¡ã€‚ä½ åªéœ€è¦å‘Šè¯‰æ”¶é“¶å‘˜è¦ä¸€ä¸ªxxæ±‰å ¡ã€‚è¿‡ä¸€ä¼šå°±ä¼šæœ‰ä¸€ä¸ªæ­¤ç±»å‹çš„æ±‰å ¡è¢«åˆ¶ä½œå‡ºæ¥ã€‚è€Œä½ å®Œå…¨ä¸éœ€è¦çŸ¥é“è¿™ä¸ªæ±‰å ¡æ˜¯æ€ä¹ˆè¢«åˆ¶ä½œå‡ºæ¥çš„ã€‚è¿™ä¸ªä¾‹å­ä¸­ä½ å°±æ˜¯å®¢æˆ·ç«¯ä»£ç ï¼Œéº¦å½“åŠ³å°±æ˜¯å·¥å‚ï¼Œè´Ÿè´£ç”Ÿäº§æ±‰å ¡ã€‚æ±‰å ¡æ˜¯æ¥å£ï¼Œè€Œå…·ä½“çš„æŸä¸€ç§æ±‰å ¡ï¼Œæ¯”å¦‚è¯´é¦™è¾£é¸¡è…¿å ¡ï¼Œå°±æ˜¯å®ç°äº†æ±‰å ¡æ¥å£çš„ç±»ã€‚

## åˆ†ç±»
- ç®€å•å·¥å‚
- å·¥å‚æ–¹æ³•

## åŒºåˆ«
ç®€å•å·¥å‚æ˜¯å°†åˆ›å»ºå¯¹è±¡çš„æ­¥éª¤æ”¾åœ¨çˆ¶ç±»è¿›è¡Œï¼Œå·¥å‚æ–¹æ³•ä½¿å»¶è¿Ÿåˆ°å­ç±»åœ¨è¿›è¡Œï¼Œå®ƒä»¬ä¸¤è€…éƒ½å¯ä»¥æ€»ç»“ä¸ºï¼š`æ ¹æ®ä¼ å…¥çš„å­—ç¬¦ä¸²æ¥é€‰æ‹©å¯¹åº”çš„ç±»`

## å®ç°
### ç®€å•å·¥å‚
```js
var UserFactory = function(role) {
  function Admin() {
    this.name = "ç®¡ç†å‘˜"
    this.viewpage = ["é¦–é¡µ", "æŸ¥è¯¢", "æƒé™ç®¡ç†"]
  }
  function User() {
    this.name = "æ™®é€šç”¨æˆ·"
    this.viewPage = ["é¦–é¡µ"ï¼Œ "æŸ¥è¯¢"]
  }
  switch(role) {
    case: 'admin':
      return new Admin();
      break;
    case: 'user':
      return new User();
      break;
    default:
      throw new Error('å‚æ•°é”™è¯¯ï¼Œå¯é€‰å‚æ•°: adminã€user');
  }
}
// admin.nameå¯ä»¥ä¿®æ”¹å€¼ï¼Œè¿™æ ·æ˜¯ä¸å®‰å…¨çš„
var admin = UserFactory('admin');
var user = UserFactory('user');
```

### å·¥å‚æ–¹æ³•
```js
// å®‰å…¨æ¨¡å¼åˆ›å»ºçš„å·¥å‚æ–¹æ³•å‡½æ•°
var UserFactory = function(role) {
  if(this instanceof UserFactory) {
    var s = new this[role]();
    return s;
  } else {
    return new UserFactory(role);
  }
}
// å·¥å‚æ–¹æ³•å‡½æ•°çš„åŸå‹ä¸­è®¾ç½®æ‰€æœ‰å¯¹è±¡çš„æ„é€ å‡½æ•°
UserFactory.prototype = {
   Admin: function() {
     this.name = "ç®¡ç†å‘˜"
     this.viewpage = ["é¦–é¡µ", "æŸ¥è¯¢", "æƒé™ç®¡ç†"]
   },
   User: function() {
     this.name = "ç”¨æˆ·"
     this.viewpage = ["é¦–é¡µ", "æŸ¥è¯¢"]
   }
}
// æ‰§è¡Œä¸Šä¸‹æ–‡æ˜¯windowå¯¹è±¡
var admin = UserFactory('Admin')
var user = UserFactory('User')
admin instanceof UserFactory // false
```

### å†æ¥ä¸€ä¸ªTSçš„
```ts
interface Product {
  operation(): string;
}

abstract class Creator {
  public abstract factoryMethod(): Product
  public someOperation(): string {
    // thisæŒ‡å‘ï¼Ÿ
    const product = this.factoryMethod();
    return `Creator: The same creator's code has just worked with ${product.operation()}`;
  }
}

class ConcreteCreator1 extends Creator {
  public factoryMethod(): Product {
    return new ConcreteProduct1();
  }
}

class ConcreteCreator2 extends Creator {
  public factoryMethod(): Product {
    return new ConcreteProduct2();
  }
}

class ConcreteProduct1 implements Product{
  public operation(): string {
    return '{Result of the ConcreteProduct1}';
  }
}

class ConcreteProduct2 implements Product{
  public operation(): string {
    return '{Result of the ConcreteProduct2}';
  }
}

function clientCode(creator: Creator) {
  // ...
  console.log('Client: I\'m not aware of the creator\'s class, but it still works.');
  console.log(creator.someOperation());
  // ...
}

console.log('App: Launched with the ConcreteCreator1.');
clientCode(new ConcreteCreator1());
console.log('');

console.log('App: Launched with the ConcreteCreator2.');
clientCode(new ConcreteCreator2());
```

## é€‚åˆåº”ç”¨åœºæ™¯
- å½“ä½ åœ¨ç¼–å†™ä»£ç çš„è¿‡ç¨‹ä¸­ï¼Œ å¦‚æœæ— æ³•é¢„çŸ¥å¯¹è±¡ç¡®åˆ‡ç±»åˆ«åŠå…¶ä¾èµ–å…³ç³»æ—¶ï¼Œ å¯ä½¿ç”¨å·¥å‚æ–¹æ³•ã€‚

å·¥å‚æ–¹æ³•å°†åˆ›å»ºäº§å“çš„ä»£ç ä¸å®é™…ä½¿ç”¨äº§å“çš„ä»£ç åˆ†ç¦»ï¼Œ ä»è€Œèƒ½åœ¨ä¸å½±å“å…¶ä»–ä»£ç çš„æƒ…å†µä¸‹æ‰©å±•äº§å“åˆ›å»ºéƒ¨åˆ†ä»£ç ã€‚
ä¾‹å¦‚ï¼Œ å¦‚æœéœ€è¦å‘åº”ç”¨ä¸­æ·»åŠ ä¸€ç§æ–°äº§å“ï¼Œ ä½ åªéœ€è¦å¼€å‘æ–°çš„åˆ›å»ºè€…å­ç±»ï¼Œ ç„¶åé‡å†™å…¶å·¥å‚æ–¹æ³•å³å¯ã€‚

## âœ”Demoï¼ˆå¾ªåºæ¸è¿›ï¼‰
### éŸ³ä¹æ¨èå™¨1.0ç‰ˆæœ¬
éœ€æ±‚ï¼šæ˜¯èƒ½å¤Ÿæ ¹æ®ç”¨æˆ·é€‰æ‹©çš„éŸ³ä¹é£æ ¼ï¼Œæ¨èä¸åŒé£æ ¼çš„æ­Œæ›²æ¸…å•ã€‚
```ts
class RecommendMusicService {
  recommend(style: string): Array<string> {
    const recommendMusicList: string[] = []
    switch(style) {
      case 'metal':
        recommendMusicList.push("Don't cry")
        break;
      case 'country':
        recommendMusicList.push("Hotel california")
        break;
      case 'grunge':
        recommendMusicList.push("About a girl")
        break;
      default:
        recommendMusicList.push("My heart will go on")
        break;
    }
    return recommendMusicList
  }
}
```
recommed æ–¹æ³•å¤ªé•¿äº†ï¼Œé‡æ„ä¸‹ï¼ŒæŠŠæ¯ç§éŸ³ä¹é£æ ¼çš„æ¨èé€»è¾‘å°è£…åˆ°ç›¸åº”çš„æ–¹æ³•ä¸­ã€‚è¿™æ ·æ¨èæ–¹æ³•å°±å¯ä»¥å¤ç”¨äº†ã€‚
```ts
class RecommendMusicService {
  recommend(style: string): Array<string> {
    const recommendMusicList: string[] = []
    switch(style) {
      case 'metal':
        this.recommendMetal(recommendMusicList)
        break;
      case 'country':
        this.recommendCountry(recommendMusicList)
        break;
      case 'grunge':
        this.recommendGrunge(recommendMusicList)
        break;
      default:
        this.recommendPop(recommendMusicList)
        break;
    }
    return recommendMusicList
  }

  private recommendPop(recommendMusicList: Array<string>): void {
    recommendMusicList.push("My heart will go on")
    recommendMusicList.push("Beat it")
  }
  private recommendGrunge(recommendMusicList: Array<string>): void {
    recommendMusicList.push("About a girl")
    recommendMusicList.push("Smells like teen spirit")
  }
  private recommendCountry(recommendMusicList: Array<string>): void {
    recommendMusicList.push("Hotel california")
    recommendMusicList.push("Take Me Home Country Roads")
  }
  private recommendMetal(recommendMusicList: Array<string>): void {
    recommendMusicList.push("Don't cry")
    recommendMusicList.push("Fade to black")
  }
}
```
ç°åœ¨å¥½äº†ï¼Œä½†æ˜¯è¿åäº†è®¾è®¡æ¨¡å¼6å¤§åŸåˆ™çš„å¼€é—­åŸåˆ™----å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚
é¢å¯¹æ–°é£æ ¼æ¨èçš„éœ€æ±‚ï¼Œæˆ‘ä»¬ä¸€ç›´éƒ½åœ¨ä¿®æ”¹ RecommendMusicService è¿™ä¸ªç±»ã€‚ä»¥åæ¯æ¬¡æœ‰æ–°é£æ ¼æ¨èè¦æ·»åŠ ï¼Œéƒ½ä¼šå¯¼è‡´ä¿®æ”¹ RecommendMusicService ã€‚
é‚£ä¹ˆå¦‚ä½•åšåˆ°å®ç°æ–°çš„é£æ ¼æ¨èéœ€æ±‚æ—¶ï¼Œæ»¡è¶³å¼€é—­åŸåˆ™å‘¢ï¼Ÿ

### éŸ³ä¹æ¨èå™¨2.0ç‰ˆæœ¬
æ·»åŠ æ–°éœ€æ±‚æ—¶ï¼Œå¦‚ä½•åšåˆ°ä¸ä¿®æ”¹ï¼Œå»æ‰©å±•ï¼Ÿæ˜¯ä¸æ˜¯æƒ³åˆ°äº†å•ä¸€èŒè´£ï¼Ÿæ˜¯çš„ï¼Œç±»çš„èŒè´£è¶Šå•ä¸€ï¼Œé‚£ä¹ˆå®ƒå°±è¶Šç¨³å®šã€‚RecommendMusicService ç±»çš„èŒè´£å¤ªå¤šäº†ï¼Œè´Ÿè´£nç§é£æ ¼çš„æ¨èã€‚OKï¼Œé‚£ä¹ˆæˆ‘ä»¬ç¬¬ä¸€ä»¶äº‹å°±æ˜¯è¦å‡å°‘ RecommendMusicService ç±»çš„èŒè´£ï¼ŒæŠŠæ¯ç§ä¸åŒé£æ ¼çš„æ¨èæå–åˆ°ä¸åŒçš„ç±»å½“ä¸­ã€‚
æ¯”å¦‚MetalMusicRecommendServiceã€PopMusicRecommendServiceã€CountryMusicRecommendServiceã€‚è¿™äº›ç±»éƒ½å¯ä»¥é€šè¿‡ recommed æ–¹æ³•ç”Ÿæˆæ¨èçš„æ­Œæ›²æ¸…å•ã€‚è€Œ RecommendMusicService ç±»åªæ˜¯é€šè¿‡è°ƒç”¨ä¸åŒ MusicRecommendService çš„ recommed æ–¹æ³•æ¥å®ç°æ¨èã€‚ä»£ç å¦‚ä¸‹ï¼š

```ts
class CountryMusicRecommendService {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("Hotel california")
    recommendMusicList.push("Take Me Home Country Roads")
    return recommendMusicList
  }
}

class GrungeMusicRecommendService {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("About a girl")
    recommendMusicList.push("Smells like teen spirit")
    return recommendMusicList
  }
}

class PopMusicRecommendService {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("My heart will go on")
    recommendMusicList.push("Beat it")
    return recommendMusicList
  }
}

class MetalMusicRecommendService {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("Don't cry")
    recommendMusicList.push("Fade to black")
    return recommendMusicList
  }
}

class RecommendMusicService {
  private countryMusicRecommendService = new CountryMusicRecommendService()
  private grungeMusicRecommendService = new GrungeMusicRecommendService()
  private popMusicRecommendService = new PopMusicRecommendService()
  private metalMusicRecommendService = new MetalMusicRecommendService()

  recommend(style: string) {
    let recommendMusicList: string[] = []
    switch(style) {
      case 'metal':
        recommendMusicList = this.metalMusicRecommendService.recommend()
        break;
      case 'country':
        recommendMusicList = this.countryMusicRecommendService.recommend()
        break;
      case 'grunge':
        recommendMusicList = this.grungeMusicRecommendService.recommend()
        break;
      default:
        recommendMusicList = this.popMusicRecommendService.recommend()
        break;
    }
    return recommendMusicList;
  }
}

console.log(new RecommendMusicService().recommend(""));
```
æ”¹é€ åï¼Œå¦‚æœæœ‰äº†æ–°éŸ³ä¹é£æ ¼æ¨èçš„éœ€æ±‚ï¼Œåªéœ€è¦å¢åŠ ç›¸åº”çš„ xxxMusicRecommendService ç±»ã€‚ç„¶ååœ¨ RecommendMusicService ä¸­å¢åŠ ç›¸åº”åˆ†æ”¯å³å¯ã€‚è¿™æ ·å°±åšåˆ°äº†å¼€é—­åŸåˆ™ã€‚é‚£ä¹ˆè¿˜æœ‰ä»€ä¹ˆè¿èƒŒè®¾è®¡åŸåˆ™çš„åœ°æ–¹å—ï¼ŸRecommendMusicService æ˜¯ä¸æ˜¯ä¾èµ–çš„ xxMusicRecommendService ç±»å¤ªå¤šäº†ï¼Ÿ
æ²¡é”™ï¼Œè€Œä¸”è¿™ä¹ˆå¤šç±»ï¼Œå®é™…ä¸Šéƒ½æ˜¯åšæ¨èçš„äº‹æƒ…ï¼Œä¸”éƒ½æ˜¯é€šè¿‡ recommend æ–¹æ³•æä¾›æ¨èç»“æœã€‚è¿™å®Œå…¨å¯ä»¥æŠ½è±¡å‡ºæ¥å£ï¼Œæ¯”å¦‚ MusicRecommendInterfaceã€‚é‚£ä¹ˆ RecommendMusicService ä¾èµ– MusicRecommendInterface å°±å¯ä»¥äº†ã€‚è¿™è§£å†³äº†ä¾èµ–åè½¬é—®é¢˜----**åº”è¯¥ä¾èµ–æ¥å£ï¼Œè€Œä¸æ˜¯ä¾èµ–å…·ä½“å®ç°**ã€‚
å•ä¸€èŒè´£å’Œä¾èµ–åè½¬åŸåˆ™ã€‚ä¾èµ– MusicRecommendInterface æ²¡é—®é¢˜ï¼Œä½†æ˜¯ä¸åŒçš„éŸ³ä¹é£æ ¼ï¼Œæ€ä¹ˆèƒ½å®ä¾‹åŒ– MusicRecommendInterface çš„æŸä¸ªå…·ä½“å®ç°å‘¢ï¼Ÿå·¥å‚æ¨¡å¼äºæ˜¯å°±åº”è¿è€Œç”Ÿäº†ï¼

### éŸ³ä¹æ¨èå™¨3.0ç‰ˆæœ¬
å·¥å‚æ¨¡å¼è§£å†³çš„æ˜¯ç±»çš„å®ä¾‹åŒ–ã€‚æ— è®ºä½ éœ€è¦å“ªç§é£æ ¼çš„ MusicRecommendServiceï¼Œåªéœ€è¦å‘Šè¯‰å·¥å‚ï¼Œå·¥å‚ä¼šç»™ä½ å®ä¾‹åŒ–å¥½ä½ éœ€è¦çš„å…·ä½“å®ç°ã€‚è€Œå·¥å‚èƒ½åšåˆ°è¿™äº›æ˜¯åŸºäºç»§æ‰¿å’Œå¤šæ€ã€‚
RecommendMusicService åªéœ€è¦ä¾èµ– MusicRecommendInterfaceï¼Œå…·ä½“éœ€è¦å“ªä¸ªMusicRecommendService çš„å®ç°ï¼Œåªéœ€è¦å‘Šè¯‰ RecommendServiceFactory å³å¯ã€‚MusicRecommendService æ‹¿åˆ°å…·ä½“çš„å®ç°åè°ƒç”¨å®ƒçš„ recommand æ–¹æ³•ï¼Œå°±å¯ä»¥å¾—åˆ°ç›¸åº”é£æ ¼çš„æ¨èæ­Œæ›²æ¸…å•ã€‚
é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰æ‰€æœ‰ MusicRecommendService è¦å®ç°çš„æ¥å£ï¼Œå¾ˆç®€å•ï¼Œåªæœ‰ä¸€ä¸ª recommend æ–¹æ³•ï¼š

```ts
interface MusicRecommendInterface {
  recommend() : Array<string>;
}

class CountryMusicRecommendService implements MusicRecommendInterface {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("Hotel california")
    recommendMusicList.push("Take Me Home Country Roads")
    return recommendMusicList
  }
}

class GrungeMusicRecommendService implements MusicRecommendInterface {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("About a girl")
    recommendMusicList.push("Smells like teen spirit")
    return recommendMusicList
  }
}

class PopMusicRecommendService implements MusicRecommendInterface {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("My heart will go on")
    recommendMusicList.push("Beat it")
    return recommendMusicList
  }
}

class MetalMusicRecommendService implements MusicRecommendInterface {
  recommend(): Array<string> {
    const recommendMusicList: string[] = []
    recommendMusicList.push("Don't cry")
    recommendMusicList.push("Fade to black")
    return recommendMusicList
  }
}

// å·¥å‚æ¨¡å¼ä¸­çš„å·¥å‚ä»£ç äº†
class MusicRecommendServiceFactory {
  createMusicRecommend(style: string): MusicRecommendInterface {
    switch (style) {
      case 'metal':
        return new MetalMusicRecommendService()
      case 'country':
        return new CountryMusicRecommendService()
      case 'grunge':
        return new GrungeMusicRecommendService()
      default:
        return new PopMusicRecommendService()
    }
  }
}

console.log(new MusicRecommendServiceFactory().createMusicRecommend("").recommend())
```
>å·¥å‚æ¨¡å¼è§£å†³çš„æ˜¯ç±»çš„å®ä¾‹åŒ–é—®é¢˜ã€‚

![](assets/images/0.png)




## æ¦‚å¿µ
åœ¨çˆ¶ç±»ä¸­æä¾›ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æ–¹æ³•,å…è®¸å­ç±»å†³å®šå®ä¾‹åŒ–å¯¹è±¡çš„ç±»å‹ã€‚

> é‡åˆ°new Classçš„åœ°æ–¹ï¼Œå°±è¦è€ƒè™‘å·¥å‚æ¨¡å¼
- å·¥å‚æ–¹æ³•
- æŠ½è±¡å·¥å‚
- å»ºé€ è€…
åˆ›å»ºå¯¹è±¡çš„ä¸€ç§æ–¹å¼ã€‚ä¸ç”¨æ¯æ¬¡éƒ½äº²è‡ªåˆ›å»ºå¯¹è±¡ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªæ—¢å®šçš„â€œå·¥å‚â€æ¥ç”Ÿäº§å¯¹è±¡ã€‚

ç°åœ¨ä½ æƒ³è¦ä¹°ä¸€ä¸ªæ±‰å ¡ï¼Œä½ æ˜¯å»KFCä¹°ä¸€ä¸ªï¼Œè¿˜æ˜¯è‡ªå·±åŠ¨æ‰‹åšä¸€ä¸ªå‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜ï¼ŒæœåŠ¡å‘˜å°±æ˜¯å·¥å‚æ–¹æ³•ï¼Œè€ŒåŠ¨æ‰‹åšä¸€ä¸ªå…¶å®å°±æ˜¯`new Hamburg()`ã€‚
å¦å¤–ï¼Œä»å¿«é¤åº—è€ƒè™‘ï¼Œä½ æƒ³è¦ç”Ÿäº§é¦™è¾£é¸¡è…¿å ¡ï¼Œæ˜¯è®©æœåŠ¡å‘˜åšå‡ºæ¥`new Hamburg()`ç»™åˆ°å®¢æˆ·ï¼Œè¿˜æ˜¯è®©å®¢æˆ·è‡ªå·±åšä¸€ä¸ªæ±‰å ¡å‘¢ï¼Ÿ

ä¼ªä»£ç 
OOPä¸­ï¼Œé»˜è®¤åˆ›å»ºå¯¹è±¡ä¸€èˆ¬æ˜¯new classï¼Œä½†æ˜¯ä¸€äº›æƒ…å†µä¸‹ç”¨new classä¼šå¾ˆä¸æ–¹ä¾¿
```js
let f1
class Foo()

if (a) { f1 = Foo(x) }
if (b) { f2 = Foo(x, y) }
``` 
æ­¤æ—¶å°±éœ€è¦ä¸€ä¸ªâ€œå·¥å‚â€ï¼ŒæŠŠåˆ›å»ºè€…å’Œclassåˆ†ç¦»ï¼Œç¬¦åˆå¼€æ”¾å°é—­åŸåˆ™ã€‚
```js
function create(a, b) {
  if (a) { return Foo(x)}
  if (b) { return Foo(x, y)}
}
const f1 = create(a, b)
```

æ³¨æ„ï¼šå·¥å‚æ¨¡å¼å¯ä»¥æ‹†åˆ†ä¸‰ä¸ªï¼š
- å·¥å‚æ–¹æ³•æ¨¡å¼
- æŠ½è±¡å·¥å‚æ¨¡å¼
- å»ºé€ è€…æ¨¡å¼

### ç®€æ˜“å·¥å‚æ¨¡å¼
```ts
class Product {
  name: string
  constructor(name: string) {
    this.name = name
  }
  fn1() {
    alert('product fn1')
  }
  fn2() {
    alert('product fn2')
  }
}

class Creator {
  create(name): Product {
    return new Product(name)
  }
}

const creator = new Creator()
const p1 = creator.create('p1')
const p2 = creator.create('p2')
```

[ç®€æ˜“å·¥å‚](./assets/drowio/simple_factory_mode.drawio ':include :type=code')


### æ ‡å‡†çš„å·¥å‚æ¨¡å¼

```ts
type FnType = () => void

interface IProduct {
    name: string;
    fn1: FnType;
    fn2: FnType;
}

class Product1 implements IProduct {
    name: string
    constructor(name: string) {
        this.name = name
    }
    fn1() {
        alert('product1 fn1')
    }
    fn2() {
        alert('product1 fn2')
    }
}

class Product2 implements IProduct {
    name: string
    constructor(name: string) {
        this.name = name
    }
    fn1() {
        alert('product2 fn1')
    }
    fn2() {
        alert('product2 fn2')
    }
}

class Creator {
    // ä¾èµ–å€’ç½®åŸåˆ™ï¼ˆå¦‚æœåªè¿”å›Product1æ˜¯æ— æ³•è¿”å›Product2çš„ï¼‰
    create(type: string, name: string): IProduct {
        // new æ—¶å€™çš„é€»è¾‘
        if (type === 'p1') return new Product1(name);
        if (type === 'p2') return new Product2(name);
        throw new Error('Invalid type')
    }
}

const creator = new Creator()
const p1 = creator.create('p1', 'name1')
const p2 = creator.create('p2', 'name2')
```

[æ ‡å‡†å·¥å‚](./assets/drowio/nomral_factory_mode.drawio ':include :type=code')


**æ˜¯å¦ç¬¦åˆè®¾è®¡åŸåˆ™ï¼Ÿ**
6å¤§è®¾è®¡åŸåˆ™ä¸­ï¼Œæœ€é‡è¦çš„å°±æ˜¯ï¼šå¼€æ”¾å°é—­åŸåˆ™ï¼Œå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
- å·¥å‚å’Œç±»åˆ†ç¦»ï¼Œè§£è€¦
- å¯ä»¥æ‰©å±•å¤šä¸ªç±»ï¼ˆæ´¾ç”Ÿç±»ï¼Œæˆ–å¹³è¡Œçš„ç±»ï¼‰
- å·¥å‚çš„åˆ›å»ºé€»è¾‘ä¹Ÿå¯ä»¥è‡ªç”±æ‰©å±•

### åœºæ™¯
#### jQuery $
```html
<body>
  <p>demo1</p>
  <p>demo2</p>
  <p>demo3</p>
</body>
```

```ts
// æ‰©å±•windowï¼ˆå…¨å±€ï¼‰çš„å±æ€§
// ä¿®æ”¹é”™è¯¯
declare interface Window {
    $: (selector: string) => JQuery
}

class JQuery {
    selector: string
    length: number
    constructor(selector: string) {
        // å°†ç±»æ•°ç»„è½¬æ¢ä¸ºæ•°ç»„
        const domList = Array.prototype.slice.call(document.querySelectorAll(selector))
        const length = domList.length
        for(let i = 0; i < length; i++) {
            // @ts-ignore
            // ä¿®æ”¹é”™è¯¯
            this[i] = domList[i];
        }
        this.selector = selector;
        this.length = length
    }
    append(elem: HTMLElement): JQuery {
        // append çš„æ“ä½œ
        return this;
    }
    addClass(className: string): JQuery {
        // addClass çš„æ“ä½œ
        return this;
    },
    html(htmlStr: string) : JQuery | string {
      if (htmlStr) {
        // set html
        return this
      } else {
        // get html
        const html = 'xxx'
        return html
      }
    }
    // ... methods ...
}

// ä¿®æ”¹é”™è¯¯
function $(selector: string) {
    return new JQuery(selector) 
}
const $div = $('div');
const $p = $('p');
window.$ = $;
console.log($('p'))


// ä¸ç”¨å·¥å‚
// const $div = new JQuery('div')

// å·¥å‚æ¨¡å¼
// window.$ = (selector: string) => {
//     // é€»è¾‘å°è£…ä»£ç ...
//     return new JQuery(selector)
// }


// ä¼ªä»£ç   æ¼”ç¤ºJQueryçš„å®ä¾‹ç»“æ„
const jquery = {
    '0': div1, 
    '1': div2, 
    '2': div3,
    length: 3,
    selector : 'div',
}
```
åšä¸€ä¸ªå¯¹æ¯”ï¼Œå¦‚æœå¼€æ”¾ç»™ç”¨æˆ·çš„ä¸æ˜¯$,ç„¶åè®©ç”¨æˆ·è‡ªå·±å»`new JQuery(selector)`,å¸¦æ¥çš„é—®é¢˜ï¼š
- ä¸æ–¹ä¾¿é“¾å¼æ“ä½œï¼Œå¦‚`$('div').append($('$p1')).html()`
- ä¸å®œå°†æ„é€ å‡½æ•°æš´éœ²ç»™ç”¨æˆ·ï¼Œå°½é‡é«˜å†…èšã€ä½è€¦åˆ

#### Vue _createElementVNode
Vueï¼ˆtemplateæ¨¡æ¿ï¼‰å’ŒReactï¼ˆJSXï¼‰æœ¬è´¨æ˜¯è¯­æ³•ç³–ï¼Œè½¬åŒ–ä¸ºrenderå‡½æ•°ï¼Œå†è½¬åŒ–ä¸ºVNode(Vue._createElementVNodeã€Vue._createElementBlock/React.createElementç­‰)ï¼Œç„¶åè¿›è¡Œdiffç®—æ³•å¯¹æ¯”å®Œä¹‹åï¼Œä¼šè½¬æ¢ä¸ºçœŸå®PDOMæ¸²æŸ“ä¸ºé¡µé¢ã€‚
[Vue Template Explorer](https://template-explorer.vuejs.org/#eyJzcmMiOiI8ZGl2PlxyXG4gIDxzcGFuPumdmeaAgeaWh+acrDwvc3Bhbj5cclxuICA8c3BhbiA6aWQ9XCJoZWxsb1wiIGNsYXNzPVwiYmFyXCI+e3sgbXNnIH19PC9zcGFuPlxyXG48L2Rpdj4iLCJvcHRpb25zIjp7fX0=)
```html
<div>
  <span>é™æ€æ–‡æœ¬</span>
  <span :id="hello" class="bar">{{ msg }}</span>
</div>
```
```js
import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, openBlock as _openBlock, createElementBlock as _createElementBlock } from "vue"

export function render(_ctx, _cache, $props, $setup, $data, $options) {
  return (_openBlock(), _createElementBlock("div", null, [
    _createElementVNode("span", null, "é™æ€æ–‡æœ¬"),
    _createElementVNode("span", {
      id: _ctx.hello,
      class: "bar"
    }, _toDisplayString(_ctx.msg), 9 /* TEXT, PROPS */, ["id"])
  ]))
}

// Check the console for the AST
```
#### React createElement
[babel](https://babel.docschina.org/repl/#?browsers=defaults%2C%20not%20ie%2011%2C%20not%20ie_mob%2011&build=&builtIns=false&spec=false&loose=false&code_lz=MYewdgzgLgBADgJxAMwJYBsCmMC8MA8AJqgG4B8AUDAagLYDmMECwOARAB5cB0cY9basHQBDCBAByI2pnZ16ARjYB6StXwALAMxkA3jADaAVwiYE3NAmhSZAGhgmz3UdemYAutwBWIVGAAUAOQwgQCUMAC--MralNHE5EA&debug=false&forceAllTransforms=false&shippedProposals=false&circleciRepo=&evaluate=true&fileSize=false&timeTravel=false&sourceType=module&lineWrap=true&presets=env%2Creact%2Cenv&prettier=false&targets=&version=7.19.5&externalPlugins=)

```jsx
const profile = <div>
  <img src="xxx.png"  className="img1"/>
  <h3>{ [user.firstName, user.lastName].join(' ') }</h3>
</div>
```
```js
// è¿”å›VNode
"use strict";

const profile = /*#__PURE__*/React.createElement("div", null, /*#__PURE__*/React.createElement("img", {
  src: "xxx.png",
  className: "img1"
}), /*#__PURE__*/React.createElement("h3", null, [user.firstName, user.lastName].join(' ')));
```

ä¼ªä»£ç 
```js
// a
new VNode()

// b
new VNode()

// c
new VNode()

// ä½¿ç”¨å·¥å‚æ¨¡å¼
function createElement() {
  return VNode()
}

createElement(a)
createElement(b)
createElement(c)
```
```js
class VNode(tag, attrs, children) {
  // ...
}
React.createElement = function (tag, attrs, children) {
  return new VNode(tag, attrs, children)
}
```
## Demo
```ts
interface IAniaml {
   legs: number
   eyes: number
   ears? :number
   cry: () => void
   fly?: () => void
   eat: (food: string) => string
}

class Dog implements IAniaml {
   legs: number
   eyes: number
   ears: number
   constructor(legs: number, eyes: number, ears: number) {
       this.legs = legs;
       this.eyes = eyes;
       this.ears = ears;
   }
   cry () {
       alert('The little dog can wang wang');
   }
   eat (food: string) {
       if (food === 'éª¨å¤´') {
           return 'æˆ‘å–œæ¬¢åƒ'
       } else {
           return 'æˆ‘ä¸å–œæ¬¢åƒ'
       }
   }
}
class Bird implements IAniaml {
   legs: number
   eyes: number
   constructor(legs: number, eyes: number) {
       this.legs = legs;
       this.eyes = eyes;
   }
   cry() {
       alert('å½å½å–³å–³')
   }
   eat(food: string) {
       if (food === 'ç¨»å­') {
           return 'å¥½åƒ'
       } else {
           return 'å¯èƒ½å¥½åƒ'
       }
   }
}
class Creator {
   create(className: string, legs: number, eyes: number, ears: number): IAniaml {
       if (className === 'dog') return new Dog(legs, eyes, ears);
       if (className === 'bird') return new Bird(legs, eyes);
       return new Bird(legs, eyes);
   }
}

const creator = new Creator();
const dog = creator.create('dog', 4, 2, 2);
const bird = creator.create('bird', 2, 2, 0);
```
