# ES6
## letå’Œconstå…³é”®å­—
å…¶å®åœ¨ES6ä¹‹å‰ï¼Œåªå­˜åœ¨å…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œå¹¶ä¸å­˜åœ¨å—çº§ä½œç”¨åŸŸï¼Œè¿™å°±ä¼šå¯¼è‡´å˜é‡æå‡çš„é—®é¢˜ã€‚
å˜é‡æå‡å¾€å¾€ä¼šå› ä¸ºå¾—åˆ°ä¸€äº›å‡ºä¹æ„æ–™çš„ç»“æœè€Œå—äººè¯Ÿç—…ï¼Œæ‰€ä»¥åœ¨ES6ä¸­æ–°å¢äº†å—çº§ä½œç”¨åŸŸæ¥é¿å…è¿™ä¸ªé—®é¢˜çš„å‡ºç°ã€‚

> å—çº§ä½œç”¨åŸŸè¡¨ç¤ºçš„æ˜¯å®šä¹‰çš„å˜é‡å¯æ‰§è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒåªèƒ½åœ¨ä¸€ä¸ªä»£ç å—ä¸­ï¼Œä¸€ä¸ªä»£ç å—ç”±ä¸€ä¸ªå¤§æ‹¬å·æ‹¬ä½çš„ä»£ç æ„æˆï¼Œè¶…å‡ºè¿™ä¸ªä»£ç å—èŒƒå›´å°†æ— æ³•è®¿é—®å†…éƒ¨çš„å˜é‡ã€‚

Demo
```js
{
  let a = 1;
  console.log(a); // 1
}
console.log(a); // ReferenceError: a is not defined
```
å½“æˆ‘ä»¬ä½¿ç”¨letå…³é”®å­—å®šä¹‰ä¸€ä¸ªå˜é‡aåï¼Œèƒ½å¤Ÿåœ¨ä»£ç å—ä¸­è¾“å‡ºå˜é‡açš„å€¼ï¼Œä½†æ˜¯åœ¨ä»£ç å—å¤–è®¿é—®æ—¶ä¼šæŠ›å‡ºaæœªå®šä¹‰çš„å¼‚å¸¸ã€‚

### letå…³é”®å­—
letå…³é”®å­—ç”¨äºå£°æ˜å˜é‡ï¼Œå’Œvarå…³é”®å­—çš„ç”¨æ³•ç±»ä¼¼ã€‚ä½†æ˜¯ä¸varä¸åŒçš„æ˜¯ï¼Œletå£°æ˜çš„å˜é‡åªèƒ½åœ¨letæ‰€åœ¨çš„ä»£ç å—å†…æœ‰æ•ˆï¼Œå³åœ¨å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆï¼Œè€Œvarå£°æ˜çš„å˜é‡åœ¨å—çº§ä½œç”¨åŸŸå¤–ä»ç„¶æœ‰æ•ˆã€‚
```js
// çœ‹åŒºåˆ«
{
    var a = 1;
    let b = 2;
}
console.log(a);  // 1
console.log(b);  // ReferenceError: b is not defined
```
#### letå…³é”®å­—çš„ç‰¹æ€§
##### ä¸å­˜åœ¨å˜é‡æå‡
ä½¿ç”¨varå®šä¹‰çš„å˜é‡ä¼šå­˜åœ¨å˜é‡æå‡çš„æƒ…å†µï¼Œå˜é‡æå‡ä¼šä½¿å¾—å˜é‡åœ¨å£°æ˜ä¹‹å‰å¯ä»¥è¢«è®¿é—®ï¼Œæ­£æ˜¯å› ä¸ºè¿™ä¸ªç‰¹æ€§çš„å­˜åœ¨ï¼Œæ‰€ä»¥ä¼šå‡ºç°å„ç§å¥‡æ€ªçš„ç»“æœã€‚
```js
// åœ¨ES6ä¸­ï¼Œä½¿ç”¨letå®šä¹‰çš„å˜é‡ä¸å­˜åœ¨å˜é‡æå‡ï¼Œæ‰€ä»¥å¦‚æœåœ¨å˜é‡å£°æ˜ä¹‹å‰å»ä½¿ç”¨å˜é‡ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
// varå£°æ˜å˜é‡
console.log(c);  // undefined
var c = 'ming';
// letå£°æ˜å˜é‡
console.log(d);  // ReferenceError: d is not defined
let d = 'ming';
```

##### å­˜åœ¨æš‚æ—¶æ€§æ­»åŒº
åœ¨ES6ä¸­ï¼Œæš‚æ—¶æ€§æ­»åŒºä¼šå‡ºç°åœ¨ä½¿ç”¨letæˆ–constçš„ä»£ç ä¸­ï¼Œè¡¨ç¤ºçš„æ˜¯å½“ç¨‹åºæµç¨‹è¿›å…¥ä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸæ—¶ï¼Œåœ¨æ­¤ä½œç”¨åŸŸå†…ä½¿ç”¨letæˆ–constå£°æ˜çš„å˜é‡ä¼šå…ˆåœ¨ä½œç”¨åŸŸä¸­è¢«åˆ›å»ºå‡ºæ¥ï¼Œä½†æ­¤æ—¶è¿˜æœªè¿›è¡Œèµ‹å€¼ï¼Œå¦‚æœæ­¤æ—¶å¯¹è¯¥å˜é‡è¿›è¡Œæ±‚å€¼è¿ç®—ï¼Œå˜é‡æ˜¯ä¸èƒ½è¢«è®¿é—®çš„ï¼Œè®¿é—®å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

> å…¶ä¸­ï¼Œæµç¨‹è¿›å…¥æ–°ä½œç”¨åŸŸåˆ›å»ºå˜é‡åˆ°å˜é‡å¯ä»¥è¢«è®¿é—®çš„è¿™ä¸€æ®µä»£ç åŒºåŸŸï¼Œè¢«ç§°ä¸ºæš‚æ—¶æ€§æ­»åŒºã€‚

ç®€å•ç‚¹æ¥è®²å°±æ˜¯ï¼Œåœ¨ä½¿ç”¨letå£°æ˜å˜é‡ä¹‹å‰ï¼Œè¯¥å˜é‡éƒ½æ˜¯ä¸å¯è®¿é—®çš„ã€‚
```js
if (true) {
    // æš‚æ—¶æ€§æ­»åŒºå¼€å§‹
    param = 'ming';
    console.log(param); // ReferenceError: param is not defined
    // â€¦â€¦
    // æš‚æ—¶æ€§æ­»åŒºç»“æŸ
    let param;
}
```
å› ä¸ºæœ‰æš‚æ—¶æ€§æ­»åŒºçš„å­˜åœ¨ï¼Œtypeofè¿ç®—ç¬¦ä¹Ÿä¸å†æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œåœ¨letå®šä¹‰çš„å˜é‡ä¹‹å‰ä½¿ç”¨typeofè¿ç®—ç¬¦åŒæ ·ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
typeof param;  // ReferenceError: param is not defined
let param;
```
è€Œé’ˆå¯¹életæˆ–constå£°æ˜çš„å˜é‡ï¼Œä½¿ç”¨typeofè¿ç®—ç¬¦ç¡®å®æ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œå¤„ç†ä¸€ä¸ªæœªå£°æ˜çš„å˜é‡æ—¶ä¼šè¿”å›â€œundefinedâ€ã€‚
```js
typeof param;  // undefined
```

##### ä¸èƒ½é‡å¤å£°æ˜

```js
1 function foo() {
2     let arg1 = 'ming';
3     if (true) {
4         let arg1 = 'ming';
5     }
6     var arg1 = 'ming'; // SyntaxError: Identifier 'arg1' has already been declared
7 }
```
åœ¨foo()å‡½æ•°å†…éƒ¨ï¼Œä½¿ç”¨letä¸varåŒæ—¶å£°æ˜äº†åä¸ºarg1çš„å˜é‡ï¼Œå› ä¸ºå¤„äºåŒä¸€ä¸ªä½œç”¨åŸŸï¼Œæ‰€ä»¥ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

è€Œç¬¬4è¡ŒåŒæ ·ä½¿ç”¨letå®šä¹‰çš„å˜é‡arg1ï¼Œå…¶åªåœ¨ç¬¬3ï½5è¡Œçš„ä»£ç å—å†…æœ‰æ•ˆï¼Œä¸å¤–éƒ¨å£°æ˜çš„å˜é‡arg1ç›¸äº’ç‹¬ç«‹ï¼Œæ•…å¯ä»¥æ­£ç¡®å®šä¹‰ã€‚

åœ¨å‡½æ•°å†…éƒ¨ï¼Œå¦‚æœå¤„äºç›¸åŒä½œç”¨åŸŸä¸‹ï¼Œåˆ™ä¸èƒ½é‡å¤å£°æ˜å’Œå½¢å‚ç›¸åŒçš„å˜é‡åã€‚
```js
1 function foo(arg1) {
2     let arg1 = 'ming'; // SyntaxError: Identifier 'arg1' has already been declared
3     if (true) {
4         let arg1 = 'ming';
5     }
6 }
```
ç¬¬2è¡Œä»£ç ä½¿ç”¨letå£°æ˜äº†ä¸€ä¸ªä¸å½¢å‚ç›¸åŒçš„å˜é‡arg1ï¼Œä¸¤è€…åŒå¤„äºå‡½æ•°çº§ä½œç”¨åŸŸä¸­ï¼Œæ‰€ä»¥ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
è€Œç¬¬4è¡Œä»£ç ä½¿ç”¨letå£°æ˜çš„å˜é‡arg1ï¼Œå…¶åªåœ¨ç¬¬3ï½5è¡Œçš„ä»£ç å—å†…æœ‰æ•ˆï¼Œä¸å¤–éƒ¨å£°æ˜çš„å˜é‡arg1ç›¸äº’ç‹¬ç«‹ï¼Œæ•…å¯ä»¥æ­£ç¡®å®šä¹‰ã€‚

##### ä¸å†æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§
åœ¨ES6ä»¥å‰ï¼Œåœ¨æµè§ˆå™¨ç¯å¢ƒçš„å…¨å±€ä½œç”¨åŸŸä¸‹ï¼Œä½¿ç”¨varå£°æ˜çš„å˜é‡ã€å‡½æ•°è¡¨è¾¾å¼æˆ–è€…å‡½æ•°å£°æ˜å‡æ˜¯windowå¯¹è±¡çš„å±æ€§ã€‚
åœ¨ES6ä»¥åï¼Œä¾ç„¶éµå¾ªä¸Šè¿°åŸåˆ™ï¼Œä½†æ˜¯å¦‚æœæ˜¯ä½¿ç”¨letå£°æ˜çš„å˜é‡æˆ–è€…å‡½æ•°è¡¨è¾¾å¼ï¼Œå°†ä¸å†æ˜¯windowå¯¹è±¡çš„å±æ€§ã€‚
```js
// varå£°æ˜çš„å˜é‡å’Œå‡½æ•°è¡¨è¾¾å¼
var a = 1;
var fn = function () {
    console.log('global method');
};
console.log(window.a); // 1
window.fn();  // global method

// letå£°æ˜çš„å˜é‡å’Œå‡½æ•°è¡¨è¾¾å¼
let b = 2;
let foo = function () {
    console.log('global method');
};
console.log(window.b); // undefined
window.foo(); // TypeError: window.foo is not a function
```
#### ä½¿ç”¨letå…³é”®å­—çš„å¥½å¤„
##### ä¸ä¼šå¯¼è‡´forå¾ªç¯ç´¢å¼•å€¼æ³„éœ²
åœ¨forå¾ªç¯ä¸­ï¼Œå› ä¸ºå¾ªç¯çš„ç´¢å¼•å€¼ä¸€èˆ¬åªä¼šåœ¨å¾ªç¯ä½“å†…æœ‰æ•ˆï¼Œæ‰€ä»¥å½“å¾ªç¯ç»“æŸåç´¢å¼•å€¼åº”è¯¥è¢«å›æ”¶ã€‚ä½†æ˜¯å¦‚æœé€šè¿‡varå®šä¹‰ç´¢å¼•å€¼çš„è¯ï¼Œè¯¥ç´¢å¼•å€¼åœ¨å¾ªç¯ç»“æŸåä»ç„¶å¯ä»¥è®¿é—®ï¼Œæ­¤æ—¶ä½¿ç”¨letå®šä¹‰å¾ªç¯çš„ç´¢å¼•å€¼å°±å¾ˆåˆé€‚ã€‚
```js
// var
for (var i = 0; i < 10; i++) {
    // ...
}
console.log(i);  // 10
// let
for (let i = 0; i < 10; i++) {
    // ...
}
console.log(i); // ReferenceError: i is not defined
```
ç»å…¸åœºæ™¯ï¼šåœ¨forå¾ªç¯ä½“ä¸­é€šè¿‡å‡½æ•°è¾“å‡ºç´¢å¼•iå€¼ã€‚
```js
var arr = [];
for (var i = 0; i < 10; i++) {
    arr[i] = function () {
        console.log(i);
    };
}
arr[1]();  // 10
```
é€šè¿‡varå®šä¹‰çš„ç´¢å¼•iå€¼ï¼Œåœ¨è°ƒç”¨å‡½æ•°æ—¶ï¼Œæœ€ç»ˆä¼šè¾“å‡ºâ€œ10â€ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
å› ä¸ºé€šè¿‡varå£°æ˜çš„ç´¢å¼•iæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ï¼Œæ¯ä¸€æ¬¡å¾ªç¯ï¼Œå…¨å±€å˜é‡iéƒ½ä¼šå‘ç”Ÿæ”¹å˜ã€‚è€Œæ•°ç»„arræ‰€æœ‰æˆå‘˜é‡Œé¢çš„iéƒ½æŒ‡å‘åŒä¸€ä¸ªiï¼Œå½“å¾ªç¯ç»“æŸåï¼Œå…¨å±€å˜é‡içš„å€¼å·²ç»å˜ä¸º10ã€‚
æœ€ç»ˆåœ¨è°ƒç”¨æˆå‘˜å‡½æ•°æ—¶ï¼Œæ¯ä¸ªå‡½æ•°éƒ½é—­åŒ…äº†å…¨å±€å˜é‡iï¼Œå› æ­¤ä¼šè¾“å‡ºâ€œ10â€ã€‚

é€šè¿‡letå®šä¹‰çš„ç´¢å¼•å€¼å°±ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚
```js
var arr = [];
for (let i = 0; i < 10; i++) {
    arr[i] = function () {
        console.log(i);
    };
}
arr[1]();  // 1
```
è¿™æ˜¯å› ä¸ºé€šè¿‡letå®šä¹‰çš„ç´¢å¼•å€¼iï¼Œåªåœ¨å½“å‰å¾ªç¯å†…æœ‰æ•ˆï¼Œå®é™…ä¸Šæ¯ä¸€è½®å¾ªç¯ä¸­çš„iéƒ½æ˜¯ä¸€ä¸ªæ–°çš„å˜é‡ï¼Œè€Œä¸”æœ€å…³é”®çš„æ˜¯JavaScriptå¼•æ“èƒ½å¤Ÿè®°ä½ä¸Šä¸€è½®å¾ªç¯çš„å€¼ï¼Œæ‰€ä»¥åœ¨æœ¬è½®å¾ªç¯å¼€å§‹æ—¶ï¼Œä¼šåŸºäºä¸Šä¸€è½®å¾ªç¯è®¡ç®—ï¼Œä»è€Œç´¢å¼•içš„å€¼ä¼šé€’å¢ã€‚

å› æ­¤åœ¨è°ƒç”¨arræ•°ç»„çš„æˆå‘˜å‡½æ•°æ—¶ï¼Œä¼šè¾“å‡ºæ­£ç¡®çš„ç´¢å¼•iå€¼ã€‚
ä¸ºä»€ä¹ˆé€šè¿‡letå£°æ˜çš„å˜é‡iåœ¨å¾ªç¯ä½“å¤–ï¼Œä»ç„¶å¯ä»¥è®¿é—®å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºarræ•°ç»„çš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¯¹å˜é‡içš„å¼•ç”¨**æ„æˆäº†ä¸€ä¸ªé—­åŒ…**ï¼Œæ‰€ä»¥åœ¨å¾ªç¯ä½“å¤–è°ƒç”¨å‡½æ•°æ—¶ä»ç„¶å¯ä»¥è®¿é—®åˆ°iã€‚

å¦å¤–forå¾ªç¯è¿˜æœ‰ä¸€ä¸ªç‰¹åˆ«ä¹‹å¤„ï¼Œå£°æ˜å˜é‡çš„é‚£éƒ¨åˆ†ï¼ˆå°æ‹¬å·å†…éƒ¨ï¼‰æ˜¯ä¸€ä¸ªçˆ¶ä½œç”¨åŸŸï¼Œå¾ªç¯ä½“å†…éƒ¨æ˜¯ä¸€ä¸ªå•ç‹¬çš„å­ä½œç”¨åŸŸã€‚
```js
for (let i = 0; i < 2; i++) {
    let i = 'ming';
    console.log(i); // è¾“å‡ºä¸¤æ¬¡'ming'
}
```
æ ¹æ®letçš„ç‰¹ç‚¹ï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªä»£ç å—ä¸­åŒæ—¶ä½¿ç”¨letå®šä¹‰äº†å…·æœ‰ç›¸åŒåç§°çš„å˜é‡ï¼Œåˆ™ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚
è€Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå°æ‹¬å·å†…å’Œå¾ªç¯ä½“å†…åŒæ—¶ä½¿ç”¨letå£°æ˜äº†å˜é‡iï¼Œä½†æ˜¯åœ¨å¾ªç¯ä½“å†…ä»ç„¶å¯ä»¥è¾“å‡ºå˜é‡içš„å€¼ï¼Œå°±è¡¨æ˜è¿™ä¸¤ä¸ªå˜é‡iæ˜¯å¤„åœ¨ä¸¤ä¸ªç‹¬ç«‹çš„çˆ¶å­ä½œç”¨åŸŸä¸­çš„ã€‚

##### é¿å…å‡ºç°å˜é‡æå‡å¯¼è‡´çš„å˜é‡è¦†ç›–é—®é¢˜
```js
var arg1 = 'ming';
function foo() {
    console.log(arg1);  // undefined
    if (false) {
        var arg1 = 'ming2';
    }
}
foo(); // undefined
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªå…¨å±€å˜é‡arg1ï¼Œåœ¨foo()å‡½æ•°ä¸­æƒ³è¦è¾“å‡ºå˜é‡arg1ï¼Œä½†æ˜¯ç”±äºå˜é‡æå‡çš„å­˜åœ¨ï¼Œifä»£ç å—å†…çš„å˜é‡arg1ä¼šè¢«æå‡è‡³foo()å‡½æ•°é¡¶éƒ¨ï¼Œå¯¼è‡´è¾“å‡ºarg1æ—¶è¦†ç›–äº†å¤–å±‚çš„å…¨å±€å˜é‡arg1ï¼Œå› æ­¤è¾“å‡ºâ€œundefinedâ€ã€‚

å¦‚æœä½¿ç”¨letå®šä¹‰ifä»£ç å—å†…çš„arg1ï¼Œåˆ™è¯¥arg1åªåœ¨ifä»£ç å—å†…æœ‰æ•ˆï¼Œä¸ä¼šå½±å“åˆ°å…¨å±€çš„arg1å˜é‡ï¼Œä»è€Œèƒ½è¾“å‡ºâ€œmingâ€ã€‚
##### ä»£æ›¿ç«‹å³æ‰§è¡Œå‡½æ•°IIFE
ç«‹å³æ‰§è¡Œå‡½æ•°ï¼ˆImmediately-Invoked Function Expressionï¼Œç®€ç§°IIFEï¼‰çš„å†…éƒ¨æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å‡½æ•°çº§ä½œç”¨åŸŸï¼Œä½¿ç”¨IIFEçš„ç›®çš„ä¸»è¦æ˜¯é¿å…æ±¡æŸ“å½“å‰ä½œç”¨åŸŸå†…çš„å˜é‡ï¼Œè€Œä½¿ç”¨å—çº§ä½œç”¨åŸŸåˆ™å¯ä»¥ç›´æ¥é¿å…è¿™ä¸ªé—®é¢˜ã€‚
```js
// I IFE å†™æ³•
(function () {
   var arg = ...;
    ...
}());
// å—çº§ä½œç”¨åŸŸå†™æ³•
{
    let arg = ...;
    ...
}
```
### constå…³é”®å­—
```js
// å£°æ˜çš„å€¼ä¸ºä¸€ä¸ªå¸¸é‡ï¼Œä¸€æ—¦å£°æ˜å°†ä¸ä¼šå†æ”¹å˜ã€‚
const MAX = 123;
MAX = 456; // TypeError: Assignment to constant variable.
// å¦‚æœåªå£°æ˜ï¼Œä¸åˆå§‹åŒ–ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
const MAX = 123; // å£°æ˜æ­£å¸¸
const MIN; // SyntaxError: Missing initializer in const declaration
```
constä¸letå£°æ˜çš„å˜é‡å­˜åœ¨ä»¥ä¸‹ç›¸åŒçš„ç‰¹æ€§ã€‚
#### åœ¨å—çº§ä½œç”¨åŸŸå†…æœ‰æ•ˆ
```js
if (true) {
    const MAX = 123;
}
console.log(MAX);  // ReferenceError: MAX is not defined
```
#### ä¸å­˜åœ¨å˜é‡æå‡ï¼Œä¼šäº§ç”Ÿæš‚æ—¶æ€§æ­»åŒº
ä½¿ç”¨constå£°æ˜çš„å¸¸é‡ä¹Ÿä¸ä¼šè¿›è¡Œå˜é‡æå‡ï¼Œåªèƒ½åœ¨constå£°æ˜ä¹‹åä½¿ç”¨å¸¸é‡ï¼Œåœ¨ä½¿ç”¨å¤„åˆ°å¸¸é‡çš„å£°æ˜ä¹‹å‰ä¼šäº§ç”Ÿæš‚æ—¶æ€§æ­»åŒºã€‚
```js
if (true) {
    console.log(MAX);  // ReferenceError: MAX is not defined
    const MAX = 123;
}
```
#### ä¸èƒ½é‡å¤å£°æ˜å˜é‡
åœ¨åŒä¸€ä¸ªä½œç”¨åŸŸå†…ï¼Œä¸èƒ½é‡å¤ä½¿ç”¨constå£°æ˜å¸¸é‡ã€‚
```js
var MIN = 1;
if (true) {
    const MIN = 1; // æ­£å¸¸å£°æ˜
}
const MIN = 2;  // SyntaxError: Identifier 'MIN' has already been declared
```
> ä½¿ç”¨constå£°æ˜çš„å˜é‡ä¸èƒ½è¢«ä¿®æ”¹ï¼Œä¸¥æ ¼æ„ä¹‰æ¥è¯´æ˜¯ä¿å­˜å˜é‡å€¼çš„å†…å­˜åœ°å€ä¸èƒ½è¢«ä¿®æ”¹ã€‚

å¯¹äºåŸºæœ¬ç±»å‹çš„å˜é‡æ¥è¯´ï¼Œå˜é‡å°±ä¿å­˜ç€å†…å­˜åœ°å€çš„å€¼ï¼Œå› æ­¤ä¸èƒ½ç›´æ¥ä¿®æ”¹ï¼›è€Œå¯¹äºå¼•ç”¨ç±»å‹çš„å˜é‡æ¥è¯´ï¼Œå˜é‡ä¿å­˜çš„æ˜¯ä¸€ä¸ªæŒ‡å‘æ•°æ®å†…å­˜åœ°å€çš„æŒ‡é’ˆï¼Œåªè¦è¯¥æŒ‡é’ˆå›ºå®šä¸å˜ï¼Œå°±å¯ä»¥æ”¹å˜æ•°æ®æœ¬èº«çš„å€¼ã€‚
```js
const person = {
    age: 12
};
person.name = 'ming';
person.age = 13;
console.log(person); // { age: 13, name: 'ming' }
person = { age: 12 }; // TypeError: Assignment to constant variable.
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œä½¿ç”¨constå®šä¹‰äº†ä¸€ä¸ªpersonå˜é‡ï¼Œå…¶å€¼ä¸ºå¯¹è±¡ç±»å‹ï¼Œç„¶åæ–°å¢äº†ä¸€ä¸ªnameå±æ€§ï¼Œå¹¶ä¿®æ”¹ageå±æ€§ï¼Œä»ç„¶èƒ½æ­£å¸¸è¾“å‡ºã€‚
ä½†æ˜¯å½“æˆ‘ä»¬é‡æ–°ç»™personå˜é‡èµ‹å€¼æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
å¯¹äºæ•°ç»„ç±»å‹çš„å˜é‡ï¼Œå˜é‡å­˜å‚¨çš„æ˜¯æ•°ç»„åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œä»ç„¶å¯ä»¥ä¿®æ”¹æ¯ä¸ªå…ƒç´ çš„å€¼ã€‚
```js
// ç®€å•ç±»å‹æˆå‘˜çš„æ•°ç»„
const arr = ['1', '2'];
arr[0] = '3';  // æ­£å¸¸æ“ä½œ
// å¼•ç”¨ç±»å‹æˆå‘˜çš„æ•°ç»„
const arr2 = [{
    name: 'ming'
}];
arr2[0] = null;  // æ­£å¸¸æ“ä½œ
```
é‡æ–°ç»™arræˆ–è€…arr2èµ‹å€¼æ–°çš„æ•°ç»„æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
arr = ['3']; // TypeError: Assignment to constant variable.
```
#### ä¸å†æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§
ä¸letä¸€è‡´ï¼Œ**åœ¨æµè§ˆå™¨ç¯å¢ƒä¸‹**ï¼Œä½¿ç”¨constå£°æ˜çš„å˜é‡ä¸å†æ˜¯å…¨å±€å¯¹è±¡çš„å±æ€§ã€‚
```js
const c = 1;
console.log(window.c); // undefined
```

## è§£æ„èµ‹å€¼
ä¼ ç»Ÿçš„ES5åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­
```js
var arr = ['one', 'two', 'three'];
var one = arr[0];
var two = arr[1];

var obj = {name: 'ming', age: 21};
var name = obj.name;
var age = obj.age;
```
### æ•°ç»„çš„è§£æ„èµ‹å€¼
é’ˆå¯¹æ•°ç»„ï¼Œåœ¨è§£æ„èµ‹å€¼æ—¶ï¼Œä½¿ç”¨çš„æ˜¯æ¨¡å¼åŒ¹é…ï¼Œåªè¦ç­‰å·ä¸¤è¾¹æ•°ç»„çš„æ¨¡å¼ç›¸åŒï¼Œå³è¾¹æ•°ç»„çš„å€¼å°±ä¼šç›¸åº”èµ‹ç»™å·¦è¾¹æ•°ç»„çš„å˜é‡ã€‚
```js
let [arg1, arg2] = [12, 34];
console.log(num1); // 12
console.log(num2); // 34
```
ä½¿ç”¨é€—å·ä½œä¸ºå ä½ç¬¦ï¼Œè€Œä¸æŒ‡å®šå˜é‡åã€‚
```js
let [, , num3] = [12, 34, 56];
console.log(num3); // 56
```
å½“å³è¾¹çš„æ•°ç»„çš„å€¼ä¸è¶³ä»¥å°†å·¦è¾¹æ•°ç»„çš„å€¼å…¨éƒ¨èµ‹å€¼æ—¶ï¼Œä¼šè§£æ„å¤±è´¥ï¼Œå¯¹åº”çš„å€¼å°±ç­‰äºâ€œundefinedâ€ã€‚
```js
let [num1, num2, num3] = [12, 34];
console.log(num2); // 34
console.log(num3); // undefined
```
#### æ•°ç»„è§£æ„é»˜è®¤å€¼
åœ¨æ•°ç»„è§£æ„æ—¶è®¾ç½®é»˜è®¤å€¼ï¼Œå¯ä»¥é˜²æ­¢å‡ºç°è§£æ„å¾—åˆ°undefinedå€¼çš„æƒ…å†µã€‚å…·ä½“çš„åšæ³•æ˜¯åœ¨å·¦ä¾§çš„æ•°ç»„ä¸­ï¼Œç›´æ¥ç»™å˜é‡èµ‹åˆå§‹å€¼ã€‚
```js
let [num1 = 1, num2] = [, 34];
console.log(num1); // 1
console.log(num2); // 34
```
è¦æ³¨æ„çš„æ˜¯ï¼ŒES6åœ¨åˆ¤æ–­è§£æ„æ˜¯å¦ä¼šå¾—åˆ°undefinedå€¼æ—¶ï¼Œä½¿ç”¨çš„æ˜¯ä¸¥æ ¼ç­‰äºï¼ˆ===ï¼‰ã€‚åªæœ‰åœ¨**ä¸¥æ ¼ç­‰äºundefinedçš„æƒ…å†µä¸‹**ï¼Œæ‰ä¼šåˆ¤æ–­è¯¥å€¼è§£æ„ä¸ºundefinedï¼Œ**ç›¸åº”å˜é‡çš„é»˜è®¤å€¼æ‰ä¼šç”Ÿæ•ˆ**ã€‚
```js
let [
    num1 = 1,
    num2 = 2,
    num3 = 3
] = [null, ''];
console.log(num1);  // null
console.log(num2);  // ''
console.log(num3);  // 3
```
#### äº¤æ¢å˜é‡
åœ¨ä½¿ç”¨è§£æ„èµ‹å€¼ä»¥å‰ï¼Œå½“æˆ‘ä»¬éœ€è¦äº¤æ¢ä¸¤ä¸ªå˜é‡æ—¶ï¼Œéœ€è¦ä½¿ç”¨ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œä»¥ä¸‹æ˜¯ä¸€ä¸ªç»å…¸çš„å†™æ³•ã€‚
```js
var a = 1;
var b = 2;
var tmp; // ä¸´æ—¶å˜é‡

tmp = a;
a = b;
b = tmp;
console.log(a);  // 2
console.log(b);  // 1
```
å¦‚æœä½¿ç”¨æ•°ç»„çš„è§£æ„èµ‹å€¼ï¼Œåªéœ€è¦åœ¨ç­‰å¼ä¸¤è¾¹çš„æ•°ç»„ä¸­äº¤æ¢ä¸¤ä¸ªå˜é‡çš„é¡ºåºå³å¯ã€‚
```js
var a = 1;
var b = 2;
// ä½¿ç”¨æ•°ç»„çš„è§£æ„èµ‹å€¼äº¤æ¢å˜é‡
[b, a] = [a, b];
console.log(a);  // 2
console.log(b);  // 1
```
#### è§£æå‡½æ•°è¿”å›çš„æ•°ç»„
```js
function fn() {
    return [12, 34];
}
let [num1, num2] = fn();
console.log(num1); // 12
console.log(num2); // 34
```
####  åµŒå¥—æ•°ç»„çš„è§£æ„
```js
let [num1, num2, [num3]] = [12, [34, 56], [78, 89]];
console.log(num1); // 12
console.log(num2); // [34, 56]
console.log(num3); // 78
```
#### å‡½æ•°å‚æ•°è§£æ„
å½“å‡½æ•°çš„å‚æ•°ä¸ºæ•°ç»„ç±»å‹æ—¶ï¼Œå¯ä»¥å°†å®å‚å’Œå½¢å‚è¿›è¡Œè§£æ„ã€‚
```js
function foo([arg1, arg2]) {
    console.log(arg1); // 2
    console.log(arg2); // 3
}
foo([2, 3]);
```
### å¯¹è±¡çš„è§£æ„èµ‹å€¼
åœ¨ES6ä¸­ï¼Œå¯¹è±¡åŒæ ·å¯ä»¥è¿›è¡Œè§£æ„èµ‹å€¼ã€‚æ•°ç»„çš„è§£æ„èµ‹å€¼æ˜¯åŸºäºæ•°ç»„å…ƒç´ çš„ç´¢å¼•ï¼Œåªè¦å·¦å³ä¸¤ä¾§çš„æ•°ç»„å…ƒç´ ç´¢å¼•ç›¸åŒï¼Œä¾¿å¯ä»¥è¿›è¡Œè§£æ„èµ‹å€¼ã€‚ä½†æ˜¯åœ¨å¯¹è±¡ä¸­ï¼Œå±æ€§æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œè¿™å°±è¦æ±‚å³ä¾§è§£æ„å¯¹è±¡çš„å±æ€§åå’Œå·¦ä¾§å®šä¹‰å¯¹è±¡çš„å˜é‡åå¿…é¡»ç›¸åŒï¼Œè¿™æ ·æ‰å¯ä»¥è¿›è¡Œè§£æ„ã€‚
åŒæ ·ï¼ŒæœªåŒ¹é…åˆ°çš„å˜é‡ååœ¨è§£æ„æ—¶ä¼šèµ‹å€¼â€œundefinedâ€ã€‚
```js
let {m, n, o} = {m: 'ming', n: 12};
console.log(m); // ming
console.log(n); // 12
console.log(o); // undefined
```
å½“è§£æ„å¯¹è±¡çš„å±æ€§åå’Œå®šä¹‰çš„å˜é‡åä¸åŒæ—¶ï¼Œå¿…é¡»ä¸¥æ ¼æŒ‰ç…§key:valueçš„å½¢å¼è¡¥å……å·¦ä¾§å¯¹è±¡ã€‚
```js
let {m: name, n: age} = {m: 'ming', n: 12};
console.log(name); // ming
console.log(age); // 12
```
è€Œå½“keyå’Œvalueå€¼ç›¸åŒæ—¶ï¼Œå¯¹äºvalueçš„çœç•¥å®é™…ä¸Šæ˜¯ä¸€ç§ç®€å†™æ–¹æ¡ˆã€‚
```js
let {m: m, n: n} = {m: 'ming', n: 12};
// ç®€å†™æ–¹æ¡ˆ
let {m, n} = {m: 'ming', n: 12};
```
äº‹å®ä¸Šï¼Œå¯¹è±¡è§£æ„èµ‹å€¼çš„åŸç†æ˜¯ï¼šå…ˆæ‰¾åˆ°å·¦å³ä¸¤ä¾§ç›¸åŒçš„å±æ€§åï¼ˆkeyï¼‰ï¼Œç„¶åå†èµ‹ç»™å¯¹åº”çš„å˜é‡ï¼ˆvalueï¼‰ï¼ŒçœŸæ­£è¢«èµ‹å€¼çš„æ˜¯valueéƒ¨åˆ†ï¼Œå¹¶ä¸æ˜¯keyçš„éƒ¨åˆ†ã€‚
åœ¨å¦‚ä¸‹æ‰€ç¤ºçš„ä»£ç ä¸­ï¼Œmä½œä¸ºkeyï¼Œåªæ˜¯ç”¨äºåŒ¹é…ä¸¤ä¾§çš„å±æ€§åæ˜¯å¦ç›¸åŒï¼Œè€ŒçœŸæ­£è¢«èµ‹å€¼çš„æ˜¯å³ä¾§çš„nameå˜é‡ï¼Œæœ€ç»ˆnameå˜é‡ä¼šè¢«èµ‹å€¼ä¸ºâ€œmingâ€ï¼Œè€Œmä¸ä¼šè¢«èµ‹å€¼ã€‚
```js
let {m: name} = {m: 'ming'};
console.log(name);// ming
console.log(m); // ReferenceError: m is not defined
```
#### å¯¹è±¡è§£æ„çš„é»˜è®¤å€¼
é»˜è®¤å€¼ç”Ÿæ•ˆçš„æ¡ä»¶æ˜¯å¯¹åº”çš„å±æ€§å€¼ä¸¥æ ¼ç­‰äºundefinedã€‚
```js
let {m, n = 1, o = true} = {m: 'ming', o: null};
console.log(m); // ming
console.log(n); // 1
console.log(o); // nullï¼Œå› ä¸ºnullä¸undefinedä¸ä¸¥æ ¼ç›¸ç­‰ï¼Œé»˜è®¤å€¼å¹¶æœªç”Ÿæ•ˆ
```
å½“å±æ€§åå’Œå˜é‡åä¸ç›¸åŒæ—¶ï¼Œé»˜è®¤å€¼æ˜¯èµ‹ç»™å˜é‡çš„ã€‚
```js
let {m, n: age = 1} = {m: 'ming'};
console.log(m);   // ming
console.log(age); // 1
console.log(n);   // ReferenceError: n is not defined
```
#### åµŒå¥—å¯¹è±¡çš„è§£æ„
è§£æ„æ—¶ä»æœ€å¤–å±‚å¯¹è±¡å‘å†…éƒ¨é€å±‚è¿›è¡Œï¼Œæ¯ä¸€å±‚å¯¹è±¡å€¼éƒ½éµå¾ªç›¸åŒçš„è§£æ„è§„åˆ™ã€‚
```js
let obj = {
    p: [
        'Hello',
        {y: 'World'}
    ]
};
let {p: [x, {y: name}]} = obj;
console.log(x); // Hello
console.log(name); // World
console.log(y); // ReferenceError: y is not defined
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œå˜é‡objæ˜¯ä¸€ä¸ªåµŒå¥—å¯¹è±¡ï¼Œä¼šå­˜åœ¨å¤šæ¬¡è§£æ„çš„è¿‡ç¨‹ã€‚
ç¬¬ä¸€æ¬¡è§£æ„ä»æœ€å¤–å±‚çš„å±æ€§på¼€å§‹ï¼Œå±æ€§på¯¹åº”çš„å€¼ä¸ºä¸€ä¸ªæ•°ç»„[â€˜Helloâ€™, {y: â€˜Worldâ€™}]ï¼Œå¯¹åº”å·¦ä¾§çš„[x, {y: name}]ã€‚
ç¬¬äºŒæ¬¡è§£æ„å¾—åˆ°çš„xå€¼ä¸ºâ€œHelloâ€ï¼Œ{y: â€˜Worldâ€™}å¯¹åº”å·¦ä¾§çš„{y: name} ã€‚
ç¬¬ä¸‰æ¬¡è§£æ„å¾—åˆ°nameå€¼ä¸ºâ€œWorldâ€ï¼Œè§£æ„ç»“æŸã€‚è€Œyä»…ä»…ä½œä¸ºåŒ¹é…å±æ€§åçš„keyï¼Œä¸ä¼šå‚ä¸èµ‹å€¼ï¼Œå› æ­¤è¾“å‡ºyå€¼æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
æ³¨æ„ï¼šå½“çˆ¶å±‚å¯¹è±¡å¯¹åº”çš„å±æ€§ä¸å­˜åœ¨ï¼Œè€Œè§£æ„å­å±‚å¯¹è±¡æ—¶ï¼Œä¼šå‡ºé”™å¹¶æŠ›å‡ºå¼‚å¸¸ã€‚
```js
let obj = {
    m: {
        n: 'ming'
    }
};

let {o: {n}} = obj;
console.log(n); //TypeError: Cannot match against 'undefined' or 'null'.
```
å› ä¸ºåœ¨objå¯¹è±¡ä¸­ï¼Œå¤–å±‚çš„å±æ€§åæ˜¯mï¼Œè€Œåœ¨å·¦ä¾§çš„å¯¹è±¡ä¸­ï¼Œå¤–å±‚å±æ€§åæ˜¯oï¼Œä¸¤è€…å¹¶ä¸åŒ¹é…ï¼Œæ‰€ä»¥oä¼šè§£æ„å¾—åˆ°â€œundefinedâ€ã€‚è€Œå¯¹undefinedå†æ¬¡è§£æ„æƒ³è¦è·å–nå±æ€§æ—¶ï¼Œç›¸å½“äºè°ƒç”¨undefined.nï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
#### é€‰æ‹©æ€§è§£æ„å¯¹è±¡çš„å±æ€§
å‡å¦‚ä¸€ä¸ªå¯¹è±¡æœ‰å¾ˆå¤šé€šç”¨çš„å‡½æ•°ï¼Œåœ¨æŸæ¬¡å¤„ç†ä¸­ï¼Œåªæƒ³ä½¿ç”¨å…¶ä¸­çš„å‡ ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨è§£æ„èµ‹å€¼ã€‚
```js
let { min, max } = Math;
console.log(min(1, 3));  // 1
console.log(max(1, 3));  // 3
```
#### å‡½æ•°å‚æ•°è§£æ„
å½“å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ç±»å‹æ—¶ï¼Œå¯ä»¥é€šè¿‡è§£æ„å»è·å¾—æƒ³è¦è·å–çš„å€¼å¹¶èµ‹ç»™å˜é‡ã€‚
```js
function whois({displayName: displayName, fullName: { firstName: name }}){
    console.log(displayName + "is" + name);
}
const user = {
    id: 42,
    displayName: "jdoe",
    fullName: {
        firstName: "John",
        lastName: "Doe"
    }
};
whois(user); // jdoe is John
```
## æ‰©å±•è¿ç®—ç¬¦ä¸restè¿ç®—ç¬¦
è¿™ä¸¤ç§è¿ç®—ç¬¦å¯ä»¥å¾ˆå¥½åœ°è§£å†³å‡½æ•°å‚æ•°å’Œæ•°ç»„å…ƒç´ é•¿åº¦æœªçŸ¥æƒ…å†µä¸‹çš„ç¼–ç é—®é¢˜ï¼Œä½¿å¾—ä»£ç èƒ½æ›´åŠ å¥å£®å’Œç®€æ´ã€‚
### æ‰©å±•è¿ç®—ç¬¦
ç”¨3ä¸ªç‚¹è¡¨ç¤ºï¼ˆ...ï¼‰ï¼Œç”¨äºå°†ä¸€ä¸ªæ•°ç»„æˆ–ç±»æ•°ç»„å¯¹è±¡è½¬æ¢ä¸ºç”¨é€—å·åˆ†éš”çš„å€¼åºåˆ—ã€‚
```js
// å®ƒçš„åŸºæœ¬ç”¨æ³•æ˜¯æ‹†è§£æ•°ç»„å’Œå­—ç¬¦ä¸²ã€‚
const array = [1, 2, 3, 4];
console.log(...array); // 1 2 3 4
const str = "string";
console.log(...str); // s t r i n g
```
æ•°ç»„ç±»å‹å˜é‡arrayå’Œå­—ç¬¦ä¸²ç±»å‹å˜é‡stråœ¨ç»è¿‡æ‰©å±•è¿ç®—ç¬¦çš„å¤„ç†åï¼Œå¾—åˆ°çš„éƒ½æ˜¯å•ç‹¬çš„å€¼åºåˆ—ã€‚
#### æ‰©å±•è¿ç®—ç¬¦ä»£æ›¿apply()å‡½æ•°
å°†æ•°ç»„è½¬æ¢ä¸ºå‡½æ•°å‚æ•°ã€‚
```js
// è·å–æ•°ç»„æœ€å¤§å€¼æ—¶
let arr = [1, 4, 6, 8, 2];
console.log(Math.max.apply(null, arr)); // 8
// ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦
console.log(Math.max(...arr)); // 8
```
ä¾‹å¦‚ï¼Œè‡ªå®šä¹‰ä¸€ä¸ªadd()å‡½æ•°ï¼Œç”¨äºæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå¹¶è¿”å›ä¸¤ä¸ªå‚æ•°ç›¸åŠ çš„å’Œã€‚å½“ä¼ é€’çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„æ—¶ï¼Œå¦‚æœä½¿ç”¨apply()å‡½æ•°ï¼Œå†™æ³•å¦‚ä¸‹ã€‚
```js
function add (num1, num2) {
  return num1 + num2;
}
const arr = [1, 3];
add.apply(null, arr); // 4
// ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦
add(...arr); // 4
```
#### æ‰©å±•è¿ç®—ç¬¦ä»£æ›¿concat()å‡½æ•°åˆå¹¶æ•°ç»„

```js
let arr1 = [1, 2, 3];
let arr2 = [4, 5, 6];
console.log(arr1.concat(arr2)); // [ 1, 2, 3, 4, 5, 6 ]
// ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦
console.log([...arr1, ...arr2]); // [ 1, 2, 3, 4, 5, 6 ]
```
#### æ‰©å±•è¿ç®—ç¬¦è½¬æ¢Setï¼Œå¾—åˆ°å»é‡çš„æ•°ç»„
Setå…·æœ‰è‡ªåŠ¨çš„å»é‡æ€§è´¨
```js
let arr = [1, 2, 4, 6, 2, 7, 4];
console.log([...new Set(arr)]); // [ 1, 2, 4, 6, 7 ]
```
#### æ‰©å±•è¿ç®—ç¬¦ç”¨äºå¯¹è±¡å…‹éš†
ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å…‹éš†çš„å¯¹è±¡çš„å±æ€§å€¼ä¸ºåŸºæœ¬æ•°æ®ç±»å‹çš„åœºæ™¯ã€‚
```js
let obj = {name: 'ming'};
var obj2 = {...obj};
obj2.name = 'ming2';
console.log(obj); // {name: "ming"}
```
å…‹éš†åå¯¹è±¡çš„å€¼è¿›è¡Œä¿®æ”¹å¹¶æœªå½±å“åˆ°è¢«å…‹éš†çš„å¯¹è±¡ï¼Œé‚£ä¹ˆæ˜¯ä¸æ˜¯å°±æ„å‘³ç€ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å®ç°çš„æ˜¯æ·±å…‹éš†å‘¢ï¼Ÿ

åœºæ™¯ï¼šå…‹éš†å¯¹è±¡çš„å±æ€§å€¼ä¸ºå¼•ç”¨æ•°æ®ç±»å‹ã€‚
```js
let obj3 = {
    name: 'ming', 
    address: {province: 'guangdong', city: 'guangzhou'}
};
let obj4 = {...obj3};
obj4.name = 'ming3';
obj4.address.city = 'shenzhen';
console.log(obj3);
// {name: "ming", address: {province: "guangdong", city: "shenzhen"}}
```
è¡¨æ˜å¯¹å…‹éš†åå¯¹è±¡çš„å€¼è¿›è¡Œæ›´æ”¹åï¼Œå½±å“åˆ°äº†è¢«å…‹éš†çš„å¯¹è±¡ï¼Œè¿™å°±æ„å‘³ç€ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦çš„å…‹éš†å¹¶ä¸æ˜¯ä¸¥æ ¼çš„æ·±å…‹éš†ã€‚
```js
// åŒæ ·é€‚ç”¨äºæ•°ç»„
let arr1 = [1, 3, 4, 6];  // å¯ä»¥è¿›è¡Œæ·±å…‹éš†
let arr2 = [1, 3, [4, 6]]; // ä¸å¯ä»¥è¿›è¡Œæ·±å…‹éš†
```
ç»“è®ºï¼šä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å¯¹æ•°ç»„æˆ–å¯¹è±¡è¿›è¡Œå…‹éš†æ—¶ï¼Œå¦‚æœæ•°ç»„çš„å…ƒç´ æˆ–è€…å¯¹è±¡çš„å±æ€§æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ™æ”¯æŒæ·±å…‹éš†ï¼›å¦‚æœæ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆ™ä¸æ”¯æŒæ·±å…‹éš†ã€‚
> å› ä¸ºå¼•ç”¨æ•°æ®ç±»å‹çš„å…‹éš†åªæ˜¯å¤åˆ¶äº†å¼•ç”¨çš„åœ°å€ï¼Œå…‹éš†åçš„å¯¹è±¡ä»ç„¶å…±äº«åŒä¸€ä¸ªå¼•ç”¨åœ°å€ã€‚
### restè¿ç®—ç¬¦
> åŒæ ·ä½¿ç”¨3ä¸ªç‚¹è¡¨ç¤ºï¼ˆ...ï¼‰ï¼Œå…¶ä½œç”¨ä¸æ‰©å±•è¿ç®—ç¬¦ç›¸åï¼Œç”¨äºå°†ä»¥é€—å·åˆ†éš”çš„å€¼åºåˆ—è½¬æ¢æˆæ•°ç»„ã€‚
#### ä¸è§£æ„ç»„åˆä½¿ç”¨
è§£æ„ä¼šå°†ç›¸åŒæ•°æ®ç»“æ„å¯¹åº”çš„å€¼èµ‹ç»™å¯¹åº”çš„å˜é‡ï¼Œå°†å…¶ä¸­çš„ä¸€éƒ¨åˆ†å€¼ç»Ÿä¸€èµ‹ç»™ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨restè¿ç®—ç¬¦ã€‚
```js
let arr = ['one', 'two', 'three', 'four'];
let [arg1, ...arg2] = arr;
console.log(arg1);  // one
console.log(arg2);  // [ 'two', 'three', 'four' ]
```
ä½¿ç”¨restè¿ç®—ç¬¦è¿›è¡Œè§£æ„ï¼Œåˆ™restè¿ç®—ç¬¦å¯¹åº”çš„å˜é‡åº”è¯¥æ”¾åœ¨æœ€åä¸€ä½ï¼Œå¦åˆ™å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚å› ä¸ºå¦‚æœrestè¿ç®—ç¬¦ä¸æ˜¯æ”¾åœ¨æœ€åä¸€ä½ï¼Œå˜é‡å¹¶ä¸çŸ¥é“è¦è¯»å–å¤šå°‘ä¸ªæ•°å€¼ã€‚
```js
let arr = ['one', 'two', 'three', 'four'];
let [...arg1, arg2] = arr; // SyntaxError: Rest element must be last element 
in array
```
å’Œå¯¹è±¡è§£æ„ç›¸å…³çš„å†…å®¹ã€‚
```js
let {x, y, ...z} = {x: 1, y: 2, a: 3, b: 4};
console.log(x); // 1
console.log(y); // 2
console.log(z); // {a: 3, b: 4}
```
#### ä»£æ›¿argumentså¤„ç†å‡½æ•°å‚æ•°
```js
// ä¸ç¡®å®šä¼ å…¥çš„å‚æ•°é•¿åº¦ï¼Œå¯ä»¥ç»Ÿä¸€ä½¿ç”¨argumentsæ¥è·å–æ‰€æœ‰ä¼ é€’çš„å‚æ•°
function foo() {
    for (let arg of arguments) {
        console.log(arg);
    }
}
foo('one', 'two', 'three', 'four');// è¾“å‡º'one', 'two', 'three', 'four'
```
å‡½æ•°çš„å‚æ•°æ˜¯ä¸€ä¸ªä½¿ç”¨é€—å·åˆ†éš”çš„å€¼åºåˆ—ï¼Œå¯ä»¥ä½¿ç”¨restè¿ç®—ç¬¦å¤„ç†æˆä¸€ä¸ªæ•°ç»„ï¼Œä»è€Œç¡®å®šæœ€ç»ˆä¼ å…¥çš„å‚æ•°ï¼Œä»¥ä»£æ›¿argumentsçš„ä½¿ç”¨ã€‚
```js
function foo(...args) {
    for (let arg of args) {
        console.log(arg);
    }
}
foo('one', 'two', 'three', 'four');// è¾“å‡º'one', 'two', 'three', 'four'
```
é€šè¿‡ä»¥ä¸Šå¯¹æ‰©å±•è¿ç®—ç¬¦å’Œrestè¿ç®—ç¬¦çš„è®²è§£ï¼Œå…¶å®ä¸¤è€…æ˜¯äº’ä¸ºé€†è¿ç®—çš„ï¼Œ**æ‰©å±•è¿ç®—ç¬¦æ˜¯å°†æ•°ç»„åˆ†å‰²æˆç‹¬ç«‹çš„åºåˆ—ï¼Œè€Œrestè¿ç®—ç¬¦æ˜¯å°†ç‹¬ç«‹çš„åºåˆ—åˆå¹¶æˆä¸€ä¸ªæ•°ç»„ã€‚**

é‚£ä¹ˆå¦‚ä½•åˆ¤æ–­å‘¢ï¼Ÿ
- å½“3ä¸ªç‚¹ï¼ˆâ€¦ï¼‰å‡ºç°åœ¨å‡½æ•°çš„**å½¢å‚**ä¸Šæˆ–è€…å‡ºç°åœ¨èµ‹å€¼ç­‰å·çš„**å·¦ä¾§**ï¼Œåˆ™è¡¨ç¤ºå®ƒä¸ºrestè¿ç®—ç¬¦ã€‚
- å½“3ä¸ªç‚¹ï¼ˆâ€¦ï¼‰å‡ºç°åœ¨å‡½æ•°çš„**å®å‚**ä¸Šæˆ–è€…å‡ºç°åœ¨èµ‹å€¼ç­‰å·çš„**å³ä¾§**ï¼Œåˆ™è¡¨ç¤ºå®ƒä¸ºæ‰©å±•è¿ç®—ç¬¦ã€‚
## æ¨¡æ¿å­—ç¬¦ä¸²
ä½¿ç”¨åå¼•å·ï¼ˆ``ï¼‰æ‹¬èµ·æ¥ï¼Œå¯ç”¨ä½œæ™®é€šçš„å­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ç”¨æ¥å®šä¹‰å¤šè¡Œå­—ç¬¦ä¸²ï¼ŒåŒæ—¶æ”¯æŒåœ¨å­—ç¬¦ä¸²ä¸­ä½¿ç”¨${}åµŒå…¥å˜é‡ã€‚
### å­—ç¬¦ä¸²åŸç”Ÿè¾“å‡º
```js
// ä¼ ç»Ÿå­—ç¬¦ä¸²æ–¹æ¡ˆ
var str = 'Hello, my name is ming, ' +
          'I am working in Beijng.';
console.log(str); // Hello, my name is ming, I am working in Beijng.
```
strå˜é‡çš„ç¬¬ä¸€è¡Œå­—ç¬¦ä¸²å’Œç¬¬äºŒè¡Œå­—ç¬¦ä¸²ä¹‹é—´ä½¿ç”¨åŠ å·è¿›è¡Œæ‹¼æ¥ï¼Œå¹¶ä¸”å­—ç¬¦ä¸²ä¸­æœ‰ç¼©è¿›å’Œæ¢è¡Œç¬¦ï¼Œä½†æ˜¯è¾“å‡ºçš„ç»“æœä¸­å®ƒä»¬éƒ½è¢«å¿½ç•¥äº†ã€‚
```js
let str2 = `Hello, my name is ming,
            I am working in Beijng.`;
console.log(str2);
// ä»¥ä¸‹æ˜¯è¾“å‡ºç»“æœ
Hello, my name is ming,
            I am working in Beijng.
```
è€Œä½¿ç”¨æ¨¡æ¿å­—ç¬¦ä¸²è¯­æ³•ï¼Œä¼šä¿ç•™å­—ç¬¦ä¸²å†…éƒ¨çš„ç©ºç™½ã€ç¼©è¿›å’Œæ¢è¡Œç¬¦ã€‚
### å­—ç¬¦ä¸²å˜é‡å€¼ä¼ é€’
#### ä¼ é€’åŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡
```js
// ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ
var name = 'ming';
var address = 'Beijing';
var str = 'Hello, my name is ' + name + ', ' +
          'I am working in ' + address + '.';
console.log(str);  // Hello, my name is ming, I am working in Beijng.
```
åœ¨ä¸€ä¸ªå¤æ‚çš„è¯­å¥ä¸­ï¼Œé€šè¿‡å˜é‡æ‹¼æ¥ï¼Œä¼šå¾ˆå®¹æ˜“å‡ºé”™ï¼Œå°¤å…¶æ˜¯é‡åˆ°å•å¼•å·å’ŒåŒå¼•å·åŒæ—¶å‡ºç°çš„åœºæ™¯ã€‚
```js
// æ¨¡æ¿å­—ç¬¦ä¸²æ–¹æ¡ˆ
let name = 'ming';
let address = 'Beijing';
let str = `Hello, my name is ${name},
           I am working in ${address}.`;
console.log(str);
// ä»¥ä¸‹æ˜¯è¾“å‡ºç»“æœ
Hello, my name is ming,
            I am working Beijng.
```
#### ä¼ é€’è¡¨è¾¾å¼
åœ¨${}ä¹‹ä¸­ä¸ä»…å¯ä»¥ä¼ é€’å˜é‡ï¼Œè¿˜å¯ä»¥ä¼ é€’ä»»æ„çš„JavaScriptè¡¨è¾¾å¼ï¼ŒåŒ…æ‹¬æ•°å­¦è¿ç®—ã€å±æ€§å¼•ç”¨ã€å‡½æ•°è°ƒç”¨ã€‚
```js
// æ•°å­¦è¿ç®—
let x = 1,
    y = 2;
console.log(`${x} + ${y * 2} = ${x + y * 2}`); // 1 + 4 = 5

// å±æ€§å¼•ç”¨å’Œæ•°å­¦è¿ç®—
let obj = {x: 1, y: 2};
console.log(`${obj.x + obj.y}`); // 3

// å‡½æ•°è°ƒç”¨
function fn() {
    return "Hello World";
}
console.log(`foo ${fn()} bar`); // foo Hello World bar
```
#### ä¼ é€’å¤æ‚å¼•ç”¨æ•°æ®ç±»å‹çš„å˜é‡
å½“ä¼ é€’çš„å˜é‡æ˜¯ä¸€ä¸ªå¤šå±‚åµŒå¥—çš„å¤æ‚å¼•ç”¨æ•°æ®ç±»å‹å€¼æ—¶ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²åŒæ ·å¯ä»¥æ”¯æŒåµŒå¥—è§£æï¼Œé‡åˆ°è¡¨è¾¾å¼ä¼šè§£ææˆå¯¹åº”çš„å€¼ã€‚
```js
const tmpl = function (addrs) {
    return `
        <table>
            ${addrs.map(addr => `
                <tr><td>${addr.provice}</td></tr>
                <tr><td>${addr.city}</td></tr>
            `).join('')}
        </table>
    `;
};
const addrs = [{ provice: 'æ¹–åŒ—çœ', city: 'æ­¦æ±‰å¸‚' }, 
{ provice: 'å¹¿ä¸œçœ', city: 'å¹¿å·å¸‚' }];
console.log(tmpl(addrs));
```
è¾“å‡ºçš„å­—ç¬¦ä¸²ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```js
</table>  
    <tr><td>æ¹–åŒ—çœ</td></tr>
    <tr><td>æ­¦æ±‰å¸‚</td></tr>
    <tr><td>å¹¿ä¸œçœ</td></tr>
    <tr><td>å¹¿å·å¸‚</td></tr>
</table>
```
> ç»“è®ºï¼šåªè¦${}é‡Œæ˜¯å¯ä»¥è·å¾—å”¯ä¸€å€¼çš„å³å¯

## ç®­å¤´å‡½æ•°
```js
// ES6è¯­æ³•
const foo = v => v;
// ç­‰åŒäºä¼ ç»Ÿè¯­æ³•
var foo = function (v) {
    return v;
};
```
åœ¨ç¼–å†™ä¸Šçœå»äº†functionå…³é”®å­—ï¼Œå‡½æ•°å‚æ•°å’Œæ™®é€šçš„å‡½æ•°å‚æ•°ä¸€æ ·ï¼Œå‡½æ•°ä½“ä¼šè¢«ä¸€ä¸ªå¤§æ‹¬å·æ‹¬èµ·æ¥ã€‚
```js
const fn = (num1, num2) => {
    return num1 + num2;
};
```
å¦‚æœå‡½æ•°çš„å‚æ•°åªæœ‰ä¸€ä¸ªï¼Œåˆ™å¯ä»¥çœç•¥å°æ‹¬å·ï¼›å¦‚æœå‡½æ•°ä½“åªæœ‰ä¸€è¡Œï¼Œåˆ™å¯ä»¥çœç•¥å¤§æ‹¬å·å’Œreturnå…³é”®å­—ã€‚
```js
[1, 2, 3].map(r => r * 2);  // [2, 4, 6]
// ç­‰åŒäº
[1, 2, 3].map(function(r) {
    return r * 2;
});
```
### ç®­å¤´å‡½æ•°çš„ç‰¹ç‚¹
#### è¯­æ³•ç®€æ´
æ±‚ä¸€ä¸ªæ•°ç»„å„é¡¹çš„å’Œã€‚
```js
[1, 2, 3, 4].reduce((x, y) => x + y, 0); // 10
```
æ•°ç»„ä¸­çš„å…ƒç´ æŒ‰ç…§ä»å°åˆ°å¤§é¡ºåºæ’åºï¼Œå¯ä»¥ç®€å†™
```js
[1, 4, 6, 3, 2].sort((x, y) => x - y) //[1, 2, 3, 4, 6]
```
è¿‡æ»¤å‡ºæ•°ç»„ä¸­å¤§äº3çš„æ•°å­—ï¼Œå¯ä»¥ç®€å†™
```js
[1, 2, 5, 6, 3].filter(x => x > 3); // [ 5, 6 ]
```
#### ä¸ç»‘å®šthis
> function: thisçš„æŒ‡å‘é—®é¢˜ï¼Œå¾—å‡ºçš„ç»“è®ºæ˜¯ï¼šthisæ°¸è¿œæŒ‡å‘å‡½æ•°çš„è°ƒç”¨è€…ã€‚
> åœ¨ç®­å¤´å‡½æ•°ä¸­: thisæŒ‡å‘çš„æ˜¯å®šä¹‰æ—¶æ‰€åœ¨çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯ä½¿ç”¨æ—¶æ‰€åœ¨çš„å¯¹è±¡ã€‚

é€šè¿‡setTimeout()å’ŒsetInterval()å‡½æ•°çœ‹åŒºåˆ«ã€‚
```js
function Timer() {
    this.s1 = 0;
    this.s2 = 0;
    // ç®­å¤´å‡½æ•°
    setInterval(() => this.s1++, 1000);
    // æ™®é€šå‡½æ•°
    setInterval(function () {
        this.s2++;
    }, 1000);
}

let timer = new Timer();

setTimeout(() => console.log('s1: ', timer.s1), 3100); // 3.1ç§’åè¾“å‡ºs1: 3
setTimeout(() => console.log('s2: ', timer.s2), 3100); // 3.1ç§’åè¾“å‡ºs2: 0
```
why?
åœ¨ç”ŸæˆTimerçš„å®ä¾‹timeråï¼Œé€šè¿‡setTimeout()å‡½æ•°åœ¨3.1ç§’åè¾“å‡ºtimerçš„s1å˜é‡ï¼Œæ­¤æ—¶setInterval()å‡½æ•°å·²ç»æ‰§è¡Œäº†3æ¬¡ï¼Œç”±äºthis.s1++æ˜¯å¤„åœ¨ç®­å¤´å‡½æ•°ä¸­çš„ï¼Œ**è¿™é‡Œçš„thiså°±æŒ‡å‘timer**ï¼Œæ­¤æ—¶timer.s1å€¼ä¸ºâ€œ3â€ã€‚

è€Œthis.s2++æ˜¯å¤„åœ¨æ™®é€šå‡½æ•°ä¸­çš„ï¼Œ**è¿™é‡Œçš„thisæŒ‡å‘çš„æ˜¯å…¨å±€å¯¹è±¡window**ï¼Œå®é™…ä¸Šç›¸å½“äº`window.s2++`ï¼Œç»“æœæ˜¯`window.s2 = 3`ï¼Œè€Œåœ¨æœ€åä¸€è¡Œçš„è¾“å‡ºç»“æœä¸­ï¼Œtimer.s2ä»ç„¶ä¸ºâ€œ0â€ã€‚

> ç®­å¤´å‡½æ•°ä¸­ä¸ä¼šåˆ›å»ºè‡ªå·±çš„thisï¼Œè€Œæ˜¯ä¼šä»è‡ªå·±ä½œç”¨åŸŸé“¾çš„ä¸Šä¸€å±‚ç»§æ‰¿thisã€‚

```js
const Person = {
    'name': 'ming',
    'age': 18,
    'sayHello': function () {
        setTimeout(() => {
            console.log('æˆ‘å«' + this.name + 'ï¼Œæˆ‘ä»Šå¹´' + this.age + 'å²!')
        }, 1000);
    }
};
Person.sayHello(); // æˆ‘å«mingï¼Œæˆ‘ä»Šå¹´18å²!

const Person2 = {
    'name': 'little bear',
    'age': 18,
    'sayHello': () => {
        setTimeout(() => {
            console.log('æˆ‘å«' + this.name + 'ï¼Œæˆ‘ä»Šå¹´' + this.age + 'å²!')
        }, 1000);
    }
};
Person2.sayHello(); // æˆ‘å«undefinedï¼Œæˆ‘ä»Šå¹´undefinedå²!
```
åœ¨ç¬¬ä¸€æ®µä»£ç ä¸­ï¼ŒsayHello()å‡½æ•°é€šè¿‡functionå…³é”®å­—è¿›è¡Œå®šä¹‰ï¼Œåœ¨æ‰§è¡ŒPerson.sayHello()å‡½æ•°æ—¶ï¼ŒsayHello()å‡½æ•°ä¸­çš„thisä¼šæŒ‡å‘å‡½æ•°çš„è°ƒç”¨ä½“ï¼Œå³Personæœ¬èº«ï¼›åœ¨è°ƒç”¨setTimeout()å‡½æ•°æ—¶ï¼Œç”±äºå…¶å‡½æ•°ä½“éƒ¨åˆ†æ˜¯é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰çš„ï¼Œå†…éƒ¨çš„thisä¼šç»§æ‰¿è‡³çˆ¶ä½œç”¨åŸŸçš„thisï¼Œå› æ­¤setTimeout()å‡½æ•°å†…éƒ¨çš„thisä¼šæŒ‡å‘Personï¼Œä»è€Œè¾“å‡ºç»“æœâ€œæˆ‘å«ming,æˆ‘ä»Šå¹´18å²!â€ã€‚

Person2.sayHello()å‡½æ•°æ—¶ï¼ŒsayHello()å‡½æ•°ä¸­çš„thisä¼šæŒ‡å‘å¤–å±‚ä½œç”¨åŸŸï¼Œè€ŒPerson2çš„çˆ¶ä½œç”¨åŸŸå°±æ˜¯å…¨å±€ä½œç”¨åŸŸwindowï¼›åœ¨è°ƒç”¨setTimeout()å‡½æ•°æ—¶ï¼Œç”±äºå…¶å‡½æ•°ä½“éƒ¨åˆ†æ˜¯é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰çš„ï¼Œå†…éƒ¨çš„thisä¼šç»§æ‰¿è‡³sayHello()å‡½æ•°æ‰€åœ¨çš„ä½œç”¨åŸŸçš„thisï¼Œå³windowï¼Œè€Œwindowä¸Šå¹¶æ²¡æœ‰å®šä¹‰nameå’Œageå±æ€§ï¼Œå› æ­¤è¾“å‡ºç»“æœâ€œæˆ‘å«undefined,æˆ‘ä»Šå¹´undefinedå²!â€ã€‚

> å¯¹è±¡å‡½æ•°ä½¿ç”¨ç®­å¤´å‡½æ•°æ˜¯ä¸åˆé€‚çš„ã€‚

#### ä¸æ”¯æŒcall()ä¸apply()å‡½æ•°çš„ç‰¹æ€§
> è¢«è°ƒç”¨å‡½æ•°æ˜¯ä¸€ä¸ªç®­å¤´å‡½æ•°ï¼Œåˆ™ä¸ä¼šæ”¹å˜ç®­å¤´å‡½æ•°ä¸­thisçš„æŒ‡å‘ã€‚

```js
let adder = {
  base : 1,
  add : function(a) {
    var f = v => v + this.base;
    return f(a);
  },
  addThruCall: function(a) {
    var f = v => v + this.base;
      var b = {
        base : 2
      };   
    return f.call(b, a);
  }
};
console.log(adder.add(1));         // 2
console.log(adder.addThruCall(1)); // 2
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œæ‰§è¡Œadder.add(1)æ—¶ï¼Œadd()å‡½æ•°å†…éƒ¨é€šè¿‡ç®­å¤´å‡½æ•°çš„å½¢å¼å®šä¹‰äº†f()å‡½æ•°ï¼Œ**f()å‡½æ•°ä¸­çš„thisä¼šç»§æ‰¿è‡³çˆ¶ä½œç”¨åŸŸ**ï¼Œå³adderï¼Œé‚£ä¹ˆ`this.base = 1`ï¼Œå› æ­¤æ‰§è¡Œ`adder.add(1)`ç›¸å½“äºæ‰§è¡Œ1 + 1çš„æ“ä½œï¼Œç»“æœè¾“å‡ºâ€œ2â€ã€‚

æ‰§è¡Œadder.addThruCall(1)æ—¶ï¼ŒaddThruCall()å‡½æ•°å†…éƒ¨é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰äº†f()å‡½æ•°ï¼Œ**å…¶ä¸­çš„thisæŒ‡å‘äº†adder**ã€‚è™½ç„¶åœ¨è¿”å›ç»“æœæ—¶ï¼Œé€šè¿‡call()å‡½æ•°è°ƒç”¨äº†f()å‡½æ•°ï¼Œä½†æ˜¯å¹¶**ä¸ä¼šæ”¹å˜f()å‡½æ•°ä¸­thisçš„æŒ‡å‘**ï¼Œthisä»ç„¶æŒ‡å‘adderï¼Œè€Œä¸”ä¼šæ¥æ”¶å‚æ•°aï¼Œå› æ­¤æ‰§è¡Œadder.addThruCall(1)ç›¸å½“äºæ‰§è¡Œ1 + 1çš„æ“ä½œï¼Œç»“æœè¾“å‡ºâ€œ2â€ã€‚

#### ä¸ç»‘å®šarguments
ç®­å¤´å‡½æ•°ä¸­æ²¡æœ‰arguments
```js
const fn = () => {
    console.log(arguments);
};
fn(1, 2); // Uncaught ReferenceError: arguments is not defined

// å¯ä»¥å€ŸåŠ©restè¿ç®—ç¬¦ï¼ˆ...ï¼‰æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„ã€‚
const fn = (..args) => {
  console.log(args);
}
fn(1, 2); // [1, 2]
```
å› ä¸ºæ— æ³•åœ¨ç®­å¤´å‡½æ•°ä¸­ä½¿ç”¨argumentsï¼ŒåŒæ ·ä¹Ÿå°±æ— æ³•ä½¿ç”¨callerå’Œcalleeå±æ€§ã€‚

#### æ”¯æŒåµŒå¥—
åœºæ™¯ï¼šæœ‰ä¸€ä¸ªå‚æ•°ä¼šä»¥ç®¡é“çš„å½¢å¼ç»è¿‡ä¸¤ä¸ªå‡½æ•°å¤„ç†ï¼Œç¬¬ä¸€ä¸ªå‡½æ•°å¤„ç†å®Œçš„è¾“å‡ºå°†ä½œä¸ºç¬¬äºŒä¸ªå‡½æ•°çš„è¾“å…¥ï¼Œä¸¤ä¸ªå‡½æ•°è¿ç®—å®Œåè¾“å‡ºæœ€åçš„ç»“æœã€‚
```js
1  const pipeline = (...funcs) =>
2       val => funcs.reduce((a, b) => b(a), val);
3  const plus1 = a => a + 1;
4  const mult2 = a => a * 2;
5  const addThenMult = pipeline(plus1, mult2);
6  addThenMult(5);  // 12
```
å…ˆçœ‹ç¬¬5è¡Œä»£ç ï¼Œè¿™é‡Œè°ƒç”¨äº†pipeline()å‡½æ•°ï¼Œå¹¶ä¼ å…¥plus1å’Œmult2ä¸¤ä¸ªå‚æ•°ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­ä½¿ç”¨reduce()å‡½æ•°å…ˆåè°ƒç”¨ä¼ å…¥çš„ä¸¤ä¸ªå¤„ç†å‡½æ•°ã€‚

åœ¨æ‰§è¡Œç¬¬6è¡Œä»£ç æ—¶ï¼Œpipeline()å‡½æ•°ä¸­çš„valä¸º5ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œreduce()å‡½æ•°æ—¶ï¼Œaä¸º5ï¼Œbä¸ºplus1()å‡½æ•°ï¼Œå®é™…ç›¸å½“äºæ‰§è¡Œ5 + 1 = 6ï¼Œå¹¶è¿”å›äº†è®¡ç®—ç»“æœã€‚

åœ¨ç¬¬äºŒæ¬¡æ‰§è¡Œreduce()å‡½æ•°æ—¶ï¼Œaä¸ºä¸Šä¸€æ¬¡è¿”å›çš„ç»“æœ6ï¼Œbä¸ºmult2()å‡½æ•°ï¼Œå®é™…ç›¸å½“äºæ‰§è¡Œ6Ã—2 = 12ï¼Œå› æ­¤æœ€åè¾“å‡ºâ€œ12â€ã€‚

### ä¸é€‚ç”¨çš„åœºæ™¯
#### ä¸é€‚åˆä½œä¸ºå¯¹è±¡çš„å‡½æ•°
ç®­å¤´å‡½æ•°å¹¶ä¸ä¼šç»‘å®šthisï¼Œå¦‚æœä½¿ç”¨ç®­å¤´å‡½æ•°å®šä¹‰å¯¹è±¡å­—é¢é‡çš„å‡½æ•°ï¼Œé‚£ä¹ˆå…¶ä¸­çš„thiså°†ä¼šæŒ‡å‘å¤–å±‚ä½œç”¨åŸŸï¼Œå¹¶ä¸ä¼šæŒ‡å‘å¯¹è±¡æœ¬èº«ï¼Œå› æ­¤ç®­å¤´å‡½æ•°å¹¶ä¸é€‚åˆä½œä¸ºå¯¹è±¡çš„å‡½æ•°ã€‚
#### ä¸èƒ½ä½œä¸ºæ„é€ å‡½æ•°ï¼Œä¸èƒ½ä½¿ç”¨newæ“ä½œç¬¦
æ„é€ å‡½æ•°æ˜¯é€šè¿‡newæ“ä½œç¬¦ç”Ÿæˆå¯¹è±¡å®ä¾‹çš„ï¼Œ**ç”Ÿæˆå®ä¾‹çš„è¿‡ç¨‹ä¹Ÿæ˜¯é€šè¿‡æ„é€ å‡½æ•°ç»™å®ä¾‹ç»‘å®šthisçš„è¿‡ç¨‹**ï¼Œè€Œç®­å¤´å‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisã€‚å› æ­¤ä¸èƒ½ä½¿ç”¨ç®­å¤´å‡½æ•°ä½œä¸ºæ„é€ å‡½æ•°ï¼Œä¹Ÿå°±ä¸èƒ½é€šè¿‡newæ“ä½œç¬¦æ¥è°ƒç”¨ç®­å¤´å‡½æ•°ã€‚
```js
// æ™®é€šå‡½æ•°
function Person(name) {
    this.name = name;
}
var p = new Person('ming'); // æ­£å¸¸
// ç®­å¤´å‡½æ•°
let Person = (name) => {
    this.name = name
};
let p = new Person('ming'); // Uncaught TypeError: Person is not a constructor
```
#### æ²¡æœ‰prototypeå±æ€§
ç®­å¤´å‡½æ•°ä¸­æ˜¯æ²¡æœ‰thisçš„ï¼Œä¹Ÿå°±ä¸å­˜åœ¨è‡ªå·±çš„ä½œç”¨åŸŸï¼Œå› æ­¤ç®­å¤´å‡½æ•°æ˜¯æ²¡æœ‰prototypeå±æ€§çš„ã€‚
```js
let a = () => {
    return 1;
};
function b(){
    return 2;
}
console.log(a.prototype);  // undefined
console.log(b.prototype);  // {constructor: Æ’}
```
#### ä¸é€‚åˆå°†åŸå‹å‡½æ•°å®šä¹‰æˆç®­å¤´å‡½æ•°
åœ¨ç»™æ„é€ å‡½æ•°æ·»åŠ åŸå‹å‡½æ•°æ—¶ï¼Œå¦‚æœä½¿ç”¨ç®­å¤´å‡½æ•°ï¼Œå…¶ä¸­çš„thisä¼šæŒ‡å‘å…¨å±€ä½œç”¨åŸŸwindowï¼Œè€Œå¹¶ä¸ä¼šæŒ‡å‘æ„é€ å‡½æ•°ï¼Œå› æ­¤å¹¶ä¸ä¼šè®¿é—®åˆ°æ„é€ å‡½æ•°æœ¬èº«ï¼Œä¹Ÿå°±æ— æ³•è®¿é—®åˆ°å®ä¾‹å±æ€§ï¼Œè¿™å°±å¤±å»äº†ä½œä¸ºåŸå‹å‡½æ•°çš„æ„ä¹‰ã€‚
```js
function Person(name) {
    this.name = name
}
Person.prototype.sayHello = () => {
    console.log(this);  // window
    console.log(this.name);  // undefined âŒâŒâŒ
};
let p1 = new Person('ming');
p1.sayHello(); 
```
Person()æ„é€ å‡½æ•°å¢åŠ äº†ä¸€ä¸ªåŸå‹å‡½æ•°sayHello()ï¼Œå› ä¸ºsayHello()å‡½æ•°æ˜¯é€šè¿‡ç®­å¤´å‡½æ•°å®šä¹‰çš„ï¼Œæ‰€ä»¥å…¶ä¸­çš„thisä¼šæŒ‡å‘å…¨å±€ä½œç”¨åŸŸwindowï¼Œä»è€Œæ— æ³•è®¿é—®åˆ°å®ä¾‹çš„nameå±æ€§ï¼Œè¾“å‡ºâ€œundefinedâ€ã€‚

## ES6å¯¹äºå¯¹è±¡çš„æ‰©å±•
### å±æ€§ç®€å†™
ä¼ ç»Ÿçš„JavaScriptä¸­ï¼Œå¯¹è±¡éƒ½ä¼šé‡‡ç”¨`{ key: value }`çš„å†™æ³•ï¼Œä½†æ˜¯åœ¨ES6ä¸­ï¼Œå¯ä»¥ç›´æ¥åœ¨å¯¹è±¡ä¸­å†™å…¥å˜é‡ï¼Œkeyç›¸å½“äºå˜é‡åï¼Œvalueç›¸å½“äºå˜é‡å€¼ï¼Œå¹¶ä¸”å¯ä»¥ç›´æ¥çœç•¥valueï¼Œé€šè¿‡keyè¡¨ç¤ºä¸€ä¸ªå¯¹è±¡çš„å®Œæ•´å±æ€§ã€‚
```js
const name = 'ming';
const age = 12;
const obj = { name, age }; // { name: 'ming', age: 12 }
// ç­‰åŒäº
const obj = {
    name: name,
    age: age
};
```
å‡½æ•°ä¹Ÿå¯ä»¥ç®€å†™ï¼Œå³çœç•¥æ‰å…³é”®å­—functionã€‚
```js
const obj = {
    method: function () {
        return 'Hello';      
    }
};
// ç­‰åŒäº
const obj = {
    method() {
        return 'Hello';
    }
};
```

æŒ‰ç…§**CommonJSå†™æ³•**ï¼Œå½“éœ€è¦è¾“å‡ºä¸€ç»„æ¨¡å—å˜é‡æ—¶ï¼Œå¯¹è±¡ç®€å†™çš„æ–¹æ³•å°±éå¸¸åˆé€‚ã€‚
```js
// ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä½¿ç”¨å±æ€§ç®€å†™çš„ä¾‹å­ã€‚
let obj = {};
// è·å–å…ƒç´ 
function getItem (key) {
  return key in obj ? obj[key] : null;
}
// å¢åŠ å…ƒç´ 
function setItem (key, value) {
  obj[key] = value;
}
// æ¸…ç©ºå¯¹è±¡
function clear() {
  obj = {};
}
module.exports = { getItem, setItem, clear };
// ç­‰åŒäº
module.exports = { getItem: getItem, setItem: setItem, clear: clear };
```
### å±æ€§éå†ğŸ‘ğŸ‘ğŸ‘
åˆ°ES6ä¸ºæ­¢ï¼Œä¸€å…±æœ‰5ç§æ–¹æ³•å¯ä»¥å®ç°å¯¹è±¡å±æ€§çš„éå†ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚
- for...inã€‚
- Object.keys(obj)ã€‚
- Object.getOwnPropertyNames(obj)ã€‚
- Object.getOwnPropertySymbols(obj)ã€‚
- Reflect.ownKeys(obj)ã€‚

ä½¿ç”¨æ–¹æ³•å’Œå·®å¼‚æ€§ã€‚

å®šä¹‰ä¸€ä¸ªæ‹¥æœ‰å®ä¾‹å±æ€§ã€ç»§æ‰¿å±æ€§çš„å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«Symbolå±æ€§ã€å¯æšä¸¾å±æ€§ã€ä¸å¯æšä¸¾å±æ€§ï¼Œè¦†ç›–å…¨éƒ¨çš„åœºæ™¯ï¼Œç”¨æ¥æµ‹è¯•è¿™5ç§å±æ€§éå†æ–¹æ³•çš„å·®å¼‚ã€‚
```js
// å®šä¹‰çˆ¶ç±»
function Animal(name, type) {
  this.name = name;
  this.type = type;
}
// å®šä¹‰å­ç±»
function Cat(age, weight) {
  this.age = age;
  this.weight = weight;
  this[Symbol('one')] = 'one';
}
// å­ç±»ç»§æ‰¿çˆ¶ç±»
Cat.prototype = new Animal();
Cat.prototype.constructor = Cat;
// ç”Ÿæˆå­ç±»çš„å®ä¾‹
let cat = new Cat(12, '10kg');
// å®ä¾‹å¢åŠ å¯æšä¸¾å±æ€§
Object.defineProperty(cat, 'color', {
  configurable: true,
  enumerable: true,
  value: 'blue',
  writable: true
});
// å®ä¾‹å¢åŠ ä¸å¯æšä¸¾å±æ€§
Object.defineProperty(cat, 'height', {
  configurable: true,
  enumerable: false,
  value: '20cm',
  writable: true
});
```
å®ä¾‹catå…·æœ‰çš„å±æ€§å¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
å®ä¾‹å±æ€§: age, weight, Symbol('one'), color
ç»§æ‰¿å±æ€§: name, type
å¯æšä¸¾å±æ€§ï¼šage, weight, color
ä¸å¯æšä¸¾å±æ€§: height
Symbolå±æ€§: Symbol('one')
```
#### for...in
> ç”¨äºéå†å¯¹è±¡è‡ªèº«å’Œç»§æ‰¿çš„å¯æšä¸¾å±æ€§ï¼ˆ**ä¸åŒ…å«**Symbolå±æ€§ï¼‰ã€‚
```js
for(let key in cat) {
  console.log(key); // 'age', 'weight', 'color', 'name', 'type'
}
```
æ²¡æœ‰åŒ…å«ä¸å¯æšä¸¾å±æ€§heightå’ŒSymbolå±æ€§Symbol('one')ã€‚
#### Object.keys()å‡½æ•°
> è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ**åŒ…å«**å¯¹è±¡è‡ªèº«æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼Œ**ä¸åŒ…å«**ç»§æ‰¿å±æ€§å’ŒSymbolå±æ€§ã€‚
```js
Object.keys(cat); // ['age', 'weight', 'color']
```
#### Object.getOwnPropertyNames()å‡½æ•°
> è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ**åŒ…å«**å¯¹è±¡è‡ªèº«æ‰€æœ‰å¯æšä¸¾å±æ€§å’Œä¸å¯æšä¸¾å±æ€§ï¼Œ**ä¸åŒ…å«**ç»§æ‰¿å±æ€§å’ŒSymbolå±æ€§ã€‚
```js
Object.getOwnPropertyNames(cat); // ['age', 'weight', 'color', 'height']
```
#### Object.getOwnPropertySymbols()å‡½æ•°
> è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ**åŒ…å«**å¯¹è±¡è‡ªèº«æ‰€æœ‰Symbolå±æ€§ï¼Œ**ä¸åŒ…å«**å…¶ä»–å±æ€§ã€‚
```js
Object.getOwnPropertySymbols(cat); // [Symbol('one')]
```
#### Reflect.ownKeys()å‡½æ•°
> è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œ**åŒ…å«**å¯æšä¸¾å±æ€§ã€ä¸å¯æšä¸¾å±æ€§ä»¥åŠSymbolå±æ€§ï¼Œ**ä¸åŒ…å«**ç»§æ‰¿å±æ€§ã€‚
```js
Reflect.ownKeys(cat); // ['age', 'weight', 'color', 'height', Symbol('one')]
```
### æ–°å¢Object.assign()å‡½æ•°
ç”¨äºå°†ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¯¹è±¡çš„**å¯æšä¸¾å±æ€§èµ‹å€¼ç»™ç›®æ ‡å¯¹è±¡**ï¼Œç„¶åè¿”å›ç›®æ ‡å¯¹è±¡ã€‚

å½“å¤šä¸ªæºå¯¹è±¡å…·æœ‰ç›¸åŒçš„å±æ€§æ—¶ï¼Œåè€…çš„å±æ€§å€¼ä¼šè¦†ç›–å‰é¢çš„å±æ€§å€¼ã€‚
```js
let target = { a: 1 }; //ç›®æ ‡å¯¹è±¡
let source1 = { b: 2 }; //æºå¯¹è±¡1
let source2 = { c: 3 }; //æºå¯¹è±¡2
let source3 = { c: 4 }; //æºå¯¹è±¡3ï¼Œå’Œsource2å¯¹è±¡æœ‰åŒåå±æ€§c
console.log(Object.assign(target, source1, source2, source3));
// { a: 1, b: 2, c: 4 }
```
> Object.assign()å‡½æ•°æ— æ³•å¤åˆ¶å¯¹è±¡çš„ä¸å¯æšä¸¾å±æ€§å’Œç»§æ‰¿å±æ€§ï¼Œä½†å¯ä»¥å¤åˆ¶å¯æšä¸¾çš„Symbolå±æ€§ã€‚
```js
// åˆ›å»ºä¸€ä¸ªåŒæ—¶æ‹¥æœ‰å¯æšä¸¾å±æ€§ã€ä¸å¯æšä¸¾å±æ€§ã€ç»§æ‰¿å±æ€§ã€Symbolå±æ€§çš„å¯¹è±¡ã€‚
let obj = Object.create(
  { a: 1 }, // aæ˜¯ç»§æ‰¿å±æ€§
  { 
    b: { value: 2 }, // bæ˜¯ä¸å¯æšä¸¾å±æ€§
    c: { value: 3, enumerable: true }, // cæ˜¯å¯æšä¸¾å±æ€§
    [Symbol('one')]: { value: 'one', enumerable: true } // Symbolå±æ€§
});
console.log(Object.assign({}, obj)); // { c: 3, Symbol(one): "one" }
```
#### å¯¹è±¡å…‹éš†
æµ…å…‹éš†ï¼šå¦‚æœå±æ€§æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ™ä¼šå¤åˆ¶å®ƒçš„å€¼ï¼›å¦‚æœå±æ€§æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆ™ä¼šå¤åˆ¶å®ƒçš„å¼•ç”¨ã€‚
```js
function cloneObj(source) {
    return Object.assign({}, source);
}
let source = {
    name: 'ming',
    age: 18
};
let result = cloneObj(source);
console.log(result); // { name: 'ming', age: 18 }
```

```js
1 let target = {};
2 let source1 = {a: 1, b: {c: 2}};
3 let result = Object.assign(target, source1);
4 console.log(result.a);  // 1
5 console.log(result.b.c);// 2
6 source1.b.c = 3;
7 console.log(result.b.c); // 3
```
é€šè¿‡ä¸Šé¢å®ä¾‹çš„ç¬¬1ï½5è¡Œä»£ç å¯ä»¥çœ‹å‡ºï¼Œå°†source1å¯¹è±¡çš„å±æ€§å¤åˆ¶åå¾—åˆ°äº†resultå¯¹è±¡ï¼Œæ—¢å¯ä»¥è®¿é—®åˆ°åŸºæœ¬æ•°æ®ç±»å‹å±æ€§aï¼Œä¹Ÿå¯ä»¥è®¿é—®åˆ°å¼•ç”¨æ•°æ®ç±»å‹å±æ€§cã€‚
é€šè¿‡ç¬¬6ã€7è¡Œä»£ç å¯ä»¥çœ‹å‡ºï¼Œå› ä¸ºä½¿ç”¨çš„æ˜¯æµ…å…‹éš†ï¼Œå¯¹æºå¯¹è±¡å±æ€§å€¼è¿›è¡Œçš„ä¿®æ”¹ä¼šå½±å“åˆ°ç›®æ ‡å¯¹è±¡çš„å±æ€§å€¼ï¼Œä¸¤è€…å®é™…å…±äº«åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ã€‚
#### ç»™å¯¹è±¡æ·»åŠ å±æ€§
é‡‡ç”¨ä¼ ç»Ÿçš„å†™æ³•ä¸ºå¯¹è±¡æ·»åŠ å®ä¾‹å±æ€§æ—¶ï¼Œä¼šå°†å…¶æ·»åŠ åˆ°thiså±æ€§ä¸Šã€‚
å½“å±æ€§å¾ˆå¤šæ—¶ï¼Œé€šè¿‡Object.assign()å‡½æ•°å¯ä»¥èŠ‚çº¦æ“ä½œã€‚
```js
// ä¼ ç»Ÿçš„å†™æ³•
function Person(name, age, address) {
    this.name = name;
    this.age = age;
    this.address = address;
}
// Object.assign()å†™æ³•
function Person(name, age, address) {
    Object.assign(this, {name, age, address});
}
```
#### ç»™å¯¹è±¡æ·»åŠ å‡½æ•°
é‡‡ç”¨ä¼ ç»Ÿçš„å†™æ³•ä¸ºå¯¹è±¡æ·»åŠ å…¬å…±çš„å‡½æ•°æ—¶ï¼Œä¼šæ‰©å±•å…¶prototypeå±æ€§ï¼Œä½¿ç”¨Object.assign()å‡½æ•°ä¹Ÿå¯ä»¥ç®€åŒ–ä»£ç ç¼–å†™æ–¹å¼ã€‚
```js
// ä¼ ç»Ÿå†™æ³•
Person.prototype.getName = function () {
    return this.name;
};
Person.prototype.getAge = function () {
    return this.age;
};
// Object.assign()å†™æ³•
Object.assign(Person.prototype, {
    getName() {
        return this.name;
    },
    getAge() {
        return this.age;  
    }
});
```
#### åˆå¹¶å¯¹è±¡
å³å¯ä»¥å°†å¤šä¸ªå¯¹è±¡åˆå¹¶åˆ°æŸä¸ªå¯¹è±¡ä¸­ï¼Œä¹Ÿå¯ä»¥å°†å¤šä¸ªå¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶è¿”å›ï¼Œåªéœ€è¦å°†targetè®¾ç½®ä¸ºç©ºå¯¹è±¡{}å³å¯ã€‚
```js
// å¤šä¸ªå¯¹è±¡åˆå¹¶åˆ°ä¸€ä¸ªç›®æ ‡å¯¹è±¡ä¸­
const merge = (target, ...sources) => Object.assign(target, ...sources);
// å¤šä¸ªå¯¹è±¡åˆå¹¶ä¸ºä¸€ä¸ªæ–°å¯¹è±¡å¹¶è¿”å›
const merge = (...sources) => Object.assign({}, ...sources);
```
## Symbolç±»å‹
åœ¨ä¼ ç»Ÿçš„JavaScriptä¸­ï¼Œå¯¹è±¡çš„å±æ€§åéƒ½æ˜¯ç”±å­—ç¬¦ä¸²æ„æˆçš„ã€‚è¿™æ ·å°±ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼Œå‡å¦‚ä¸€ä¸ªå¯¹è±¡ç»§æ‰¿äº†å¦ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œåˆéœ€è¦å®šä¹‰æ–°çš„å±æ€§æ—¶ï¼Œå¾ˆå®¹æ˜“é€ æˆå±æ€§åçš„å†²çªã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6å¼•å…¥äº†ä¸€ç§æ–°çš„åŸºæœ¬æ•°æ®ç±»å‹Symbolï¼Œ**å®ƒè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å€¼**ã€‚

è‡³æ­¤JavaScriptä¸­å°±ä¸€å…±å­˜åœ¨6ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ†åˆ«æ˜¯Undefinedç±»å‹ã€Nullç±»å‹ã€Booleanç±»å‹ã€Stringç±»å‹ã€Numberç±»å‹ã€**Symbolç±»å‹**ã€‚
### Symbolç±»å‹çš„ç‰¹æ€§
#### å€¼çš„å”¯ä¸€æ€§
ç±»ä¼¼äºä¸€ç§å”¯ä¸€æ ‡è¯†æ€§çš„IDï¼Œé€šè¿‡Symbol()å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ªSymbolå€¼ã€‚
```js
let s = Symbol();
// Symbolç±»å‹æ˜¯ä¸€ä¸ªæ–°å¢çš„åŸºæœ¬æ•°æ®ç±»å‹
console.log(typeof s); // symbol
```
åœ¨Symbol()å‡½æ•°ä¸­å¯ä»¥ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œè¡¨ç¤ºå¯¹Symbolå€¼çš„æè¿°ï¼Œä¸»è¦æ˜¯æ–¹ä¾¿å¯¹ä¸åŒSymbolå€¼çš„åŒºåˆ†ã€‚
ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºSymbolå€¼çš„å”¯ä¸€æ€§ï¼Œ**ä»»ä½•é€šè¿‡Symbol()å‡½æ•°åˆ›å»ºçš„Symbolå€¼éƒ½æ˜¯ä¸ç›¸åŒçš„ï¼Œå³ä½¿ä¼ é€’äº†ç›¸åŒçš„å­—ç¬¦ä¸²**ã€‚
```js
const a = Symbol();
const b = Symbol();
const c = Symbol('one');
const d = Symbol('one');
console.log(a === b);  // false
console.log(c === d);  // false
```
#### ä¸èƒ½ä½¿ç”¨newæ“ä½œç¬¦
Symbolå‡½æ•°å¹¶ä¸æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå› æ­¤ä¸èƒ½é€šè¿‡newæ“ä½œç¬¦åˆ›å»ºSymbolå€¼ã€‚
```js
let s1 = new Symbol(); // TypeError: Symbol is not a constructor
```
#### ä¸èƒ½å‚ä¸ç±»å‹è¿ç®—
Symbolå€¼å¯ä»¥é€šè¿‡toString()å‡½æ•°æ˜¾ç¤ºåœ°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯æœ¬èº«ä¸èƒ½å‚ä¸å…¶ä»–ç±»å‹å€¼çš„è¿ç®—ï¼Œä¾‹å¦‚åœ¨å¯¹Symbolå€¼è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œæ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
let s4 = Symbol('hello');
s4.toString(); // Symbol(hello)
's4 content is: ' + s4; // TypeError: Cannot convert a Symbol value to a string
```
#### å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªSymbolå€¼
é€šè¿‡Symbol()å‡½æ•°åˆ›å»ºçš„æ¯ä¸ªå€¼éƒ½æ˜¯ä¸åŒçš„ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬æƒ³è¦ä½¿ç”¨åŒä¸€ä¸ªSymbolå€¼æ—¶ï¼Œè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ

é‚£å°±æ˜¯ä½¿ç”¨Symbol.for()å‡½æ•°ï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œç„¶åæœç´¢æœ‰æ²¡æœ‰ä»¥è¯¥å‚æ•°ä½œä¸ºåç§°çš„Symbolå€¼ã€‚å¦‚æœæœ‰ï¼Œå°±è¿”å›è¿™ä¸ªSymbolå€¼ï¼Œå¦åˆ™å°±æ–°å»ºå¹¶è¿”å›ä¸€ä¸ªä»¥è¯¥å­—ç¬¦ä¸²ä¸ºåç§°çš„Symbolå€¼ã€‚
```js
let s1 = Symbol.for('one');
let s2 = Symbol.for('one');
s1 === s2; // true
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œé€šè¿‡Symbol.for()å‡½æ•°ä¼ å…¥ç›¸åŒçš„å­—ç¬¦ä¸²ä¼šå¾—åˆ°ç›¸åŒçš„Symbolå€¼ï¼Œå› æ­¤è¿”å›â€œtrueâ€ã€‚

Symbol.for()å‡½æ•°ä¸Symbol()å‡½æ•°è¿™ä¸¤ç§å†™æ³•ï¼Œéƒ½ä¼šç”Ÿæˆæ–°çš„Symbolå€¼ã€‚
å®ƒä»¬çš„åŒºåˆ«æ˜¯ï¼šå‰è€…ä¼šè¢«ç™»è®°åœ¨å…¨å±€ç¯å¢ƒä¸­ä»¥ä¾›æœç´¢ï¼Œè€Œåè€…ä¸ä¼šã€‚Symbol.for()å‡½æ•°ä¸ä¼šæ¯æ¬¡è°ƒç”¨å°±è¿”å›ä¸€ä¸ªæ–°çš„Symbolç±»å‹çš„å€¼ï¼Œè€Œæ˜¯ä¼šå…ˆæ£€æŸ¥ç»™å®šçš„keyæ˜¯å¦å·²ç»å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨æ‰ä¼šæ–°å»ºä¸€ä¸ªå€¼ã€‚
```js
Symbol.for("bar") === Symbol.for("bar"); // true
Symbol("bar") === Symbol("bar");  // false
```
### Symbolç±»å‹çš„ç”¨æ³•
#### ç”¨ä½œå¯¹è±¡å±æ€§å
ç”±äºæ¯ä¸€ä¸ªSymbolå€¼éƒ½æ˜¯ä¸ç›¸ç­‰çš„ï¼Œå®ƒä¼šç»å¸¸ç”¨ä½œå¯¹è±¡çš„å±æ€§åï¼Œå°¤å…¶æ˜¯å½“ä¸€ä¸ªå¯¹è±¡ç”±å¤šä¸ªæ¨¡å—ç»„æˆæ—¶ï¼Œè¿™æ ·èƒ½å¤Ÿé¿å…å±æ€§åè¢«è¦†ç›–çš„æƒ…å†µã€‚
åœ¨ä½¿ç”¨Symbolç±»å‹çš„æ•°æ®æ—¶ï¼Œå­˜åœ¨å‡ ç§ä¸åŒçš„å†™æ³•ï¼Œéµå¾ªçš„ä¸€ä¸ªåŸåˆ™å°±æ˜¯**ä¸ºå¯¹è±¡å­—é¢é‡æ–°å¢å±æ€§æ—¶éœ€è¦ä½¿ç”¨æ–¹æ‹¬å·[]**ã€‚
```js
// æ–°å¢ä¸€ä¸ªsymbolå±æ€§
let PROP_NAME = Symbol();

// ç¬¬ä¸€ç§å†™æ³•
let obj = {};
obj[PROP_NAME] = 'Hello';

// ç¬¬äºŒç§å†™æ³•
let obj = {
    [PROP_NAME]: 'Hello'
};

// ç¬¬ä¸‰ç§å†™æ³•
let obj = {};
Object.defineProperty(obj, PROP_NAME, {
    value: 'Hello' 
});
```
> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸èƒ½é€šè¿‡ç‚¹è¿ç®—ç¬¦ä¸ºå¯¹è±¡æ·»åŠ Symbolå±æ€§ã€‚
```js
const PROP_NAME = Symbol();
const obj = {};

obj.PROP_NAME = 'Hello!';
console.log(obj[PROP_NAME]);  // undefined
console.log(obj['PROP_NAME']); // 'Hello'
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œåœ¨é€šè¿‡ç‚¹è¿ç®—ç¬¦ä¸ºobjå¢åŠ PROP_NAMEå±æ€§æ—¶ï¼Œ**è¿™ä¸ªPROP_NAMEå®é™…æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²**ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªSymbolå˜é‡ã€‚å› æ­¤é€šè¿‡ä¸­æ‹¬å·è¾“å‡ºPROP_NAMEå˜é‡å¯¹åº”çš„å€¼æ—¶ï¼Œå¾—åˆ°çš„æ˜¯â€œundefinedâ€ï¼›è€Œé€šè¿‡ä¸­æ‹¬å·è¾“å‡º'PROP_NAME'å­—ç¬¦ä¸²å€¼æ—¶ï¼Œå¾—åˆ°çš„æ˜¯å­—ç¬¦ä¸²'Hello'ã€‚
#### ç”¨äºå±æ€§åŒºåˆ†
ä¸€ç§åœºæ™¯ï¼Œå³é€šè¿‡åŒºåˆ†ä¸¤ä¸ªå±æ€§æ¥åšå¯¹åº”çš„å¤„ç†ã€‚

å‡å¦‚å†™ä¸€ä¸ªå…¬å…±çš„å‡½æ•°ç”¨æ¥è®¡ç®—å›¾å½¢çš„é¢ç§¯ï¼Œä¸‰è§’å½¢é¢ç§¯ä¸º1/2Ã—åº•Ã—é«˜ï¼Œé•¿æ–¹å½¢é¢ç§¯ä¸ºåº•Ã—é«˜ã€‚åœ¨ä¼ ç»Ÿçš„å†™æ³•ä¸Šï¼Œä¼šé€šè¿‡switchåˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºå­—ç¬¦ä¸²'triangle'æˆ–è€…å­—ç¬¦ä¸²'rectangle'ï¼Œç„¶ååœ¨è°ƒç”¨çš„æ—¶å€™ä¼ é€’å¯¹åº”çš„å­—ç¬¦ä¸²ã€‚
```js
// æ±‚å›¾å½¢çš„é¢ç§¯
function getArea(shape, options) {
    let area = 0;
    switch (shape) {
        case 'triangle':
            area = .5 * options.width * options.height;
            break;
        case 'rectangle':
            area = options.width * options.height;
            break;
    }
    return area;
}
console.log(getArea('triangle', { width: 100, height: 100 }));  // 5000
console.log(getArea('rectangle', { width: 100, height: 100 })); // 10000
```
åœ¨ä¸Šé¢çš„å†™æ³•ä¸­ï¼Œå­—ç¬¦ä¸²'triangle'å’Œ'rectangle'ä¼šå¼ºè€¦åˆåœ¨ä»£ç ä¸­ã€‚

è€Œäº‹å®ä¸Šï¼Œä»…æƒ³åŒºåˆ†å„ç§ä¸åŒçš„å½¢çŠ¶ï¼Œå¹¶ä¸å…³å¿ƒæ¯ä¸ªå½¢çŠ¶ä½¿ç”¨ä»€ä¹ˆå­—ç¬¦ä¸²è¡¨ç¤ºï¼Œåªéœ€è¦çŸ¥é“æ¯ä¸ªå˜é‡çš„å€¼æ˜¯ç‹¬ä¸€æ— äºŒçš„å³å¯ï¼Œæ­¤æ—¶ä½¿ç”¨Symbolå°±ä¼šå¾ˆåˆé€‚ã€‚
```js
// äº‹å…ˆå£°æ˜ä¸¤ä¸ªSymbolå€¼ï¼Œç”¨äºä½œåˆ¤æ–­
let shapeType = {
    triangle: Symbol('triangle'),
    rectangle: Symbol('rectangle')
};
function getArea(shape, options) {
    let area = 0;
    switch (shape) {
        case shapeType.triangle:
            area = .5 * options.width * options.height;
            break;
        case shapeType.rectangle:
            area = options.width * options.height;
            break;
    }
    return area;
}
console.log(getArea(shapeType.triangle, { width: 100, height: 100 }));  // 5000
console.log(getArea(shapeType.rectangle, { width: 100, height: 100 })); // 10000
```
#### ç”¨äºå±æ€§åéå†
ä½¿ç”¨Symbolä½œä¸ºå±æ€§åæ—¶ï¼Œä¸èƒ½é€šè¿‡Object.keys()å‡½æ•°æˆ–è€…for...inæ¥æšä¸¾ï¼Œè¿™æ ·å¯ä»¥å°†ä¸€äº›ä¸éœ€è¦å¯¹å¤–æ“ä½œå’Œè®¿é—®çš„å±æ€§é€šè¿‡Symbolæ¥å®šä¹‰ã€‚
```js
let obj = {
    [Symbol('name')]: 'Hello',
    age: 18,
    title: 'Engineer'
};
console.log(Object.keys(obj)); // ['age', 'title']
for (let p in obj) {
    console.log(p); // åˆ†åˆ«ä¼šè¾“å‡ºï¼š'age' å’Œ 'title'
}
console.log(Object.getOwnPropertyNames(obj)); // ['age', 'title']
```
å› ä¸ºSymbolå±æ€§ä¸ä¼šå‡ºç°åœ¨å±æ€§éå†çš„è¿‡ç¨‹ä¸­ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨JSON.stringify()å‡½æ•°å°†å¯¹è±¡è½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²æ—¶ï¼ŒSymbolå€¼ä¹Ÿä¸ä¼šå‡ºç°åœ¨ç»“æœä¸­
```js
JSON.stringify(obj);  // { "age": 18,"title": "Engineer" }
```
å½“æˆ‘ä»¬éœ€è¦è·å–Symbolå±æ€§æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸“é—¨é’ˆå¯¹Symbolçš„APIã€‚
```js
// ä½¿ç”¨Objectçš„API
Object.getOwnPropertySymbols(obj); // [Symbol(name)]
// ä½¿ç”¨æ–°å¢çš„åå°„API
Reflect.ownKeys(obj); // [Symbol(name), 'age', 'title']
```
## Setå’ŒMapæ•°æ®ç»“æ„
### Setæ•°æ®ç»“æ„
è¡¨ç¤ºçš„æ˜¯ä¸€ç»„æ•°æ®çš„é›†åˆï¼Œç±»ä¼¼äºæ•°ç»„ï¼Œä½†æ˜¯Setçš„æˆå‘˜å€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼Œæ²¡æœ‰é‡å¤ã€‚
Setæœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥æ¥æ”¶ä¸€ä¸ªæ•°ç»„æˆ–è€…ç±»æ•°ç»„å¯¹è±¡ä½œä¸ºå‚æ•°
1. å±æ€§
- Set.prototype.constructorï¼šæ„é€ å‡½æ•°ï¼Œé»˜è®¤å°±æ˜¯Setå‡½æ•°ã€‚
- Set.prototype.sizeï¼šè¿”å›å®ä¾‹çš„æˆå‘˜æ€»æ•°ã€‚

2. å‡½æ•°
- Set.prototype.add(value)ï¼šæ·»åŠ ä¸€ä¸ªå€¼ï¼Œè¿”å›Setç»“æ„æœ¬èº«ã€‚
- Set.prototype.delete(value)ï¼šåˆ é™¤æŸä¸ªå€¼ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚
- Set.prototype.has(value)ï¼šè¿”å›å¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ˜¯æˆå‘˜ã€‚
- Set.prototype.clear()ï¼šæ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ— è¿”å›å€¼ã€‚
å‘Setå®ä¾‹ä¸­æ·»åŠ æ–°çš„å€¼æ—¶ï¼Œä¸ä¼šå‘ç”Ÿç±»å‹è½¬æ¢ã€‚
å¯ä»¥ç†è§£ä¸ºä½¿ç”¨add()å‡½æ•°æ·»åŠ æ–°å€¼æ—¶ï¼Œæ–°å€¼ä¸Setå®ä¾‹ä¸­åŸæœ‰å€¼æ˜¯é‡‡ç”¨ä¸¥æ ¼ç›¸ç­‰ï¼ˆ===ï¼‰è¿›è¡Œæ¯”è¾ƒçš„ï¼Œåªæœ‰åœ¨ä¸¥æ ¼ç›¸ç­‰çš„æ¯”è¾ƒç»“æœä¸ºä¸ç›¸ç­‰æ—¶ï¼Œæ‰ä¼šå°†æ–°å€¼æ·»åŠ åˆ°Setå®ä¾‹ä¸­ã€‚
```js
let set = new Set();
set.add(1);
set.add("1");
console.log(set); // Set { 1, '1' }
```
ä¸Šè¿°è§„åˆ™å¯¹äºNaNæ˜¯ä¸€ä¸ªç‰¹ä¾‹ï¼ŒNaNä¸NaNåœ¨è¿›è¡Œä¸¥æ ¼ç›¸ç­‰çš„æ¯”è¾ƒæ—¶æ˜¯ä¸ç›¸ç­‰çš„ï¼Œä½†æ˜¯**åœ¨Setå†…éƒ¨NaNä¸NaNæ˜¯ä¸¥æ ¼ç›¸ç­‰çš„**ï¼Œå› æ­¤ä¸€ä¸ªSetå®ä¾‹ä¸­åªå¯ä»¥æ·»åŠ ä¸€ä¸ªNaNã€‚
```js
let set = new Set();
set.add(NaN);
set.add(NaN);
console.log(set); // Set { NaN }
```
#### Setçš„å¸¸è§ç”¨æ³•
##### å•ä¸€æ•°ç»„çš„å»é‡
ç”±äºSetæˆå‘˜å€¼å…·æœ‰å”¯ä¸€æ€§ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨Setæ¥è¿›è¡Œæ•°ç»„çš„å»é‡ã€‚
```js
let arr = [1, 3, 4, 2, 3, 2, 5];
console.log(new Set(arr)); // Set { 1, 3, 4, 2, 5 }
```
##### å¤šä¸ªæ•°ç»„çš„åˆå¹¶å»é‡
å…ˆä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦å°†å¤šä¸ªæ•°ç»„å¤„ç†æˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åå°†åˆå¹¶åå¾—åˆ°çš„æ•°ç»„ä¼ é€’ç»™Setæ„é€ å‡½æ•°ã€‚
```js
let arr1 = [1, 2, 3, 4];
let arr2 = [2, 3, 4, 5, 6];
let set1 = new Set([...arr1, ...arr2]);
console.log(set1); // Set { 1, 2, 3, 4, 5, 6 }
```
##### Setä¸æ•°ç»„çš„è½¬æ¢
å°†æ•°ç»„è½¬æ¢ä¸ºSetæ—¶ï¼Œåªéœ€è¦é€šè¿‡Setçš„æ„é€ å‡½æ•°å³å¯ï¼›
å°†Setè½¬æ¢ä¸ºæ•°ç»„æ—¶ï¼Œé€šè¿‡Array.from()å‡½æ•°æˆ–è€…æ‰©å±•è¿ç®—ç¬¦å³å¯ã€‚
```js
let arr = [1, 3, 5, 7];
// å°†æ•°ç»„è½¬æ¢ä¸ºSet
let set = new Set(arr);
console.log(set);  // Set { 1, 3, 5, 7 }

let set = new Set();
set.add('a');
set.add('b');
// å°†Setè½¬æ¢ä¸ºæ•°ç»„ï¼Œé€šè¿‡Array.from()å‡½æ•°
let arr = Array.from(set);
console.log(arr);  // [ 'a', 'b' ]
// å°†Setè½¬æ¢ä¸ºæ•°ç»„ï¼Œé€šè¿‡æ‰©å±•è¿ç®—ç¬¦
let arr2 = [...set];
console.log(arr2);  // [ 'a', 'b' ] 
```
#### Setçš„éå†
ä½¿ç”¨ä¼ ç»Ÿçš„forEach()å‡½æ•°è¿›è¡Œéå†ï¼Œä½†åœ¨Setä¸­æ²¡æœ‰ç´¢å¼•çš„æ¦‚å¿µï¼Œå®ƒå®é™…æ˜¯é”®å’Œå€¼ç›¸åŒçš„é›†åˆï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºçš„æ˜¯é”®ï¼Œå®é™…ä¸ç¬¬ä¸€ä¸ªå‚æ•°ç›¸åŒï¼Œä¹Ÿè¿”å›æ•°æ®å€¼æœ¬èº«ã€‚
```js
let set5 = new Set([4, 5, 'hello']);

set5.forEach((item, index) => {
    console.log(item, index);
});
// 4 4
// 5 5
// hello hello
```
è¿˜å¯ä»¥ä½¿ç”¨ä»¥ä¸‹3ç§å‡½æ•°ï¼š
- keys()ï¼šè¿”å›é”®åçš„éå†å™¨ã€‚
- values()ï¼šè¿”å›é”®å€¼çš„éå†å™¨ã€‚
- entries()ï¼šè¿”å›é”®å€¼å¯¹çš„éå†å™¨ã€‚
é€šè¿‡ä¸Šè¿°å‡½æ•°è·å¾—çš„å¯¹è±¡éƒ½æ˜¯**éå†å™¨å¯¹è±¡Iterator**ï¼Œç„¶åé€šè¿‡for...ofå¾ªç¯å¯ä»¥è·å–æ¯ä¸€é¡¹çš„å€¼ã€‚
```js
let set = new Set(['red', 'green', 'blue']);

for (let item of set.keys()) {
    console.log(item);
}
// red
// green
// blue

for (let item of set.values()) {
    console.log(item);
}
// red
// green
// blue

for (let item of set.entries()) {
    console.log(item);
}
// ["red", "red"]
// ["green", "green"]
// ["blue", "blue"]
```
å› ä¸ºSetå®ä¾‹çš„é”®å’Œå€¼æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥keys()å‡½æ•°å’Œvalues()å‡½æ•°å®é™…è¿”å›çš„æ˜¯ç›¸åŒçš„å€¼ã€‚
### Mapæ•°æ®ç»“æ„
å®ƒçš„æœ¬è´¨æ˜¯ä¸€ç§é”®å€¼å¯¹çš„ç»„åˆã€‚ä½†æ˜¯ä¸å¯¹è±¡å­—é¢é‡ä¸åŒçš„æ˜¯ï¼Œ**å¯¹è±¡å­—é¢é‡çš„é”®åªèƒ½æ˜¯å­—ç¬¦ä¸²**ï¼Œå¯¹äºéå­—ç¬¦ä¸²ç±»å‹çš„å€¼ä¼šé‡‡ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œè€Œ**Mapçš„é”®å´å¯ä»¥ç”±å„ç§ç±»å‹çš„å€¼ç»„æˆ**ã€‚
```js
// ä¼ ç»Ÿçš„å¯¹è±¡ç±»å‹ï¼ˆå¯¹è±¡å­—é¢é‡ï¼‰
const data = {};
const element = document.getElementById('home');
data[element] = 'first';
console.log(data); // {[object HTMLDivElement]: "first"}
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œé‡‡ç”¨çš„æ˜¯ä¼ ç»Ÿçš„å¯¹è±¡å¤„ç†æ–¹æ¡ˆï¼Œå°†ä¸€ä¸ªDOMå…ƒç´ ä½œä¸ºå¯¹è±¡çš„å±æ€§åï¼Œåœ¨è¾“å‡ºæ—¶DOMå…ƒç´ çš„å€¼ä¼šè¢«è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚
```js
// Map
const map = new Map();
const element = document.getElementById('home');
map.set(element, 'fist');
console.log(map);  // {div#home => "fist"}
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œé‡‡ç”¨çš„æ˜¯Mapå¤„ç†æ–¹æ¡ˆï¼Œå°†DOMå…ƒç´ ä½œä¸ºé”®æ·»åŠ åˆ°å®ä¾‹mapä¸­ï¼Œåœ¨è¾“å‡ºæ—¶ä¼šå‘ç°ï¼Œé”®çš„å€¼ä¸ºDOMå…ƒç´ çš„çœŸå®å€¼ï¼Œå¹¶æ²¡æœ‰è½¬æ¢ä¸ºå­—ç¬¦ä¸²çš„å€¼ã€‚

Mapæœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥æ¥æ”¶ä¸€ä¸ªæ•°ç»„ä½œä¸ºå‚æ•°ï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ åŒæ ·æ˜¯ä¸€ä¸ªå­æ•°ç»„ï¼Œå­æ•°ç»„å…ƒç´ è¡¨ç¤ºçš„æ˜¯é”®å’Œå€¼ã€‚
```js
const map = new Map([
    ['name', 'ming'],
    ['age', 123]
]);
console.log(map); // Map { 'name' => 'ming', 'age' => 123 }
```
Mapç»“æ„æœ‰ä¸€ç³»åˆ—çš„å®ä¾‹å±æ€§å’Œå‡½æ•°ï¼Œæ€»ç»“å¦‚ä¸‹ã€‚
- sizeå±æ€§ï¼šè¿”å›Mapç»“æ„çš„æˆå‘˜æ€»æ•°ã€‚
- set(key, value)ï¼šset()å‡½æ•°è®¾ç½®é”®åkeyå¯¹åº”çš„é”®å€¼ä¸ºvalueï¼Œset()å‡½æ•°è¿”å›çš„æ˜¯å½“å‰Mapå¯¹è±¡ï¼Œå› æ­¤set()å‡½æ•°å¯ä»¥é‡‡ç”¨é“¾å¼è°ƒç”¨çš„å†™æ³•ã€‚
- get(key)ï¼šget()å‡½æ•°è¯»å–keyå¯¹åº”çš„é”®å€¼ï¼Œå¦‚æœæ‰¾ä¸åˆ°keyï¼Œè¿”å›â€œundefinedâ€ã€‚
- has(key)ï¼šhas()å‡½æ•°è¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæŸä¸ªé”®æ˜¯å¦åœ¨å½“å‰Mapå¯¹è±¡ä¸­ã€‚
- delete(key)ï¼šdelete()å‡½æ•°åˆ é™¤æŸä¸ªé”®ï¼Œè¿”å›â€œtrueâ€ï¼›å¦‚æœåˆ é™¤å¤±è´¥ï¼Œè¿”å›â€œfalseâ€ã€‚
- clear()ï¼šclear()å‡½æ•°æ¸…é™¤æ‰€æœ‰æˆå‘˜ï¼Œæ²¡æœ‰è¿”å›å€¼ã€‚
åœ¨Mapæ•°æ®ç»“æ„ä¸­ï¼Œæ‰€æœ‰çš„é”®éƒ½å¿…é¡»å…·æœ‰å”¯ä¸€æ€§ã€‚å¯¹åŒä¸€ä¸ªé”®è¿›è¡Œå¤šæ¬¡èµ‹å€¼ï¼Œé‚£ä¹ˆåé¢çš„å€¼ä¼šè¦†ç›–å‰é¢çš„å€¼ã€‚
```js
const map = new Map();
map.set(1, 'aaa')
   .set(1, 'bbb');
map.get(1); // "bbb"
```
å¦‚æœMapå®ä¾‹çš„é”®æ˜¯åŸç”Ÿæ•°æ®ç±»å‹ï¼Œåˆ™é‡‡ç”¨ä¸¥æ ¼ç›¸ç­‰(===)åˆ¤æ–­æ˜¯å¦ä¸ºåŒä¸€ä¸ªé”®ã€‚
å¯¹äºNumberç±»å‹æ•°æ®ï¼Œ+0å’Œ-0ä¸¥æ ¼ç›¸ç­‰ï¼Œè™½ç„¶NaNä¸NaNä¸ä¸¥æ ¼ç›¸ç­‰ï¼Œä½†æ˜¯Mapä¼šå°†å…¶è§†ä¸ºä¸€ä¸ªç›¸åŒçš„é”®ã€‚
```js
let map = new Map();
map.set(-0, 123);
map.get(+0); // 123

map.set(NaN, 123);
map.set(NaN, 234);
map.get(NaN); // 234
```
å­—ç¬¦ä¸²'true'ä¸Booleanç±»å‹trueä¸ä¸¥æ ¼ç›¸ç­‰ï¼Œæ˜¯ä¸¤ä¸ªä¸åŒçš„é”®ã€‚
```js
let map = new Map();

map.set(true, 1);
map.set('true', 2);
map.get(true); // 1
```
å¯¹äºUndefinedç±»å‹å’ŒNullç±»å‹ï¼Œundefinedä¸nullä¹Ÿæ˜¯ä¸¤ä¸ªä¸åŒçš„é”®ã€‚
```js
let map = new Map();
map.set(undefined, 3);
map.set(null, 4);
map.get(undefined); // 3
map.get(null); // 4
```
å¦‚æœMapå®ä¾‹çš„é”®æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆ™éœ€è¦åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºåŒä¸€ä¸ªå¼•ç”¨ã€æ˜¯å¦å æ®åŒä¸€ä¸ªå†…å­˜åœ°å€ã€‚
```js
const map = new Map();
map.set([0], '0');
map.set([0], '1');

console.log(map); // Map { [ 0 ] => '0', [ 0 ] => '1' }
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œå°†æ•°ç»„[0]ä½œä¸ºmapçš„é”®ï¼Œä½†æ˜¯[0]ä½œä¸ºå¼•ç”¨ç±»å‹æ•°æ®ï¼Œ**æ¯æ¬¡ç”Ÿæˆä¸€ä¸ªæ–°çš„å€¼éƒ½ä¼šå æ®æ–°çš„å†…å­˜åœ°å€**ï¼Œå®é™…ä¸ºä¸åŒçš„é”®ï¼Œå› æ­¤mapåœ¨è¾“å‡ºæ—¶ä¼šæœ‰ä¸¤ä¸ªå…ƒç´ å€¼ã€‚
å¦‚æœå¸Œæœ›å…ƒç´ [0]åªå æ®åŒä¸€ä¸ªé”®ï¼Œåˆ™å¯ä»¥å°†å…¶èµ‹ç»™ä¸€ä¸ªå˜é‡å€¼ï¼Œé€šè¿‡å˜é‡å€¼æ·»åŠ åˆ°mapä¸­ã€‚
```js
let arr = [0];
const map = new Map();
map.set(arr, '0');
map.set(arr, '1');

console.log(map); // Map { [ 0 ] => '1' }
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œarrå¯¹åº”çš„å€¼[0]è¢«ä¸¤æ¬¡æ·»åŠ è‡³mapä¸­ï¼Œä½†æ˜¯å®é™…æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¼•ç”¨ï¼Œåœ¨å†…å­˜ä¸­å æ®åŒä¸€ä¸ªåœ°å€ï¼Œå› æ­¤åé¢çš„å€¼ä¼šè¦†ç›–å‰ä¸€ä¸ªå€¼ï¼Œæœ€åè¾“å‡ºçš„mapä¸­åªæœ‰ä¸€ä¸ªå€¼ã€‚

#### éå†
ä¸Setä¸€æ ·ï¼ŒMapçš„éå†åŒæ ·å¯ä»¥é‡‡ç”¨4ç§å‡½æ•°ï¼Œåˆ†åˆ«æ˜¯forEach()å‡½æ•°ã€keys()å‡½æ•°ã€values()å‡½æ•°ã€entries()å‡½æ•°ã€‚
å¯¹äºforEach()å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºçš„æ˜¯å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºçš„æ˜¯é”®ã€‚
```js
const map = new Map();
map.set('name', 'ming');
map.set('age', 12);

map.forEach(function (item, key) {
    console.log(item, key); 
});
// ming name
// 12 age
```
keys()å‡½æ•°è¿”å›çš„æ˜¯é”®çš„é›†åˆï¼Œvalues()å‡½æ•°è¿”å›çš„æ˜¯å€¼çš„é›†åˆï¼Œentries()å‡½æ•°è¿”å›çš„é”®å€¼å¯¹çš„é›†åˆã€‚

è¿™äº›é›†åˆéƒ½æ˜¯Iteratorçš„å®ä¾‹ï¼Œå¯ä»¥é€šè¿‡for...ofè¿›è¡Œéå†ã€‚
```js
for (let key of map.keys()) {
    console.log(key);
}
// name
// age

for (let value of map.values()) {
    console.log(value);
}
// ming
// 12

for (let obj of map.entries()) {
    console.log(obj);
}
// [ 'name', 'ming' ]
// [ 'age', 12 ]
```
#### ä¸å…¶ä»–æ•°æ®ç»“æ„çš„è½¬æ¢
```js
//Mapè½¬æ¢ä¸ºæ•°ç»„
const map = new Map();
map.set('name', 'ming');
map.set('age', 12);

const arr = [...map];
console.log(arr); // [ [ 'name', 'ming' ], [ 'age', 12 ] ]
```
æ•°ç»„è½¬æ¢ä¸ºMapï¼Œå¯ä»¥é€šè¿‡Mapæ„é€ å‡½æ•°å®ç°ï¼Œä½¿ç”¨newæ“ä½œç¬¦ç”ŸæˆMapçš„å®ä¾‹ã€‚
```js
// æ•°ç»„è½¬æ¢ä¸ºMap
const arr = [[ 'name', 'ming' ], [ 'age', 12 ]];
const map = new Map(arr);
console.log(map);  // Map { 'name' => 'ming', 'age' => 12 }
```
Mapè½¬æ¢ä¸ºå¯¹è±¡ï¼Œå¦‚æœMapçš„å®ä¾‹çš„é”®æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™å¯ä»¥ç›´æ¥è½¬æ¢ï¼›å¦‚æœé”®ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œåˆ™ä¼šå…ˆè½¬æ¢æˆå­—ç¬¦ä¸²ç„¶åå†è¿›è¡Œè½¬æ¢ã€‚
```js
// Mapè½¬æ¢ä¸ºå¯¹è±¡
function mapToObj(map) {
    let obj = {};
    for(let [key, value] of map) {
        obj[key] = value;
    }
    return obj;
}
console.log(mapToObj(map));  // { name: 'ming', age: 12 }
```
å¯¹è±¡è½¬æ¢ä¸ºMapï¼Œåªéœ€è¦éå†å¯¹è±¡çš„å±æ€§å¹¶é€šè¿‡set()å‡½æ•°æ·»åŠ åˆ°Mapçš„å®ä¾‹ä¸­å³å¯ã€‚
```js
// å¯¹è±¡è½¬æ¢ä¸ºMap
function objToMap(obj) {
    let map = new Map();
    for (let k of Object.keys(obj)) {
        map.set(k, obj[k]);
    }
    return map;
}
console.log(objToMap({yes: true, no: false}));
// Map {"yes" => true, "no" => false}
```
Mapè½¬æ¢ä¸ºJSONå­—ç¬¦ä¸²æ—¶ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯å½“Mapçš„é”®åéƒ½æ˜¯å­—ç¬¦ä¸²æ—¶ï¼Œå¯ä»¥å…ˆå°†Mapè½¬æ¢ä¸ºå¯¹è±¡ï¼Œç„¶åè°ƒç”¨JSON.stringify()å‡½æ•°ã€‚
```js
// Mapè½¬æ¢ä¸ºJSONï¼Œé€šè¿‡å¯¹è±¡
function mapToJson(strMap) {
    // å…ˆå°†mapè½¬æ¢ä¸ºå¯¹è±¡ï¼Œç„¶åè½¬æ¢ä¸ºJSON
    return JSON.stringify(mapToObj(strMap));
}
let myMap = new Map().set('yes', true).set('no', false);
console.log(mapToJson(myMap)); // {"yes":true,"no":false}
```
ç¬¬äºŒç§æ˜¯å½“Mapçš„é”®åæœ‰éå­—ç¬¦ä¸²æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†Mapè½¬æ¢ä¸ºæ•°ç»„ï¼Œç„¶åè°ƒç”¨JSON.stringify()å‡½æ•°ã€‚
```js
// Mapè½¬æ¢ä¸ºJSON,é€šè¿‡æ•°ç»„
function mapToArrayJson(map) {
    // å…ˆé€šè¿‡æ‰©å±•è¿ç®—ç¬¦è½¬æ¢ä¸ºæ•°ç»„ï¼Œå†è½¬æ¢ä¸ºJSON
    return JSON.stringify([...map]);
}
let myMap2 = new Map().set(true, 7).set({foo: 3}, ['abc']);
mapToArrayJson(myMap2); // [[true,7],[{"foo":3},["abc"]]] 
```
JSONè½¬æ¢ä¸ºMapã€‚JSONå­—ç¬¦ä¸²æ˜¯ç”±ä¸€ç³»åˆ—é”®å€¼å¯¹æ„æˆï¼Œé”®ä¸€èˆ¬éƒ½ä¸ºå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡è°ƒç”¨JSON.parse()å‡½æ•°å…ˆå°†JSONå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹è±¡ï¼Œç„¶åå†è½¬æ¢ä¸ºMapã€‚
```js
// JSONè½¬æ¢ä¸ºMap
function jsonToMap(jsonStr) {
    // å…ˆè½¬æ¢ä¸ºJSONå¯¹è±¡ï¼Œå†è½¬æ¢ä¸ºMap
    return objToMap(JSON.parse(jsonStr));
}
jsonToMap('{"yes": true, "no": false}'); // Map { 'yes' => true, 'no' => false }
```
Setè½¬æ¢ä¸ºMapï¼ŒSetä¸­ä»¥æ•°ç»„å½¢å¼å­˜åœ¨çš„æ•°æ®å¯ä»¥ç›´æ¥é€šè¿‡Mapçš„æ„é€ å‡½æ•°è½¬æ¢ä¸ºMapã€‚
```js
// Setè½¬æ¢ä¸ºMap
function setToMap(set) {
    return new Map(set);
}
const set = new Set([
    ['foo', 1],
    ['bar', 2]
]);
console.log(setToMap(set)); // Map { 'foo' => 1, 'bar' => 2 }
```
Mapè½¬æ¢ä¸ºSetï¼Œå¯ä»¥å°†éå†Mapæœ¬èº«è·å–åˆ°çš„é”®å’Œå€¼æ„æˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åé€šè¿‡add()å‡½æ•°æ·»åŠ è‡³setå®ä¾‹ä¸­ã€‚
```js
// Mapå®ä¾‹è½¬æ¢ä¸ºSet
function mapToSet(map) {
    let set = new Set();
    for (let [k,v] of map) {
        set.add([k, v])
    }
    return set;
}
const map14 = new Map()
    .set('yes', true)
    .set('no', false);
mapToSet(map14); // Set { [ 'yes', true ], [ 'no', false ] }
```
## Proxy
### æ¦‚è¿°
ES6ä¸­æ–°å¢äº†Proxyå¯¹è±¡ï¼Œä»å­—é¢ä¸Šçœ‹å¯ä»¥ç†è§£ä¸ºä»£ç†å™¨ï¼Œä¸»è¦ç”¨äºæ”¹å˜å¯¹è±¡çš„é»˜è®¤è®¿é—®è¡Œä¸ºï¼Œå®é™…è¡¨ç°æ˜¯åœ¨è®¿é—®å¯¹è±¡ä¹‹å‰å¢åŠ ä¸€å±‚æ‹¦æˆªï¼Œä»»ä½•å¯¹å¯¹è±¡çš„è®¿é—®è¡Œä¸ºéƒ½ä¼šé€šè¿‡è¿™å±‚æ‹¦æˆªã€‚
åœ¨æ‹¦æˆªä¸­ï¼Œå¯ä»¥å¢åŠ è‡ªå®šä¹‰çš„è¡Œä¸ºã€‚

Proxyçš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
const proxy = new Proxy(target, handler);
```
ä¸€ä¸ªæ„é€ å‡½æ•°ï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯ç›®æ ‡å¯¹è±¡targetï¼›å¦ä¸€ä¸ªæ˜¯é…ç½®å¯¹è±¡handlerï¼Œç”¨æ¥å®šä¹‰æ‹¦æˆªçš„è¡Œä¸ºã€‚

proxyã€targetå’Œhandlerä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ

é€šè¿‡Proxyæ„é€ å‡½æ•°å¯ä»¥ç”Ÿæˆå®ä¾‹proxyï¼Œ**ä»»ä½•å¯¹proxyå®ä¾‹çš„å±æ€§çš„è®¿é—®éƒ½ä¼šè‡ªåŠ¨è½¬å‘è‡³targetå¯¹è±¡ä¸Šï¼Œå¯ä»¥é’ˆå¯¹è®¿é—®çš„è¡Œä¸ºé…ç½®è‡ªå®šä¹‰çš„handlerå¯¹è±¡ï¼Œå› æ­¤å¤–ç•Œé€šè¿‡proxyè®¿é—®targetå¯¹è±¡çš„å±æ€§æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œhandlerå¯¹è±¡è‡ªå®šä¹‰çš„æ‹¦æˆªæ“ä½œ**ã€‚
```js
// å®šä¹‰ç›®æ ‡å¯¹è±¡
const person = {
    name: 'ming',
    age: 23
};
// å®šä¹‰é…ç½®å¯¹è±¡
let handler = {
    get: function (target, prop, receiver) {
        console.log("ä½ è®¿é—®äº†personçš„å±æ€§");
        return target[prop];
    }
};
// ç”ŸæˆProxyçš„å®ä¾‹
const p = new Proxy(person, handler);
// æ‰§è¡Œç»“æœ
console.log(p.name);
// ä½ è®¿é—®äº†personçš„å±æ€§
// ming
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªåŒ…å«get()å‡½æ•°çš„é…ç½®å¯¹è±¡ï¼Œè¡¨ç¤ºçš„æ˜¯å¯¹ä»£ç†å¯¹è±¡çš„å±æ€§è¿›è¡Œè¯»å–æ“ä½œæ—¶ï¼Œå°±ä¼šè§¦å‘get()å‡½æ•°ã€‚
å› æ­¤åœ¨æ‰§è¡Œp.nameï¼Œå³è°ƒç”¨Proxyå®ä¾‹çš„nameå±æ€§æ—¶ï¼Œä¼šè§¦å‘get()å‡½æ•°ï¼Œåœ¨æ§åˆ¶å°è¾“å‡ºâ€œä½ è®¿é—®äº†personçš„å±æ€§â€ï¼Œç„¶åè¿”å›å®é™…çš„nameå±æ€§å€¼ã€‚

åœ¨ä½¿ç”¨Proxyæ—¶ï¼Œæœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„å†…å®¹ã€‚
1. å¿…é¡»é€šè¿‡ä»£ç†å®ä¾‹è®¿é—®
å¦‚æœéœ€è¦é…ç½®å¯¹è±¡çš„æ‹¦æˆªè¡Œä¸ºç”Ÿæ•ˆï¼Œé‚£ä¹ˆå¿…é¡»æ˜¯å¯¹ä»£ç†å®ä¾‹çš„å±æ€§è¿›è¡Œè®¿é—®ï¼Œè€Œä¸æ˜¯ç›´æ¥å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œè®¿é—®ã€‚
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œå¦‚æœç›´æ¥é€šè¿‡ç›®æ ‡å¯¹è±¡personè®¿é—®nameå±æ€§ï¼Œåˆ™ä¸ä¼šè§¦å‘æ‹¦æˆªè¡Œä¸ºã€‚
```js
console.log(person.name); // ming
```
2. é…ç½®å¯¹è±¡ä¸èƒ½ä¸ºç©ºå¯¹è±¡
å¦‚æœéœ€è¦é…ç½®å¯¹è±¡çš„æ‹¦æˆªè¡Œä¸ºç”Ÿæ•ˆï¼Œé‚£ä¹ˆé…ç½®å¯¹è±¡ä¸èƒ½ä¸ºç©ºå¯¹è±¡ã€‚å¦‚æœä¸ºç©ºå¯¹è±¡ï¼Œåˆ™ä»£è¡¨æ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œå®é™…æ˜¯å¯¹ç›®æ ‡å¯¹è±¡çš„è®¿é—®ã€‚å¦å¤–é…ç½®å¯¹è±¡ä¸èƒ½ä¸ºnullï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
const p2 = new Proxy(person, {});
console.log(p2.name); // ming
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä¸ºpersonç”Ÿæˆäº†ä¸€ä¸ªProxyçš„å®ä¾‹ï¼Œä½†æ˜¯å…¶é…ç½®å¯¹è±¡ä¸ºä¸€ä¸ªç©ºå¯¹è±¡{}ï¼Œè¡¨ç¤ºæ²¡æœ‰è®¾ç½®ä»»ä½•æ‹¦æˆªï¼Œç›¸å½“äºç›´æ¥å¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œè®¿é—®ã€‚
### Proxyå®ä¾‹å‡½æ•°åŠå…¶åŸºæœ¬ä½¿ç”¨
13ç§å‡½æ•°æ±‡æ€»å¦‚ä¸‹ï¼š
1. get(target, propKey, receiver)ã€‚
æ‹¦æˆªå¯¹è±¡å±æ€§çš„è¯»å–æ“ä½œï¼Œä¾‹å¦‚è°ƒç”¨`proxy.name`æˆ–è€…`proxy[name]`ï¼Œå…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯è¯»å–çš„å±æ€§å€¼ï¼Œreceiverè¡¨ç¤ºçš„æ˜¯é…ç½®å¯¹è±¡ã€‚
2. set(target, propKey, value, receiver)ã€‚
æ‹¦æˆªå¯¹è±¡å±æ€§çš„å†™æ“ä½œï¼Œå³è®¾ç½®å±æ€§å€¼ï¼Œä¾‹å¦‚`proxy.name='ming'`æˆ–è€…`proxy[name]='ming'`ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯å°†è¦è®¾ç½®çš„å±æ€§ï¼Œvalueè¡¨ç¤ºå°†è¦è®¾ç½®çš„å±æ€§çš„å€¼ï¼Œreceiverè¡¨ç¤ºçš„æ˜¯é…ç½®å¯¹è±¡ã€‚
3. has(target, propKey)ã€‚
æ‹¦æˆªhasPropertyçš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œæœ€å…¸å‹çš„è¡¨ç°å½¢å¼æ˜¯æ‰§è¡ŒpropKey in targetï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºåˆ¤æ–­çš„å±æ€§ã€‚
4. deleteProperty(target, propKey)ã€‚
æ‹¦æˆª`delete proxy[propKey]`çš„æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦æ‰§è¡ŒæˆåŠŸï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºå°†è¦åˆ é™¤çš„å±æ€§ã€‚
5. ownKeys(target)ã€‚
æ‹¦æˆªObject.getOwnPropertyNames(proxy)ã€Object.getOwnPropertySymbols(proxy)ã€Object.keys(proxy)ã€for...inå¾ªç­‰æ“ä½œï¼Œå…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯è·å–å¯¹è±¡è‡ªèº«æ‰€æœ‰çš„å±æ€§åã€‚
6. getOwnPropertyDescriptor(target, propKey)ã€‚
æ‹¦æˆªObject.getOwnPropertyDescriptor(proxy, propKey)æ“ä½œï¼Œè¿”å›å±æ€§çš„å±æ€§æè¿°ç¬¦æ„æˆçš„å¯¹è±¡ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºéœ€è¦è·å–å±æ€§æè¿°ç¬¦é›†åˆçš„å±æ€§ã€‚
7. defineProperty(target, propKey, propDesc)ã€‚
æ‹¦æˆªObject.defineProperty(proxy, propKey, propDesc)ã€Object.defineProperties(proxy,propDescs)æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºæ–°å¢çš„å±æ€§ï¼ŒpropDescè¡¨ç¤ºçš„æ˜¯å±æ€§æè¿°ç¬¦å¯¹è±¡ã€‚
8. preventExtensions(target)ã€‚
æ‹¦æˆªObject.preventExtensions(proxy)æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºçš„æ˜¯è®©ä¸€ä¸ªå¯¹è±¡å˜å¾—ä¸å¯æ‰©å±•ï¼Œä¸èƒ½å†å¢åŠ æ–°çš„å±æ€§ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ã€‚
9. getPrototypeOf(target)ã€‚
æ‹¦æˆªObject.getPrototypeOf(proxy)æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºçš„æ˜¯æ‹¦æˆªè·å–å¯¹è±¡åŸå‹å±æ€§ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ã€‚
10. isExtensible(target)ã€‚
æ‹¦æˆªObject.isExtensible(proxy)ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºå¯¹è±¡æ˜¯å¦æ˜¯å¯æ‰©å±•çš„ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ã€‚
11. setPrototypeOf(target, proto)ã€‚
æ‹¦æˆªObject.setPrototypeOf(proxy, proto)æ“ä½œï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œè¡¨ç¤ºçš„æ˜¯æ‹¦æˆªè®¾ç½®å¯¹è±¡çš„åŸå‹å±æ€§çš„è¡Œä¸ºï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼Œprotoè¡¨ç¤ºæ–°çš„åŸå‹å¯¹è±¡ã€‚
12. apply(target, object, args)ã€‚
æ‹¦æˆªProxyå®ä¾‹ä½œä¸ºå‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œä¾‹å¦‚proxy(...args)ã€proxy.call(object, ...args)ã€proxy.apply(...)ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼Œobjectè¡¨ç¤ºå‡½æ•°çš„è°ƒç”¨æ–¹ï¼Œargsè¡¨ç¤ºå‡½æ•°è°ƒç”¨ä¼ é€’çš„å‚æ•°ã€‚
13. construct(target, args)ã€‚
æ‹¦æˆªProxyå®ä¾‹ä½œä¸ºæ„é€ å‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œä¾‹å¦‚new proxy(...args)ï¼Œå…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡ï¼Œargsè¡¨ç¤ºå‡½æ•°è°ƒç”¨ä¼ é€’çš„å‚æ•°ã€‚

> è¿™äº›å‡½æ•°éƒ½æœ‰ä¸€ä¸ªé€šç”¨çš„ç‰¹æ€§ï¼Œå³å¦‚æœåœ¨targetä¸­ä½¿ç”¨äº†thiså…³é”®å­—ï¼Œå†é€šè¿‡Proxyå¤„ç†åï¼Œthiså…³é”®å­—æŒ‡å‘çš„æ˜¯Proxyçš„å®ä¾‹ï¼Œè€Œä¸æ˜¯ç›®æ ‡å¯¹è±¡targetã€‚
```js
const person = {
    getName: function () {
        console.log(this === proxy);
    }
};
const proxy = new Proxy(person, {});

proxy.getName();  // true
person.getName(); // false
```

åº”ç”¨åœºæ™¯ã€‚
#### è¯»å–ä¸å­˜åœ¨å±æ€§
åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¯»å–ä¸€ä¸ªå¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§æ—¶ï¼Œä¼šè¿”å›â€œundefinedâ€ã€‚é€šè¿‡Proxyçš„get()å‡½æ•°å¯ä»¥è®¾ç½®è¯»å–ä¸å­˜åœ¨çš„å±æ€§æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œä»è€Œé¿å…å¯¹undefinedå€¼çš„å…¼å®¹æ€§å¤„ç†ã€‚
```js
let person = {
    name: 'ming'
};
const proxy = new Proxy(person, {
    get: function (target, propKey) {
        if(propKey in target) {
            return target[propKey];
        } else {
            throw new ReferenceError(`è®¿é—®çš„å±æ€§${propKey}ä¸å­˜åœ¨`);
        }
    }
});
console.log(proxy.name); // ming
console.log(proxy.age); // ReferenceError: è®¿é—®çš„å±æ€§ageä¸å­˜åœ¨
```
#### è¯»å–è´Ÿç´¢å¼•çš„å€¼
æ•°ç»„çš„ç´¢å¼•å€¼æ˜¯ä»0å¼€å§‹ä¾æ¬¡é€’å¢çš„ï¼Œæ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬æ— æ³•è¯»å–è´Ÿç´¢å¼•çš„å€¼ï¼Œä½†æ˜¯é€šè¿‡Proxyçš„get()å‡½æ•°å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚
è´Ÿç´¢å¼•å®é™…å°±æ˜¯ä»æ•°ç»„çš„å°¾éƒ¨å…ƒç´ å¼€å§‹ï¼Œä»åå¾€å‰ï¼Œå¯»æ‰¾å…ƒç´ çš„ä½ç½®ã€‚
```js
const arr = [1, 4, 9, 16, 25];
const proxy = new Proxy(arr, {
    get: function (target, index) {
        index = Number(index);
        if (index > 0) {
            return target[index];
        } else {
            // ç´¢å¼•ä¸ºè´Ÿå€¼ï¼Œåˆ™ä»å°¾éƒ¨å…ƒç´ å¼€å§‹è®¡ç®—ç´¢å¼•
            return target[target.length + index];
        }
    }
});
console.log(proxy[2]);  // 9
console.log(proxy[-2]); // 16
```
#### ç¦æ­¢è®¿é—®ç§æœ‰å±æ€§
åœ¨ä¸€äº›çº¦å®šä¿—æˆçš„å†™æ³•ä¸­ï¼Œ**ç§æœ‰å±æ€§éƒ½ä¼šä»¥ä¸‹ç”»çº¿ï¼ˆ_ï¼‰å¼€å¤´**ï¼Œäº‹å®ä¸Šå¹¶ä¸å¸Œæœ›ç”¨æˆ·èƒ½è®¿é—®åˆ°ç§æœ‰å±æ€§ï¼Œè¿™å¯ä»¥é€šè¿‡è®¾ç½®Proxyçš„get()å‡½æ•°æ¥å®ç°ã€‚
```js
const person = {
    name: 'ming',
    _pwd: '123456'
};
const proxy = new Proxy(person, {
    get: function (target, prop) {
        if (prop.indexOf('_') === 0) {
            throw new ReferenceError('ä¸å¯ç›´æ¥è®¿é—®ç§æœ‰å±æ€§');
        } else {
            return target[prop];
        }
    }
});
console.log(proxy.name); // ming
console.log(proxy._pwd); // ReferenceError: ä¸å¯ç›´æ¥è®¿é—®ç§æœ‰å±æ€§
```
#### Proxyè®¿é—®å±æ€§çš„é™åˆ¶
å½“æœŸæœ›ä½¿ç”¨Proxyå¯¹å¯¹è±¡çš„å±æ€§è¿›è¡Œä»£ç†ï¼Œå¹¶ä¿®æ”¹å±æ€§çš„è¿”å›å€¼æ—¶ï¼Œéœ€è¦è¿™ä¸ªå±æ€§ä¸èƒ½åŒæ—¶ä¸ºä¸å¯é…ç½®å’Œä¸å¯å†™ã€‚å¦‚æœè¿™ä¸ªå±æ€§åŒæ—¶ä¸ºä¸å¯é…ç½®å’Œä¸å¯å†™ï¼Œé‚£ä¹ˆåœ¨é€šè¿‡ä»£ç†è¯»å–å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
const target = Object.defineProperties({}, {
  name: {
    value: 'ming',
        // å¯é…ç½®çš„nameå±æ€§
        configurable: true,
        writable: false
    },
    age: {
      value: 12,
        // ä¸å¯é…ç½®çš„ageå±æ€§
        configurable: false,
        writable: false
    }
});
const proxy = new Proxy(target, {
    get: function (targetObj, prop) {
        return 'abc';
    }
});
console.log(proxy.name); // abc
console.log(proxy.age);  // TypeError: expected '12' but got 'abc')
```
å› ä¸ºnameå±æ€§æ˜¯ä¸å¯å†™ä½†å¯é…ç½®çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ä»£ç†æ”¹å˜å…¶çœŸå®å€¼ï¼Œä»è€Œå¾—åˆ°â€œabcâ€ï¼›
è€Œageå±æ€§æ˜¯ä¸å¯å†™ä¸”ä¸å¯é…ç½®çš„ï¼Œæ‰€ä»¥åœ¨è®¿é—®æ—¶å°±ä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œå¼‚å¸¸ä¿¡æ¯æ ˆçš„å†…å®¹å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
TypeError: 'get' on proxy: property 'age' is a read-only and non-configurable
data property on the proxy target but the proxy did not return its actual 
value (expected '12' but got 'abc')
```
ä»å¼‚å¸¸ä¿¡æ¯æ ˆå¯ä»¥çœ‹å‡ºï¼Œä¸å¯å†™ä¸”ä¸å¯é…ç½®çš„å±æ€§åªèƒ½è¿”å›å…¶å®é™…å€¼ã€‚
#### æ‹¦æˆªå±æ€§èµ‹å€¼æ“ä½œ
> set()å‡½æ•°ä¼šæ‹¦æˆªå±æ€§çš„èµ‹å€¼æ“ä½œã€‚

ä¾‹å¦‚è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šäº‹å…ˆç¡®å®šå¥½äº†æŸä¸ªå±æ€§çš„å–å€¼åŒºé—´ï¼Œä½†æ˜¯åœ¨å¯¹å±æ€§èµ‹å€¼æ—¶å´ä¸åœ¨è¿™ä¸ªåŒºé—´å†…ï¼Œåˆ™å¯ä»¥ç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚
å®šä¹‰ä¸€ä¸ªpersonå¯¹è±¡ï¼ŒåŒ…å«ä¸€ä¸ªageå±æ€§ï¼Œå–å€¼åŒºé—´ä¸º0ï½200ï¼Œåªè¦è®¾ç½®çš„å€¼ä¸åœ¨è¿™ä¸ªåŒºé—´å†…ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
const proxy = new Proxy({}, {
    set: function (target, prop, value) {
        if (prop === 'age') {
            if (!Number.isInteger(value)) {
                throw new TypeError('The age is not an integer');
            }
            if (value > 200 || value < 0) {
                throw new RangeError('The age is invalid');
            }
        } else {
            target[prop] = value;
        }
    }
});
proxy.name = 'ming';  // æ­£å¸¸
proxy.age = 10;  // æ­£å¸¸
proxy.age = 201; // RangeError: The age is invalid
```
##### ç»ƒä¹ 
é‚£ä¹ˆå¦‚ä½•å®ç°ç§æœ‰å±æ€§ä¸èƒ½è¢«ä¿®æ”¹å‘¢?

#### éšè—å†…éƒ¨ç§æœ‰å±æ€§
Proxyæä¾›äº†has()å‡½æ•°ï¼Œç”¨äºæ‹¦æˆªhasProperty()å‡½æ•°ï¼Œå³åˆ¤æ–­å¯¹è±¡æ˜¯å¦å…·æœ‰æŸä¸ªå±æ€§ï¼Œå¦‚æœå…·æœ‰åˆ™è¿”å›â€œtrueâ€ï¼Œå¦‚æœä¸å…·æœ‰åˆ™è¿”å›â€œfalseâ€ï¼Œå…¸å‹çš„å°±æ˜¯inæ“ä½œç¬¦ã€‚
éœ€è¦æ³¨æ„çš„æ˜¯has()å‡½æ•°åˆ¤æ–­çš„æ˜¯hasProperty()å‡½æ•°ï¼Œè€Œä¸æ˜¯hasOwnProperty()å‡½æ•°ï¼Œå³**has()å‡½æ•°ä¸åˆ¤æ–­ä¸€ä¸ªå±æ€§æ˜¯å¯¹è±¡è‡ªèº«çš„å±æ€§ï¼Œè¿˜æ˜¯å¯¹è±¡ç»§æ‰¿çš„å±æ€§ã€‚**
has()å‡½æ•°æœ‰ä¸€ä¸ªæœ€å¤§çš„ç”¨å¤„å°±æ˜¯éšè—æŸäº›ä»¥ä¸‹ç”»çº¿å¼€å¤´ï¼ˆ_ï¼‰çš„ç§æœ‰å±æ€§ï¼Œä¸å¯¹å¤–æš´éœ²å®ƒä»¬ï¼Œä»è€Œé€šè¿‡inå¾ªç¯æ—¶ä¸ä¼šéå†å‡ºç§æœ‰å±æ€§å€¼ã€‚
```js
const obj = {
    _name: 'ming',
    age: 13
};
const proxy = new Proxy(obj, {
    has: function (target, prop) {
        if(prop[0] === '_') {
           return false;
        }
        return prop in target;
    }
});
console.log('age' in proxy);   // true
console.log('_name' in proxy); // false
```
> has()å‡½æ•°åªä¼šå¯¹inæ“ä½œç¬¦ç”Ÿæ•ˆï¼Œè€Œä¸ä¼šå¯¹for...inå¾ªç¯æ“ä½œç¬¦ç”Ÿæ•ˆã€‚
```js
for (let key in proxy) {
  console.log(proxy[key]);
}
// ming
// 13
```
#### ç¦æ­¢åˆ é™¤æŸäº›å±æ€§
Proxyä¸­æä¾›äº†deleteProperty()å‡½æ•°ï¼Œç”¨äºæ‹¦æˆªdeleteæ“ä½œï¼Œè¿”å›â€œtrueâ€æ—¶è¡¨ç¤ºå±æ€§åˆ é™¤æˆåŠŸï¼Œè¿”å›â€œfalseâ€æ—¶è¡¨ç¤ºå±æ€§åˆ é™¤å¤±è´¥ã€‚
åˆ©ç”¨è¿™ä¸ªç‰¹æ€§ï¼Œå¯ä»¥åšç‰¹æ®Šå¤„ç†ï¼Œä¸èƒ½åˆ é™¤ä»¥ä¸‹ç”»çº¿å¼€å¤´çš„ç§æœ‰å±æ€§ã€‚å½“åˆ é™¤äº†ç§æœ‰å±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢æ“ä½œã€‚
```js
let obj = {
    _name: 'ming',
    age: 12
};
const proxy = new Proxy(obj, {
    deleteProperty: function (target, prop) {
        if (prop[0] === '_') {
            throw new Error(`Invalid attempt to delete private "${prop}" property`);
        }
        return true;
    }
});
delete proxy.age;  // åˆ é™¤æˆåŠŸ
delete proxy._name; // Error: Invalid attempt to delete private "_name" property
```
#### å‡½æ•°çš„æ‹¦æˆª
Proxyä¸­æä¾›äº†apply()å‡½æ•°ï¼Œç”¨äºæ‹¦æˆªå‡½æ•°è°ƒç”¨çš„æ“ä½œï¼Œå‡½æ•°è°ƒç”¨åŒ…æ‹¬ç›´æ¥è°ƒç”¨ã€call()å‡½æ•°è°ƒç”¨ã€apply()å‡½æ•°è°ƒç”¨3ç§æ–¹å¼ã€‚
é€šè¿‡å¯¹å‡½æ•°è°ƒç”¨çš„æ‹¦æˆªï¼Œå¯ä»¥åŠ å…¥è‡ªå®šä¹‰æ“ä½œï¼Œä»è€Œå¾—åˆ°æ–°çš„å‡½æ•°å¤„ç†ç»“æœã€‚
```js
function sum(num1, num2) {
    return num1 + num2;
}
const proxy = new Proxy(sum, {
    apply: function (target, obj, args) {
        return target.apply(obj, args) * 2;
    }
});
console.log(proxy(1, 3));  // 8
console.log(proxy.call(null, 3, 4));  // 14
console.log(proxy.apply(null, [5, 6]));  // 22
```
åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªç”¨äºæ±‚å’Œçš„sum()å‡½æ•°ï¼Œç„¶åé€šè¿‡Proxyçš„apply()å‡½æ•°å¯¹sum()å‡½æ•°çš„ç»“æœå†ä¹˜ä»¥2ã€‚
- ç¬¬ä¸€ç§å‡½æ•°æ‰§è¡Œå½¢å¼æ˜¯ç›´æ¥é€šè¿‡proxyè¿›è¡Œè°ƒç”¨ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸º(1+ 3)Ã—2 = 8ã€‚
- ç¬¬äºŒç§å‡½æ•°æ‰§è¡Œå½¢å¼æ˜¯é€šè¿‡call()å‡½æ•°è°ƒç”¨ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸º(3 +4)Ã—2 = 14ã€‚
- ç¬¬ä¸‰ç§å‡½æ•°æ‰§è¡Œå½¢å¼æ˜¯é€šè¿‡apply()å‡½æ•°è°ƒç”¨ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸º(5 +6)Ã—2 = 22ã€‚
### Proxyçš„ä½¿ç”¨åœºæ™¯
#### å®ç°çœŸæ­£çš„ç§æœ‰
JavaScriptä¸­è™½ç„¶æ²¡æœ‰ç§æœ‰å±æ€§çš„è¯­æ³•ï¼Œä½†å­˜åœ¨ä¸€ç§çº¦å®šä¿—æˆçš„ä¸‹ç”»çº¿å†™æ³•ï¼Œå¯ä»¥é€šè¿‡Proxyå¤„ç†ä¸‹ç”»çº¿å†™æ³•æ¥å®ç°çœŸæ­£çš„ç§æœ‰ã€‚
çœŸæ­£çš„ç§æœ‰æ‰€è¦è¾¾åˆ°çš„ç›®æ ‡æœ‰ä»¥ä¸‹å‡ ä¸ªï¼š
- ä¸èƒ½è®¿é—®åˆ°ç§æœ‰å±æ€§ï¼Œå¦‚æœè®¿é—®åˆ°ç§æœ‰å±æ€§åˆ™è¿”å›â€œundefinedâ€ã€‚
- ä¸èƒ½ç›´æ¥ä¿®æ”¹ç§æœ‰å±æ€§çš„å€¼ï¼Œå³ä½¿è®¾ç½®äº†ä¹Ÿæ— æ•ˆã€‚
- ä¸èƒ½éå†å‡ºç§æœ‰å±æ€§ï¼Œéå†å‡ºæ¥çš„å±æ€§ä¸­ä¸ä¼šåŒ…å«ç§æœ‰å±æ€§ã€‚
```js
const apis = {
    _apiKey: '12ab34cd56ef',
    getAllUsers: function () {
        console.log('è¿™æ˜¯æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·çš„å‡½æ•°');
    },
    getUserById: function (userId) {
        console.log('è¿™æ˜¯æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·çš„å‡½æ•°');
    },
    saveUser: function (user) {
        console.log('è¿™æ˜¯ä¿å­˜ç”¨æˆ·çš„å‡½æ•°');
    }
};
const proxy = new Proxy(apis, {
    get: function (target, prop) {
        if (prop[0] === '_') {
            return undefined;
        }
        return target[prop];
    },
    set: function (target, prop, value) {
        if (prop[0] !== '_') {
            target[prop] = value;
        }
    },
    has: function (target, prop) {
        if (prop[0] === '_') {
            return false;
        }
        return prop in target;
    }
});
console.log(proxy._apiKey); // undefined
console.log(proxy.getAllUsers()); // è¿™æ˜¯æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·çš„å‡½æ•°
proxy._apiKey = '123456789'; // è®¾ç½®æ— æ•ˆ
console.log('getUserById' in proxy);  // true
console.log('_apiKey' in proxy); // false
```
#### å¢åŠ æ—¥å¿—è®°å½•
åœ¨æ—¥å¸¸çš„å¼€å‘ä¸­ï¼Œé’ˆå¯¹é‚£äº›è°ƒç”¨é¢‘ç¹ã€è¿è¡Œç¼“æ…¢æˆ–è€…å ç”¨èµ„æºå¯†é›†å‹çš„æ¥å£ï¼ŒæœŸæœ›èƒ½è®°å½•å®ƒä»¬çš„ä½¿ç”¨æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡Proxyä½œä¸ºä¸­é—´ä»¶å¢åŠ æ—¥å¿—è®°å½•ã€‚
ä¸ºäº†è¾¾åˆ°ä¸Šé¢çš„ç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨Proxyè¿›è¡Œæ‹¦æˆªï¼Œé¦–å…ˆé€šè¿‡get()å‡½æ•°æ‹¦æˆªåˆ°è°ƒç”¨çš„å‡½æ•°åï¼Œç„¶åé€šè¿‡apply()å‡½æ•°è¿›è¡Œå‡½æ•°çš„è°ƒç”¨ã€‚
å› æ­¤åœ¨å®ç°ä¸Šï¼Œget()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå‡½æ•°å†…é€šè¿‡apply()å‡½æ•°è°ƒç”¨åŸå§‹å‡½æ•°ï¼Œç„¶åè°ƒç”¨è®°å½•æ“ä½œæ—¥å¿—çš„å‡½æ•°ã€‚
```js
const apis = {
    _apiKey: '12ab34cd56ef',
    getAllUsers: function () {
        console.log('è¿™æ˜¯æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·çš„å‡½æ•°');
    },
    getUserById: function (userId) {
        console.log('è¿™æ˜¯æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ·çš„å‡½æ•°');
    },
    saveUser: function (user) {
        console.log('è¿™æ˜¯ä¿å­˜ç”¨æˆ·çš„å‡½æ•°');
    }
};
// è®°å½•æ—¥å¿—çš„æ–¹æ³•
function recordLog() {
    console.log('è¿™æ˜¯è®°å½•æ—¥å¿—çš„å‡½æ•°');
}
const proxy = new Proxy(apis, {
    get: function (target, prop) {
        const value = target[prop];
        return function (...args) {
            // æ­¤å¤„è°ƒç”¨è®°å½•æ—¥å¿—çš„å‡½æ•°
            recordLog();
            // è°ƒç”¨çœŸå®çš„å‡½æ•°
            return value.apply(null, args);
        }
    }
});
proxy.getAllUsers();
// è¿™æ˜¯è®°å½•æ—¥å¿—çš„å‡½æ•°
// è¿™æ˜¯æŸ¥è¯¢å…¨éƒ¨ç”¨æˆ·çš„å‡½æ•°
```
è¿™æ ·å°±å¯ä»¥åœ¨ä¸å½±å“åŸåº”ç”¨æ­£å¸¸è¿è¡Œçš„æƒ…å†µä¸‹å¢åŠ æ—¥å¿—è®°å½•ã€‚å¦‚æœåªæƒ³è¦å¯¹ç‰¹å®šçš„æŸäº›å‡½æ•°å¢åŠ æ—¥å¿—ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨get()å‡½æ•°ä¸­è¿›è¡Œç‰¹æ®Šçš„å¤„ç†ï¼Œå¯¹å‡½æ•°åè¿›è¡Œåˆ¤æ–­ã€‚
#### æä¾›å‹å¥½æç¤ºæˆ–è€…é˜»æ­¢ç‰¹å®šæ“ä½œ
é€šè¿‡Proxyï¼Œå¯ä»¥å¢åŠ æŸäº›æ“ä½œçš„å‹å¥½æç¤ºæˆ–è€…é˜»æ­¢ç‰¹å®šçš„æ“ä½œï¼Œä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç±»ã€‚
- æŸäº›è¢«å¼ƒç”¨çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œç»™ç”¨æˆ·æä¾›å‹å¥½æç¤ºã€‚
- é˜»æ­¢åˆ é™¤å±æ€§çš„æ“ä½œã€‚
- é˜»æ­¢ä¿®æ”¹æŸäº›ç‰¹å®šçš„å±æ€§çš„æ“ä½œã€‚
```js
// å®šä¹‰äº†ä¸€ä¸ªæ•°æ®æºå¯¹è±¡dataStoreï¼Œå…¶ä¸­åŒ…å«äº†ä¸èƒ½åˆ é™¤çš„å±æ€§noDeleteã€å·²åºŸå¼ƒçš„å‡½æ•°oldMethod()ã€ä¸èƒ½æ”¹å˜çš„å±æ€§doNotChangeã€‚
let dataStore = {
    noDelete: 1234,
    oldMethod: function () {/*...*/},
    doNotChange: "tried and true"
};
let NO_DELETE = ['noDelete'];
let DEPRECATED = ['oldMethod'];
let NO_CHANGE = ['doNotChange'];
const proxy = new Proxy(dataStore, {
    set(target, key, value, proxy) {
        if (NO_CHANGE.includes(key)) {
            throw Error(`Error! ${key} is immutable.`);
        }
        return true;
    },
    deleteProperty(target, key) {
        if (NO_DELETE.includes(key)) {
            throw Error(`Error! ${key} cannot be deleted.`);
        }
        return true;
    },
    get(target, key, proxy) {
        if (DEPRECATED.includes(key)) {
            console.warn(`Warning! ${key} is deprecated.`);
        }
        const val = target[key];
        return typeof val === 'function' ?
            function (...args) {
                val.apply(null, args);
            } : val;
    }
});
proxy.doNotChange = "foo"; // Error! doNotChange is immutable.
delete proxy.noDelete; // Error! noDelete cannot be deleted.
proxy.oldMethod(); // Warning! oldMethod is deprecated.
```
## Reflect
### æ¦‚è¿°
Reflectå¯¹è±¡ä¸Proxyå¯¹è±¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ES6ä¸ºäº†æ“ä½œå¯¹è±¡è€Œæä¾›çš„æ–°APIã€‚
ç†è§£ï¼šæœ‰ä¸€ä¸ªåä¸ºReflectçš„å…¨å±€å¯¹è±¡ï¼Œä¸Šé¢æŒ‚è½½äº†å¯¹è±¡çš„æŸäº›ç‰¹æ®Šå‡½æ•°ï¼Œè¿™äº›å‡½æ•°å¯ä»¥é€šè¿‡ç±»ä¼¼äºReflect.apply()è¿™ç§å½¢å¼æ¥è°ƒç”¨ï¼Œæ‰€æœ‰åœ¨Reflectå¯¹è±¡ä¸Šçš„å‡½æ•°è¦ä¹ˆå¯ä»¥åœ¨ObjectåŸå‹é“¾ä¸­æ‰¾åˆ°ï¼Œè¦ä¹ˆå¯ä»¥é€šè¿‡å‘½ä»¤å¼æ“ä½œç¬¦å®ç°ï¼Œä¾‹å¦‚deleteå’Œinæ“ä½œç¬¦ã€‚

æ—¢ç„¶åœ¨ES6ä¹‹å‰ï¼ŒObjectå¯¹è±¡ä¸­å·²ç»æœ‰ä¸Reflectçš„å‡½æ•°ç›¸åŒåŠŸèƒ½çš„å‡½æ•°æˆ–è€…å‘½ä»¤å¼æ“ä½œç¬¦ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦åœ¨ES6ä¸­ä¸“é—¨å¢åŠ ä¸€ä¸ªReflectå¯¹è±¡å‘¢ï¼Ÿ

ä¸»è¦åŸå› æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š
- æ›´åˆç†åœ°è§„åˆ’ä¸Objectå¯¹è±¡ç›¸å…³çš„APIã€‚
  - åœ¨ES6ä¸­ï¼ŒObjectå¯¹è±¡çš„ä¸€äº›æ˜æ˜¾å±äºè¯­è¨€å†…éƒ¨çš„å‡½æ•°éƒ½ä¼šæ·»åŠ åˆ°Reflectå¯¹è±¡ä¸­ï¼Œè¿™æ ·Objectå¯¹è±¡ä¸Reflectå¯¹è±¡ä¸­ä¼šå­˜åœ¨ç›¸åŒçš„å¤„ç†å‡½æ•°ã€‚è€Œåœ¨æœªæ¥çš„è®¾è®¡ä¸­ï¼Œè¯­è¨€å†…éƒ¨çš„å‡½æ•°å°†åªä¼šæ·»åŠ åˆ°Reflectå¯¹è±¡ä¸­ã€‚
- ç”¨ä¸€ä¸ªå•ä¸€çš„å…¨å±€å¯¹è±¡å»å­˜å‚¨è¿™äº›å‡½æ•°ï¼Œèƒ½å¤Ÿä¿æŒå…¶ä»–çš„JavaScriptä»£ç çš„æ•´æ´ã€å¹²å‡€ã€‚ä¸ç„¶çš„è¯ï¼Œè¿™äº›å‡½æ•°å¯èƒ½æ˜¯å…¨å±€çš„ï¼Œæˆ–è€…è¦é€šè¿‡åŸå‹æ¥è°ƒç”¨ï¼Œä¸æ–¹ä¾¿ç»Ÿä¸€ç®¡ç†ã€‚
- å°†ä¸€äº›å‘½ä»¤å¼çš„æ“ä½œç¬¦å¦‚deleteã€inç­‰ä½¿ç”¨å‡½æ•°æ¥æ›¿ä»£ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†è®©ä»£ç æ›´å¥½ç»´æŠ¤ï¼Œæ›´å®¹æ˜“å‘ä¸‹å…¼å®¹ï¼ŒåŒæ—¶ä¹Ÿé¿å…å‡ºç°æ›´å¤šçš„ä¿ç•™å­—ã€‚
```js
// ä¼ ç»Ÿå†™æ³•
'assign' in Object // true

// æ–°å†™æ³•
Reflect.has(Object, 'assign') // true
```
ä¿®æ”¹Objectå¯¹è±¡çš„æŸäº›å‡½æ•°çš„è¿”å›ç»“æœï¼Œå¯ä»¥è®©å…¶å˜å¾—æ›´åˆç†ï¼Œä½¿å¾—ä»£ç æ›´å¥½ç»´æŠ¤ã€‚

å¦‚æœä¸€ä¸ªå¯¹è±¡objæ˜¯ä¸èƒ½æ‰©å±•çš„ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨`Object.defineProperty(obj, name, desc)`æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚å› æ­¤åœ¨ä¼ ç»Ÿçš„å†™æ³•ä¸­ï¼Œéœ€è¦é€šè¿‡try...catchå¤„ç†ã€‚

è€Œä½¿ç”¨Reflect.defineProperty(obj, name, desc)æ—¶ï¼Œè¿”å›çš„æ˜¯â€œfalseâ€ï¼Œæ–°çš„å†™æ³•å°±å¯ä»¥é€šè¿‡if...elseå®ç°ã€‚
```js
// ä¼ ç»Ÿå†™æ³•
try {
    Object.defineProperty(target, property, attributes);
    // success
} catch (e) {
    // failure
}

// æ–°å†™æ³•
if (Reflect.defineProperty(target, property, attributes)) {
    // success
} else {
    // failure
}
```
Reflectå¯¹è±¡çš„å‡½æ•°ä¸Proxyå¯¹è±¡çš„å‡½æ•°ä¸€ä¸€å¯¹åº”ï¼Œ**åªè¦æ˜¯Proxyå¯¹è±¡çš„å‡½æ•°ï¼Œå°±èƒ½åœ¨Reflectå¯¹è±¡ä¸Šæ‰¾åˆ°å¯¹åº”çš„å‡½æ•°**ã€‚è¿™å°±è®©Proxyå¯¹è±¡å¯ä»¥æ–¹ä¾¿åœ°è°ƒç”¨å¯¹åº”çš„Reflectå¯¹è±¡ä¸Šçš„å‡½æ•°ï¼Œå®Œæˆé»˜è®¤è¡Œä¸ºï¼Œå¹¶ä»¥æ­¤ä½œä¸ºä¿®æ”¹è¡Œä¸ºçš„åŸºç¡€ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ç®¡Proxyå¯¹è±¡æ€ä¹ˆä¿®æ”¹é»˜è®¤è¡Œä¸ºï¼Œæ€»å¯ä»¥åœ¨Reflectå¯¹è±¡ä¸Šè·å–é»˜è®¤è¡Œä¸ºã€‚è€Œäº‹å®ä¸ŠProxyå¯¹è±¡ä¹Ÿä¼šç»å¸¸éšç€Reflectå¯¹è±¡ä¸€èµ·è¿›è¡Œè°ƒç”¨ã€‚
```js
new Proxy(target, {
  set: function(target, name, value, receiver) {
    var success = Reflect.set(target,name, value, receiver);
    if (success) {
      console.log('property ' + name + ' on ' + target + ' set to ' + value);
    }
    return success;
  }
});
```
### é™æ€å‡½æ•°
ä¸Proxyå¯¹è±¡ä¸åŒçš„æ˜¯ï¼ŒReflectå¯¹è±¡æœ¬èº«å¹¶ä¸æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œè€Œæ˜¯ç›´æ¥æä¾›é™æ€å‡½æ•°ä»¥ä¾›è°ƒç”¨ï¼ŒReflectå¯¹è±¡çš„é™æ€å‡½æ•°ä¸€å…±æœ‰13ä¸ªï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

- Reflect.apply(target, thisArg, args)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯é€šè¿‡æŒ‡å®šçš„å‚æ•°åˆ—è¡¨æ‰§è¡Œtargetå‡½æ•°ï¼Œç­‰åŒäºæ‰§è¡Œ`Function.prototype.apply.call(target,thisArg, args)`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å‡½æ•°ï¼ŒthisArgè¡¨ç¤ºçš„æ˜¯æ‰§è¡Œtargetå‡½æ•°æ—¶çš„thiså¯¹è±¡ï¼Œargsè¡¨ç¤ºçš„æ˜¯å‚æ•°åˆ—è¡¨ã€‚

- Reflect.construct(target, args [, newTarget])ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯æ‰§è¡Œæ„é€ å‡½æ•°ï¼Œç­‰åŒäºæ‰§è¡Œ`new target(...args)`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯æ„é€ å‡½æ•°ï¼Œargsè¡¨ç¤ºçš„æ˜¯å‚æ•°åˆ—è¡¨ã€‚newTargetæ˜¯é€‰å¡«çš„å‚æ•°ï¼Œå¦‚æœå¢åŠ äº†è¯¥å‚æ•°ï¼Œåˆ™è¡¨ç¤ºå°†newTargetä½œä¸ºæ–°çš„æ„é€ å‡½æ•°ï¼›å¦‚æœæ²¡æœ‰å¢åŠ è¯¥å‚æ•°ï¼Œåˆ™ä»ç„¶ä½¿ç”¨ç¬¬ä¸€ä¸ªå‚æ•°targetä½œä¸ºæ„é€ å‡½æ•°ã€‚

- Reflect.defineProperty(target, propKey, attributes)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯ä¸ºå¯¹è±¡å®šä¹‰å±æ€§ï¼Œç­‰åŒäºæ‰§è¡Œ`Object.defineProperty()`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯å®šä¹‰å±æ€§çš„ç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯æ–°å¢çš„å±æ€§åï¼Œattributesè¡¨ç¤ºçš„æ˜¯å±æ€§æè¿°ç¬¦å¯¹è±¡é›†ã€‚

- Reflect.deleteProperty(target, propKey)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯åˆ é™¤å¯¹è±¡çš„å±æ€§ï¼Œç­‰åŒäºæ‰§è¡Œ`delete obj[propKey]`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯å¾…åˆ é™¤å±æ€§çš„å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯å¾…åˆ é™¤çš„å±æ€§ã€‚

- Reflect.get(target, propKey, receiver)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯è·å–å¯¹è±¡çš„å±æ€§å€¼ï¼Œç­‰åŒäºæ‰§è¡Œ`target[propKey]`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯è·å–å±æ€§çš„å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯è·å–çš„å±æ€§ï¼Œreceiverè¡¨ç¤ºå‡½æ•°ä¸­thisç»‘å®šçš„å¯¹è±¡ã€‚

- Reflect.getOwnPropertyDescriptor(target, propKey)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯å¾—åˆ°æŒ‡å®šå±æ€§çš„æè¿°å¯¹è±¡ï¼Œç­‰åŒäºæ‰§è¡Œ`Object.getOwnPropertyDescriptor()`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯å¾…æ“ä½œçš„å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯æŒ‡å®šçš„å±æ€§ã€‚

- Reflect.getPrototypeOf(target)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯è¯»å–å¯¹è±¡çš„__proto__å±æ€§ï¼Œç­‰åŒäºæ‰§è¡Œ`Object.getPrototypeOf(obj)`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ã€‚

- Reflect.has(target, propKey)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯åˆ¤æ–­å±æ€§æ˜¯å¦åœ¨å¯¹è±¡ä¸­ï¼Œç­‰åŒäºæ‰§è¡Œ`propKey in target`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯åˆ¤æ–­çš„å±æ€§ã€‚

- Reflect.isExtensible(target)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯åˆ¤æ–­å¯¹è±¡æ˜¯å¦å¯æ‰©å±•ï¼Œç­‰åŒäºæ‰§è¡Œ`Object.isExtensible()`å‡½æ•°ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ã€‚

- Reflect.ownKeys(target)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯è·å–å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬Symbolå±æ€§ï¼Œç­‰åŒäº`Object.getOwnPropertyNames`ä¸`Object.getOwnPropertySymbols`ä¹‹å’Œã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ã€‚

- Reflect.preventExtensions(target)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯è®©ä¸€ä¸ªå¯¹è±¡å˜å¾—ä¸å¯æ‰©å±•ï¼Œç­‰åŒäºæ‰§è¡Œ`Object.preventExtensions()`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ã€‚

- Reflect.set(target, propKey, value, receiver)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯è®¾ç½®æŸä¸ªå±æ€§å€¼ï¼Œç­‰åŒäºæ‰§è¡Œ`target[propKey] = value`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ï¼ŒpropKeyè¡¨ç¤ºçš„æ˜¯å¾…è®¾ç½®çš„å±æ€§ï¼Œvalueè¡¨ç¤ºçš„æ˜¯è®¾ç½®å±æ€§çš„å…·ä½“å€¼ï¼Œreceiverè¡¨ç¤ºå‡½æ•°ä¸­thisç»‘å®šçš„å¯¹è±¡ã€‚

- Reflect.setPrototypeOf(target, newProto)ã€‚
  - å‡½æ•°çš„ä½œç”¨æ˜¯è®¾ç½®å¯¹è±¡çš„åŸå‹prototypeï¼Œç­‰åŒäºæ‰§è¡Œ`Object.setPrototypeOf(target,newProto)`ã€‚
  - å…¶ä¸­targetè¡¨ç¤ºçš„æ˜¯ç›®æ ‡å¯¹è±¡ï¼ŒnewProtoè¡¨ç¤ºçš„æ˜¯æ–°çš„åŸå‹å¯¹è±¡ã€‚

#### Reflect.apply(target, thisArg, args)
ä¸¤ä¸ªåº”ç”¨åœºæ™¯ï¼š
1. ä¸€ä¸ªæ˜¯æ‰¾å‡ºæ•°ç»„é‡Œçš„æœ€å¤§å…ƒç´ ã€‚
2. ä¸€ä¸ªæ˜¯æˆªå–å­—ç¬¦ä¸²ä¸­çš„ä¸€éƒ¨åˆ†å€¼ã€‚
è¿™ä¸¤ä¸ªåœºæ™¯åˆ†åˆ«ä½¿ç”¨ä¼ ç»Ÿçš„apply()å‡½æ•°å’ŒReflect.apply()å‡½æ•°æ¥å®ç°ã€‚
```js
// æŸ¥æ‰¾ä¸€ä¸ªæ•°å­—æ•°ç»„é‡Œé¢çš„æœ€å¤§å…ƒç´ 
const arr = [1, 3, 5, 7];
let max;
// ES6
max = Reflect.apply(Math.max, null, arr);
console.log(max); // 7

// ES5
max = Math.max.apply(null, arr);
console.log(max); // 7
max = Function.prototype.apply.call(Math.max, null, arr);
console.log(max); // 7
```

```js
// æˆªå–å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†
let str = 'hello, world';
let newStr;
// ES6
newStr = Reflect.apply(String.prototype.slice, str, [2, 8]);
console.log(newStr); // lloï¼Œw
// ES5
newStr = str.slice(2, 8);
console.log(newStr); // lloï¼Œw
newStr = String.prototype.slice.apply(str, [2, 8]);
console.log(newStr); // lloï¼Œw
```
#### Reflect.defineProperty(target, propKey, attributes)
ä¸Object.defineProperty()å‡½æ•°çš„ä¸»è¦åŒºåˆ«åœ¨äºè¿”å›å€¼ï¼Œå¦‚æœ**è®¾ç½®å¤±è´¥**ï¼ŒObject.defineProperty()å‡½æ•°ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè€Œ**Reflect.defineProperty()å‡½æ•°ä¼šè¿”å›â€œfalseâ€**ã€‚
```js
1  let obj = {};
2   // ES5å†™æ³•ï¼Œå¯¹è±¡çš„å±æ€§å®šä¹‰å¤±è´¥æ—¶ï¼Œé‡‡ç”¨try...catch()å‡½æ•°å¤„ç†
3  try {
4      Object.defineProperty(null, 'a', {
5          value: 22
6      });
7  } catch (e) {
8      console.log('define property failed!');
9  }
10
11 // ä½¿ç”¨Object.definePropertyæˆåŠŸåœ°å®šä¹‰
12 let obj1 = Object.defineProperty(obj, 'name', {
13     enumerable: true,
14     value: 'ming'
15 });
16 console.log(obj); // { name: 'ming' }
17 console.log(obj1); // { name: 'ming' }
18 
19 let result1 = Reflect.defineProperty(obj, 'name', {
20     configurable: true,
21     enumerable: true,
22     value: 'happy'
23 });
24 console.log(result1); // false
25
26 let result2 = Reflect.defineProperty(obj, 'age', {
27     configurable: true,
28     enumerable: true,
29     value: 22
30 });
31 console.log(result2); // true
32 console.log(obj); // { name: 'ming', age: 22 }
```
åœ¨ä¸Šé¢å®ä¾‹ä¸­çš„ç¬¬1ï½9è¡Œä»£ç ï¼Œåœ¨é‡‡ç”¨ä¼ ç»ŸES5å†™æ³•æ—¶ï¼Œé€šè¿‡Object.defineProperty()å‡½æ•°ä¸ºnullæ·»åŠ ä¸€ä¸ªå±æ€§ï¼Œæ˜¯ä¸€ä¸ªå¤±è´¥çš„æ“ä½œï¼Œä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œæ‰€ä»¥éœ€è¦é‡‡ç”¨try...catch()å‡½æ•°çš„å†™æ³•ã€‚

åœ¨ç¬¬11ï½17è¡Œä»£ç ä¸­ï¼Œé€šè¿‡Object.defineProperty()å‡½æ•°ä¸ºobjå¯¹è±¡æ·»åŠ ä¸€ä¸ªnameå±æ€§ï¼Œå¾—åˆ°æ–°çš„å¯¹è±¡obj1ï¼Œæ­¤æ—¶objä¸obj1æŒ‡å‘åŒä¸€ä¸ªå¼•ç”¨ï¼Œè¾“å‡ºçš„ç»“æœéƒ½ä¸ºâ€œ{ name: 'ming' }â€ã€‚è¿™é‡Œéœ€è¦æ³¨æ„ï¼Œobjå¯¹è±¡çš„nameå±æ€§åªè®¾ç½®äº†**enumerable**å€¼ä¸ºtrueï¼Œé‚£ä¹ˆ**writable**å’Œ**configurable**å€¼å°±ä¸ºfalseï¼Œè¿™è¡¨æ˜nameå±æ€§å€¼æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„ã€‚

åœ¨ç¬¬19ï½24è¡Œä»£ç ä¸­ï¼Œç”±äºnameå±æ€§å€¼æ˜¯ä¸èƒ½è¢«ä¿®æ”¹çš„ï¼Œé€šè¿‡`Reflect.defineProperty()`å‡½æ•°è®¾ç½®objå¯¹è±¡çš„nameå±æ€§å€¼æ—¶ä¼šå¤±è´¥ï¼Œå› æ­¤åœ¨è¾“å‡ºresult1æ—¶ï¼Œç»“æœä¸ºâ€œfalseâ€ã€‚

åœ¨ç¬¬26ï½32è¡Œä»£ç ä¸­ï¼Œageå±æ€§æ˜¯ç¬¬ä¸€æ¬¡è¢«æ·»åŠ åˆ°objå¯¹è±¡ä¸­å»çš„ï¼Œå› æ­¤`Reflect.defineProperty()`å‡½æ•°è°ƒç”¨æˆåŠŸï¼Œresult2å€¼ä¸ºâ€œtrueâ€ï¼Œæ­¤æ—¶objå°±æ‰©å±•æˆäº†æ‹¥æœ‰nameå’Œageä¸¤ä¸ªå±æ€§å€¼çš„å¯¹è±¡ã€‚

#### Reflect.deleteProperty(target, propKey)
deleteæ“ä½œç¬¦å’ŒReflect.deleteProperty()å‡½æ•°çš„ä½¿ç”¨å·®å¼‚æ€§ã€‚
```js
// æ–°çš„Reflectå†™æ³•
let obj = {
    name: 'ming',
    age: 22
};
let r1 = Reflect.deleteProperty(obj, 'name');
console.log(r1); // true
let r2 = Reflect.deleteProperty(obj, 'name');
console.log(r2); // true
let r3 = Reflect.deleteProperty(Object.freeze(obj), 'age');
console.log(r3); // false

// ä¼ ç»Ÿçš„deleteå†™æ³•
let obj2 = {
    name: 'ming',
    age: 22
};
delete obj2.name;
delete obj2.name;
// å†»ç»“obj2å¯¹è±¡
Object.freeze(obj2);
delete obj2.age;
console.log(obj2); // { age: 22 }
```
åœ¨ä½¿ç”¨æ–°çš„Reflect.deleteProperty()å‡½æ•°åˆ é™¤å¯¹è±¡çš„å±æ€§æ—¶ï¼Œåªè¦å¯¹è±¡æ˜¯å¯æ‰©å±•çš„ï¼Œåˆ é™¤ä»»ä½•å±æ€§éƒ½ä¼šè¿”å›ä¸ºâ€œtrueâ€ï¼Œå³ä½¿è¯¥å±æ€§ä¸å­˜åœ¨ã€‚

åœ¨ä¸Šé¢çš„å®ä¾‹ä¸­ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨Reflect.deleteProperty()å‡½æ•°åˆ é™¤nameå±æ€§æ—¶ï¼Œåˆ é™¤æˆåŠŸï¼Œr1ä¸ºâ€œtrueâ€ï¼Œæ­¤æ—¶objå¯¹è±¡ä¸­åªåŒ…å«ageå±æ€§ã€‚

ç¬¬äºŒæ¬¡è°ƒç”¨Reflect.deleteProperty()å‡½æ•°åˆ é™¤nameå±æ€§æ—¶ï¼Œè™½ç„¶nameå±æ€§å·²ç»ä¸å­˜åœ¨ï¼Œä»ç„¶å¯ä»¥åˆ é™¤æˆåŠŸï¼Œr2ä¸ºâ€œtrueâ€ã€‚

ç¬¬ä¸‰æ¬¡è°ƒç”¨Reflect.deleteProperty()å‡½æ•°åˆ é™¤ageå±æ€§æ—¶ï¼Œç”±äºobjå¯¹è±¡é€šè¿‡freeze()å‡½æ•°è¿›è¡Œå†»ç»“ï¼Œobjå°†ä¸å¯æ‰©å±•ï¼Œå› æ­¤åˆ é™¤ageå±æ€§å¤±è´¥ï¼Œr3ä¸ºâ€œfalseâ€ã€‚

ä½¿ç”¨ä¼ ç»Ÿçš„deleteæ“ä½œç¬¦è¾¾åˆ°çš„æ˜¯ç›¸åŒçš„ç›®çš„ï¼Œå³ä½¿åˆ é™¤çš„æ˜¯ä¸å­˜åœ¨çš„å±æ€§ï¼Œç¨‹åºä¹Ÿä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œæ‰€ä»¥ä¸¤æ¬¡è°ƒç”¨delete obj2.nameåç¨‹åºä¾ç„¶æ­£å¸¸ï¼›è€Œå½“å¯¹è±¡obj2é€šè¿‡freeze()å‡½æ•°å†»ç»“åï¼Œdeleteæ“ä½œå°†ä¸å†ç”Ÿæ•ˆï¼Œå› æ­¤æœ€åobj2ä¸ºâ€œ{ age: 22 }â€ã€‚

#### Reflect.set(target, propKey, value, receiver)
Reflect.set()å‡½æ•°åœ¨ä¼ é€’ä¸ä¸ä¼ é€’ç¬¬å››ä¸ªå‚æ•°receiverä¸Šçš„å·®å¼‚ã€‚
```js
let obj = {
    _name: '',
    set name(name) {
        console.log('this:', this);
        this._name = name;
    },
    get name() {
        return this._name;
    },
    age: 22
};

let r1 = Reflect.set(obj, 'age', 24);
let r2 = Reflect.set(obj, 'name', 'ming'); // this: { _name: '', name: [Getter/Setter], age: 24 }
console.log(r1); // true
console.log(obj); // { _name: 'ming', name: [Getter/Setter], age: 24 }

let receiver = { test: 'test' };
let r3 = Reflect.set(obj, 'name', 'ming2', receiver); // this: { test: 'test' }
console.log(r3); // true
console.log(obj); // { _name: 'ming', name: [Getter/Setter], age: 24 }
console.log(receiver); // { test: 'test', _name: 'ming2' }
```
é¦–å…ˆå®šä¹‰ä¸€ä¸ªobjå¯¹è±¡ï¼Œå…·æœ‰_nameã€nameå’Œageè¿™3ä¸ªå±æ€§ï¼Œå¹¶åœ¨è®¾ç½®nameå±æ€§å€¼æ—¶ï¼Œè¾“å‡ºthisçš„å€¼ã€‚

ç„¶åç¬¬ä¸€æ¬¡è°ƒç”¨Reflect.set()å‡½æ•°ï¼Œä¿®æ”¹ageå±æ€§çš„å€¼ä¸º24ï¼Œæ“ä½œæˆåŠŸã€‚

ç¬¬äºŒæ¬¡è°ƒç”¨Reflect.set()å‡½æ•°ï¼Œä¿®æ”¹nameå±æ€§çš„å€¼ä¸º'ming'ï¼Œæ­¤æ—¶å¹¶æœªä¼ é€’ç¬¬å››ä¸ªå‚æ•°ï¼Œæ‰€ä»¥thisæŒ‡å‘ç¬¬ä¸€ä¸ªå‚æ•°objï¼Œæ‰§è¡ŒæˆåŠŸåobjçš„å€¼ä¸ºâ€œ{ _name: 'ming', name: [Getter/Setter],age: 24 }â€ã€‚

ç¬¬ä¸‰æ¬¡è°ƒç”¨Reflect.set()å‡½æ•°ï¼Œä¿®æ”¹nameå±æ€§å€¼ä¸º'ming2'ï¼Œæ­¤æ—¶ä¼ é€’äº†ç¬¬å››ä¸ªå‚æ•°ä¸ºä¸€ä¸ªå¯¹è±¡receiverï¼Œåˆ™**thiså°±æŒ‡å‘è¿™ä¸ªæ–°å¯¹è±¡receiver**ï¼Œè€Œä¸å†æ˜¯objå¯¹è±¡ã€‚**å› æ­¤åœ¨è®¾ç½®nameæ—¶ï¼Œæ‰§è¡Œäº†this._name = nameï¼Œå®é™…æ˜¯ä¸ºreceiverå¯¹è±¡æ–°å¢äº†ä¸€ä¸ª_nameå±æ€§ï¼Œå€¼ä¸º'ming2'**ï¼›åœ¨æ‰§è¡Œå®Œåï¼Œobjå¯¹è±¡çš„å€¼ä¾ç„¶ä¸å˜ï¼Œè€Œreceiverå¯¹è±¡çš„å€¼å˜ä¸ºâ€œ{ test: 'test', _name: 'ming2'}â€ã€‚

#### Reflectä¸ProxyğŸ‘ğŸ‘ğŸ‘
ES6åœ¨è®¾è®¡çš„æ—¶å€™å°±å°†Reflectå¯¹è±¡å’ŒProxyå¯¹è±¡ç»‘å®šåœ¨ä¸€èµ·äº†ï¼ŒReflectå¯¹è±¡çš„å‡½æ•°ä¸Proxyå¯¹è±¡çš„å‡½æ•°ä¸€ä¸€å¯¹åº”ï¼Œå› æ­¤åœ¨Proxyå¯¹è±¡ä¸­è°ƒç”¨Reflectå¯¹è±¡å¯¹åº”çš„å‡½æ•°æ˜¯ä¸€ä¸ªæ˜æ™ºçš„é€‰æ‹©ã€‚

ä¾‹å¦‚ä½¿ç”¨Proxyå¯¹è±¡æ‹¦æˆªå±æ€§çš„è¯»å–ã€è®¾ç½®å’Œåˆ é™¤æ“ä½œã€å¹¶é…åˆReflectå¯¹è±¡å®ç°æ—¶ï¼Œå¯ä»¥ç¼–å†™å¦‚ä¸‹æ‰€ç¤ºçš„ä»£ç ã€‚
```js
let target = {
    name: 'ming'
};
const proxy = new Proxy(target, {
    get(target, prop) {
        console.log(`è¯»å–å±æ€§${prop}çš„å€¼ä¸º${target[prop]}`);
        return Reflect.get(target, prop);
    },
    set(target, prop, value) {
        console.log(`è®¾ç½®å±æ€§${prop}çš„å€¼ä¸º${value}`);
        return Reflect.set(target, prop, value);
    },
    deleteProperty(target, prop) {
        console.log('åˆ é™¤å±æ€§: ' + prop);
        return Reflect.deleteProperty(target, prop);
    }
});

proxy.name; // è¯»å–å±æ€§nameçš„å€¼ä¸º'ming'
proxy.name = 'ming2'; // è®¾ç½®å±æ€§nameçš„å€¼ä¸º'ming2'
delete proxy.name; // åˆ é™¤å±æ€§: name
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåœ¨Proxyå¯¹è±¡çš„get()å‡½æ•°ã€set()å‡½æ•°ã€deleteProperty()å‡½æ•°ä¸­åˆ†åˆ«è°ƒç”¨Reflect.get()å‡½æ•°ã€Reflect.set()å‡½æ•°ã€Reflect.deleteProperty()å‡½æ•°ã€‚

æœ€åçš„æµ‹è¯•ä»£ç éªŒè¯äº†ä½¿ç”¨Reflectå¯¹è±¡çš„å‡†ç¡®æ€§ã€‚

é‚£ä¹ˆä¸¤è€…çš„é…åˆä½¿ç”¨èƒ½å®ç°ä»€ä¹ˆæ ·çš„åŠŸèƒ½å‘¢ï¼Ÿ
**å®ç°è§‚å¯Ÿè€…æ¨¡å¼**

è§‚å¯Ÿè€…æ¨¡å¼çš„è¡¨ç°æ˜¯ï¼šä¸€ä¸ªç›®æ ‡å¯¹è±¡ç®¡ç†æ‰€æœ‰ä¾èµ–äºå®ƒçš„è§‚å¯Ÿè€…å¯¹è±¡ï¼Œå½“è‡ªèº«çš„çŠ¶æ€æœ‰å˜æ›´æ—¶ï¼Œä¼šä¸»åŠ¨å‘æ‰€æœ‰è§‚å¯Ÿè€…å‘å‡ºé€šçŸ¥ã€‚

æŒ‰ç…§è§‚å¯Ÿè€…æ¨¡å¼çš„è¡¨ç°ï¼Œå¯ä»¥è®¾æƒ³è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šæœ‰ä¸€ä¸ªç›®æ ‡å¯¹è±¡å’Œä¸¤ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ï¼Œåœ¨ä¿®æ”¹ç›®æ ‡å¯¹è±¡çš„å±æ€§æ—¶é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…ï¼Œå…¶ä¸­ä¸€ä¸ªè§‚å¯Ÿè€…è·å¾—ä¿®æ”¹åçš„å€¼â€œå¼€å¿ƒåœ°ç¬‘äº†â€ï¼Œå¦ä¸€ä¸ªè§‚å¯Ÿè€…è·å¾—ä¿®æ”¹åçš„å€¼â€œä¼¤å¿ƒåœ°å“­äº†â€ã€‚

å¦‚æœé‡‡ç”¨Proxyå¯¹è±¡å’ŒReflectå¯¹è±¡çš„å®ç°æ–¹å¼ï¼Œå…¶ä¸­å¿…é¡»åŒ…å«ä»¥ä¸‹å…ƒç´ ã€‚
- Proxyä»£ç†çš„å¯¹è±¡ä¸ºè§‚å¯Ÿè€…æ¨¡å¼ä¸­çš„ç›®æ ‡å¯¹è±¡ã€‚
- æ‹¥æœ‰ä¸€ä¸ªSeté›†åˆï¼ŒåŒ…å«æ‰€æœ‰çš„è§‚å¯Ÿè€…å¯¹è±¡ã€‚
- è§‚å¯Ÿè€…å¯¹è±¡ç”±ç”¨æˆ·è‡ªå®šä¹‰ï¼Œæœ¬å®ä¾‹ä¸­æœ‰ä¸¤ä¸ªè§‚å¯Ÿè€…ï¼Œå®é™…ä¸ºä¸¤ä¸ªå‡½æ•°ã€‚
- é€šè¿‡Proxyçš„set()å‡½æ•°å®ç°å±æ€§æ‹¦æˆªï¼Œåœ¨set()å‡½æ•°ä¸­è°ƒç”¨Reflect.set()å‡½æ•°è®¾ç½®å±æ€§å€¼ï¼Œç„¶åæ‰§è¡Œé€šçŸ¥çš„å‡½æ•°ï¼Œå³è°ƒç”¨è§‚å¯Ÿè€…å¯¹è±¡ä»£è¡¨çš„å‡½æ•°ã€‚
- å®šä¹‰ä¸ºç›®æ ‡å¯¹è±¡æ·»åŠ è§‚å¯Ÿè€…çš„å‡½æ•°ã€‚
- é€šè¿‡Proxyæ„é€ å‡½æ•°ç”Ÿæˆä»£ç†çš„å®ä¾‹ã€‚
```js
// ç›®æ ‡å¯¹è±¡
const target = {
  name: 'ming'
}
// è§‚å¯Ÿç€é˜Ÿåˆ—ï¼ŒåŒ…å«æ‰€æœ‰çš„è§‚å¯Ÿè€…å¯¹è±¡
const queueObservers = new Set();
// ç¬¬ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡
function observer1(prop, value) {
  console.log(`ç›®æ ‡å¯¹è±¡çš„${prop}å±æ€§å€¼å˜ä¸º${value}ï¼Œè§‚å¯Ÿè€…1å¼€å¿ƒåœ°ç¬‘äº†`);
}
// ç¬¬äºŒä¸ªè§‚å¯Ÿè€…å¯¹è±¡
function observer2(prop, value) {
  console.log(`ç›®æ ‡å¯¹è±¡çš„${prop}å±æ€§å€¼å˜ä¸º${value}ï¼Œè§‚å¯Ÿè€…2ä¼¤å¿ƒåœ°å“­äº†`);
}
// Proxyçš„set()å‡½æ•°ï¼Œç”¨äºæ‹¦æˆªç›®æ ‡å¯¹è±¡å±æ€§ä¿®æ”¹çš„æ“ä½œ
function set(target, prop, value) {
  // ä½¿ç”¨Reflect.set()å‡½æ•°ä¿®æ”¹å±æ€§
  const result = Reflect.set(target, prop, value);
  // æ‰§è¡Œé€šçŸ¥å‡½æ•°ï¼Œé€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…
  result ? queueObserver.forEach(fn => fn(prop, value)) : '';
  return result;
}
// ä¸ºç›®æ ‡å¯¹è±¡æ·»åŠ è§‚å¯Ÿè€…
const observer = fn => queueObservers.add(fn);
// é€šè¿‡Proxyç”Ÿæˆç›®æ ‡å¯¹è±¡çš„ä»£ç†çš„å‡½æ•°
const observable = target => new Proxy(target, { set });
// è·å–ä»£ç†
const proxy = observable(target); // const proxy = new Proxy(target, { set });

observer(observer1);
observer(observer2);

proxy.name = 'ming2';
```
å½“æœ€åæ‰§è¡Œproxy.name = 'ming2'åï¼Œè¿›å…¥äº†Proxyçš„set()å‡½æ•°ä¸­ï¼ŒæˆåŠŸåœ°ä¿®æ”¹äº†nameå±æ€§å€¼ï¼Œå¹¶ä¸”é€šçŸ¥è§‚å¯Ÿè€…æ‰§è¡Œå„è‡ªçš„æ“ä½œï¼Œç¬¬ä¸€ä¸ªè§‚å¯Ÿè€…è¾“å‡ºçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
ç›®æ ‡å¯¹è±¡çš„nameå±æ€§å€¼å˜ä¸ºming2ï¼Œè§‚å¯Ÿè€…1å¼€å¿ƒåœ°ç¬‘äº†
ç›®æ ‡å¯¹è±¡çš„nameå±æ€§å€¼å˜ä¸ºming2ï¼Œè§‚å¯Ÿè€…2ä¼¤å¿ƒåœ°å“­äº†
```
## Promise
### è¯ç”Ÿçš„åŸå› 
Promiseè¯ç”Ÿä»¥å‰ï¼Œåœ¨å¤„ç†ä¸€ä¸ªå¼‚æ­¥è¯·æ±‚æ—¶ï¼Œé€šå¸¸æ˜¯åœ¨å›è°ƒå‡½æ•°ä¸­åšå¤„ç†ï¼Œä¾‹å¦‚å¤„ç†ä¸€ä¸ªAjaxè¯·æ±‚çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
$.ajax({
    url: 'testUrl',
    success: function () {
        // å›è°ƒå‡½æ•°
    }
});
```
å‡å¦‚åœ¨ä¸€ä¸ªè¡Œä¸ºä¸­ï¼Œéœ€è¦æ‰§è¡Œå¤šä¸ªå¼‚æ­¥è¯·æ±‚ï¼Œæ¯ä¸€ä¸ªè¯·æ±‚åˆéœ€è¦ä¾èµ–ä¸Šä¸€ä¸ªè¯·æ±‚çš„ç»“æœï¼ŒæŒ‰ç…§å›è°ƒå‡½æ•°çš„å¤„ç†æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
// ç¬¬ä¸€ä¸ªè¯·æ±‚
$.ajax({
    url: 'url1',
    success: function () {
        // ç¬¬äºŒä¸ªè¯·æ±‚
        $.ajax({
            url: 'url2',
            success: function () {
                // ç¬¬ä¸‰ä¸ªè¯·æ±‚
                $.ajax({
                    url: 'url3',
                    success: function () {
                        // ç¬¬å››ä¸ªè¯·æ±‚
                        $.ajax({
                            url: 'url4',
                            success: function () {
                                // æˆåŠŸåœ°å›è°ƒ
                            }
                        })
                    }
                })
            }
        })
    }
})
```
äº‹å®ä¸Šï¼Œä¸€ä¸ªè¡Œä¸ºæ‰€äº§ç”Ÿçš„å¼‚æ­¥è¯·æ±‚å¯èƒ½æ¯”è¿™ä¸ªè¿˜è¦å¤šï¼Œè¿™å°±ä¼šå¯¼è‡´ä»£ç çš„åµŒå¥—å¤ªæ·±ï¼Œå¼•å‘â€œ**å›è°ƒåœ°ç‹±**â€ã€‚
â€œå›è°ƒåœ°ç‹±â€å­˜åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜ã€‚
- ä»£ç è‡ƒè‚¿ï¼Œå¯è¯»æ€§å·®ã€‚
- ä»£ç è€¦åˆåº¦é«˜ï¼Œå¯ç»´æŠ¤æ€§å·®ï¼Œéš¾ä»¥å¤ç”¨ã€‚
- å›è°ƒå‡½æ•°éƒ½æ˜¯åŒ¿åå‡½æ•°ï¼Œä¸æ–¹ä¾¿è°ƒè¯•ã€‚
### ç”Ÿå‘½å‘¨æœŸ
æ¯ä¸€ä¸ªPromiseå¯¹è±¡éƒ½æœ‰3ç§çŠ¶æ€ï¼Œå³pendingï¼ˆè¿›è¡Œä¸­ï¼‰ã€fulfilledï¼ˆå·²æˆåŠŸï¼‰å’Œrejectedï¼ˆå·²å¤±è´¥ï¼‰ã€‚
Promiseåœ¨åˆ›å»ºæ—¶å¤„äºpendingçŠ¶æ€ï¼ŒçŠ¶æ€çš„æ”¹å˜åªæœ‰ä¸¤ç§å¯èƒ½ï¼Œ
- ä¸€ç§æ˜¯åœ¨Promiseæ‰§è¡ŒæˆåŠŸæ—¶ï¼Œç”±pendingçŠ¶æ€æ”¹å˜ä¸ºfulfilledçŠ¶æ€ï¼›
- å¦ä¸€ç§æ˜¯åœ¨Promiseæ‰§è¡Œå¤±è´¥æ—¶ï¼Œç”±pendingçŠ¶æ€æ”¹å˜ä¸ºrejectedçŠ¶æ€ã€‚

> çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¸èƒ½å†æ”¹å˜ï¼ŒçŠ¶æ€æ”¹å˜ä¸€æ¬¡åå¾—åˆ°çš„å°±æ˜¯Promiseçš„ç»ˆæ€ã€‚

### åŸºæœ¬ç”¨æ³•
Promiseå¯¹è±¡æœ¬èº«æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡newæ“ä½œç¬¦ç”ŸæˆPromiseçš„å®ä¾‹ã€‚
```js
const promise = new Promise((resolve, reject) => {
    // å¼‚æ­¥è¯·æ±‚å¤„ç†
    if(/ å¼‚æ­¥è¯·æ±‚æ ‡è¯† /) {
        resolve();
    } else {
        reject();
    }
});
```
Promiseæ‰§è¡Œçš„è¿‡ç¨‹æ˜¯ï¼šåœ¨æ¥æ”¶çš„å‡½æ•°ä¸­å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼Œç„¶ååˆ¤æ–­å¼‚æ­¥è¯·æ±‚çš„ç»“æœã€‚
- å¦‚æœç»“æœä¸ºâ€œtrueâ€ï¼Œåˆ™è¡¨ç¤ºå¼‚æ­¥è¯·æ±‚æ‰§è¡ŒæˆåŠŸï¼Œè°ƒç”¨resolve()å‡½æ•°ï¼Œresolve()å‡½æ•°ä¸€æ—¦æ‰§è¡Œï¼ŒPromiseçš„çŠ¶æ€å°±ä»pendingå˜ä¸ºfulfilledï¼›
- å¦‚æœç»“æœä¸ºâ€œfalseâ€ï¼Œåˆ™è¡¨ç¤ºå¼‚æ­¥è¯·æ±‚æ‰§è¡Œå¤±è´¥ï¼Œè°ƒç”¨reject()å‡½æ•°ï¼Œreject()å‡½æ•°ä¸€æ—¦æ‰§è¡Œï¼ŒPromiseçš„çŠ¶æ€å°±ä»pendingå˜ä¸ºrejectedã€‚

resolve()å‡½æ•°å’Œreject()å‡½æ•°å¯ä»¥ä¼ é€’å‚æ•°ï¼Œä½œä¸ºåç»­.then()å‡½æ•°æˆ–è€….catch()å‡½æ•°æ‰§è¡Œæ—¶çš„æ•°æ®æºã€‚

éœ€è¦æ³¨æ„çš„æ˜¯Promiseåœ¨åˆ›å»ºåä¼šç«‹å³è°ƒç”¨ï¼Œç„¶åç­‰å¾…æ‰§è¡Œresolve()å‡½æ•°æˆ–è€…reject()å‡½æ•°æ¥ç¡®å®šPromiseçš„æœ€ç»ˆçŠ¶æ€ã€‚
```js
let promise = new Promise(function(resolve, reject) {
    console.log('Promise');
    resolve();
});
promise.then(function() {
    console.log('resolved');
});
console.log('Hello');
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä¼šå…ˆåè¾“å‡ºâ€œPromiseâ€â€œHelloâ€â€œresolvedâ€ã€‚
- é¦–å…ˆæ˜¯Promiseçš„åˆ›å»ºï¼Œä¼šç«‹å³æ‰§è¡Œï¼Œè¾“å‡ºâ€œPromiseâ€ã€‚
- ç„¶åæ˜¯æ‰§è¡Œresolve()å‡½æ•°ï¼Œè¿™æ ·çš„è¯å°±ä¼šè§¦å‘then()å‡½æ•°æŒ‡å®šå›è°ƒå‡½æ•°çš„æ‰§è¡Œï¼Œä½†æ˜¯å®ƒéœ€è¦ç­‰å½“å‰çº¿ç¨‹ä¸­çš„æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå› æ­¤ä¼šå…ˆæ‰§è¡Œæœ€åä¸€è¡ŒåŒæ­¥ä»£ç ï¼Œè¾“å‡ºâ€œHelloâ€ã€‚
- æœ€åæ˜¯å½“æ‰€æœ‰åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•åï¼Œæ‰§è¡Œthen()å‡½æ•°ï¼Œè¾“å‡ºâ€œresolvedâ€ã€‚

åœ¨æ‹¥æœ‰Promiseå¼‚æ­¥è§£å†³æ–¹æ¡ˆåï¼Œå®ç°åŸç”Ÿgetç±»å‹çš„Ajaxè¯·æ±‚çš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
// å°è£…åŸç”Ÿgetç±»å‹Ajaxè¯·æ±‚
function ajaxGetPromise(url) {
    const promise = new Promise(function (resolve, reject) {
        const handler = function () {
            if (this.readyState !== 4) {
                return;
            }
            // å½“çŠ¶æ€ç ä¸º200æ—¶ï¼Œè¡¨ç¤ºè¯·æ±‚æˆåŠŸï¼Œæ‰§è¡Œresolve()å‡½æ•°
            if (this.status === 200) {
            // å°†è¯·æ±‚çš„å“åº”ä½“ä½œä¸ºå‚æ•°ï¼Œä¼ é€’ç»™resolve()å‡½æ•°
                resolve(this.response);
            } else {
                // å½“çŠ¶æ€ç ä¸ä¸º200æ—¶ï¼Œè¡¨ç¤ºè¯·æ±‚å¤±è´¥ï¼Œreject()å‡½æ•°
                reject(new Error(this.statusText));
            }
        };
        // åŸç”ŸAjaxè¯·æ±‚æ“ä½œ
        const client = new XMLHttpRequest();
        client.open("GET", url);
        client.onreadystatechange = handler;
        client.responseType = "json";
        client.setRequestHeader("Accept", "application/json");
        client.send();
    });
    return promise;
}
```
å½“ä¸€ä¸ªPromiseçš„å®ä¾‹åˆ›å»ºå¥½åï¼Œè¯¥å¦‚ä½•è¿›è¡ŒæˆåŠŸæˆ–è€…å¤±è´¥çš„å¼‚æ­¥å¤„ç†å‘¢ï¼Ÿè¿™å°±éœ€è¦è°ƒç”¨then()å‡½æ•°å’Œcatch()å‡½æ•°äº†ã€‚
#### then()å‡½æ•°
Promiseåœ¨åŸå‹å±æ€§ä¸Šæ·»åŠ äº†ä¸€ä¸ªthen()å‡½æ•°ï¼Œè¡¨ç¤ºåœ¨Promiseå®ä¾‹çŠ¶æ€æ”¹å˜æ—¶æ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚
å®ƒæ¥æ”¶ä¸¤ä¸ªå‡½æ•°ä½œä¸ºå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºçš„æ˜¯Promiseåœ¨æ‰§è¡ŒæˆåŠŸåï¼ˆå³è°ƒç”¨äº†resolve()å‡½æ•°ï¼‰ï¼Œæ‰€éœ€è¦æ‰§è¡Œçš„å›è°ƒå‡½æ•°ï¼Œå‡½æ•°å‚æ•°å°±æ˜¯é€šè¿‡resolve()å‡½æ•°ä¼ é€’çš„å‚æ•°ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰çš„ï¼Œè¡¨ç¤ºçš„æ˜¯Promiseåœ¨æ‰§è¡Œå¤±è´¥åï¼ˆå³è°ƒç”¨äº†reject()å‡½æ•°æˆ–æŠ›å‡ºäº†å¼‚å¸¸ï¼‰ï¼Œæ‰§è¡Œçš„å›è°ƒå‡½æ•°ã€‚
```js
// ä»¥ä¸Šé¢å°è£…Ajaxè¯·æ±‚çš„å‡½æ•°ä¸ºä¾‹ï¼Œçœ‹çœ‹then()å‡½æ•°çš„ç”¨æ³•ã€‚
ajaxGetPromise('/testUrl').then((response) => {
    console.log(response);
});
```
ajaxGetPromise()å‡½æ•°åœ¨æ‰§è¡Œåä¼šè¿”å›ä¸€ä¸ªPromiseå®ä¾‹ï¼Œåœ¨æ‰§è¡Œthen()å‡½æ•°æ—¶ï¼Œå›è°ƒå‡½æ•°ä¸­æ¥æ”¶ä¸€ä¸ªresponseå‚æ•°ï¼Œå€¼ä¸ºresolve()å‡½æ•°ä¸­ä¼ é€’çš„this.responseï¼Œè¡¨ç¤ºAjaxè¯·æ±‚çš„å“åº”ã€‚

then()å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°Promiseå®ä¾‹ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨é“¾å¼è°ƒç”¨then()å‡½æ•°ï¼Œåœ¨ä¸Šä¸€è½®then()å‡½æ•°å†…éƒ¨returnçš„å€¼ä¼šä½œä¸ºä¸‹ä¸€è½®then()å‡½æ•°æ¥æ”¶çš„å‚æ•°å€¼ã€‚
```js
const promise = new Promise((resolve, reject) => {
     resolve(1);
});
// then()å‡½æ•°é“¾å¼è°ƒç”¨
promise.then((result) => {
    console.log(result);  // 1
    return 2;
}).then((result) => {
    console.log(result);  // 2
    return 3;
}).then((result) => {
    console.log(result);  // 3
    return 4;
}).then((result) => {
    console.log(result);  // 4
});
```
åŸºäºthen()å‡½æ•°çš„é“¾å¼è°ƒç”¨å†™æ³•ï¼Œå¯ä»¥è§£å†³æœ¬å°èŠ‚å¼€å¤´æåˆ°çš„â€œå›è°ƒåœ°ç‹±â€é—®é¢˜ã€‚
ä»ä»£ç é£æ ¼ä¸Šçœ‹ï¼Œä½¿ç”¨Promiseçš„å†™æ³•éå¸¸ä¼˜é›…ã€‚

> éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨then()å‡½æ•°ä¸­ä¸èƒ½è¿”å›Promiseå®ä¾‹æœ¬èº«ï¼Œå¦åˆ™ä¼šå‡ºç°Promiseå¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚
```js
const promise = Promise.resolve()
    .then(() => {
        return promise;
    });
```
ä»¥ä¸Šä»£ç åœ¨è¿è¡Œåï¼Œä¼šæŠ›å‡ºå¦‚ä¸‹æ‰€ç¤ºçš„å¼‚å¸¸ã€‚
```bash
TypeError: Chaining cycle detected for promise #<Promise>
```
è™½ç„¶then()å‡½æ•°èƒ½å¤Ÿå¤„ç†rejectedçŠ¶æ€çš„Promiseçš„å›è°ƒå‡½æ•°ï¼Œä½†æ˜¯å¹¶ä¸æ¨èè¿™ä¹ˆåšï¼Œè€Œæ˜¯æ¨èå°†å®ƒäº¤ç»™catch()å‡½æ•°æ¥å¤„ç†ã€‚
#### catch()å‡½æ•°
catch()å‡½æ•°ä¸then()å‡½æ•°æ˜¯æˆå¯¹å­˜åœ¨çš„ï¼Œthen()å‡½æ•°æ˜¯Promiseæ‰§è¡ŒæˆåŠŸä¹‹åçš„å›è°ƒï¼Œè€Œcatch()å‡½æ•°æ˜¯Promiseæ‰§è¡Œå¤±è´¥ä¹‹åçš„å›è°ƒï¼Œå®ƒæ‰€æ¥æ”¶çš„å‚æ•°å°±æ˜¯æ‰§è¡Œreject()å‡½æ•°æ—¶ä¼ é€’çš„å‚æ•°ã€‚
```js
const promise = new Promise((resolve, reject) => {
    try {
        throw new Error('test');
    } catch(err) {
        reject(err);
    }
});
promise.catch((err) => {
    console.log(err); // Error: test
});
```
å› ä¸ºpromiseå®ä¾‹åœ¨åˆ›å»ºåä¼šç«‹å³æ‰§è¡Œï¼Œæ‰€ä»¥è¿›å…¥tryè¯­å¥åä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œä»è€Œè¢«catch()å‡½æ•°æ•è·åˆ°ï¼Œåœ¨catch()å‡½æ•°ä¸­è°ƒç”¨reject()å‡½æ•°ï¼Œå¹¶ä¼ é€’Errorä¿¡æ¯ã€‚ä¸€æ—¦reject()å‡½æ•°è¢«æ‰§è¡Œï¼Œå°±ä¼šè§¦å‘promiseå®ä¾‹çš„catch()å‡½æ•°ï¼Œä»è€Œèƒ½åœ¨catch()å‡½æ•°çš„å›è°ƒå‡½æ•°ä¸­è¾“å‡ºerrçš„ä¿¡æ¯ã€‚

äº‹å®ä¸Š**åªè¦åœ¨Promiseæ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°äº†å¼‚å¸¸ï¼Œå°±ä¼šè¢«è‡ªåŠ¨æŠ›å‡ºï¼Œå¹¶è§¦å‘reject(err)**ï¼Œè€Œä¸ç”¨æˆ‘ä»¬å»ä½¿ç”¨try...catchï¼Œåœ¨catch()å‡½æ•°ä¸­æ‰‹åŠ¨è°ƒç”¨reject()å‡½æ•°ã€‚

å› æ­¤å‰é¢çš„ä»£ç å¯ä»¥æ”¹å†™æˆå¦‚ä¸‹æ‰€ç¤ºçš„ä»£ç ã€‚
```js
const promise = new Promise((resolve, reject) => {
    throw new Error('test');
});
promise
    .catch((err) => {
        console.log(err); // Error: test
    });
```
å†æ‹¿ä¸€ä¸ªç©ºæŒ‡é’ˆå¼•ç”¨çš„å¼‚å¸¸æ¥è¿›è¡Œæµ‹è¯•ã€‚
```js
const promise = new Promise((resolve, reject) => {
    null.name;
});
promise
    .catch((err) => {
        console.log(err); // TypeError: Cannot read property 'name' of null
    });
```
åœ¨Promiseæ¥æ”¶çš„å‡½æ•°ä½“ä¸­å¼•ç”¨nullçš„nameå±æ€§æ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚è¿™ä¸ªå¼‚å¸¸ä¼šè¢«è‡ªåŠ¨æ•è·ï¼Œè€Œä¸”ä¼šè‡ªåŠ¨æ‰§è¡Œreject()å‡½æ•°ï¼Œä»è€Œä¼šè§¦å‘catch()å‡½æ•°å¹¶ä¼ é€’å¼‚å¸¸å€¼ï¼Œåœ¨å‡½æ•°ä½“ä¸­å°†å…¶è¾“å‡ºï¼Œå¾—åˆ°ä»¥ä¸‹çš„ç»“æœã€‚
```bash
TypeError: Cannot read property 'name' of null
```
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªPromiseçš„çŠ¶æ€å·²ç»å˜æˆfulfilledæˆåŠŸçŠ¶æ€ï¼Œå†å»æŠ›å‡ºå¼‚å¸¸ï¼Œæ˜¯æ— æ³•è§¦å‘catch()å‡½æ•°çš„ã€‚è¿™æ˜¯å› ä¸ºPromiseçš„çŠ¶æ€ä¸€æ—¦æ”¹å˜ï¼Œå°±ä¼šæ°¸ä¹…ä¿æŒè¯¥çŠ¶æ€ï¼Œä¸ä¼šå†æ¬¡æ”¹å˜ã€‚
```js
const promise = new Promise((resolve, reject) => {
    resolve(1);
    throw new Error('test');
});
promise
    .then((result) => {
        console.log(result);  // 1
    })
    .catch((err) => {
        console.log(err);
    });
```
åœ¨ä¸Šé¢ä»£ç çš„Promiseå‡½æ•°ä½“ä¸­ï¼Œè°ƒç”¨resolve()å‡½æ•°ï¼Œå¹¶ä¼ é€’ä¸€ä¸ªå‚æ•°1ï¼Œä¼šç›´æ¥è§¦å‘promiseçš„then()å‡½æ•°ï¼Œè€Œä¸ä¼šæ‰§è¡Œä¸‹é¢çš„æŠ›å‡ºå¼‚å¸¸çš„throwè¯­å¥ï¼Œä»è€Œè¾“å‡ºâ€œ1â€ï¼Œæ•´ä¸ªPromiseæ‰§è¡Œè¿‡ç¨‹ç»“æŸã€‚

åœ¨ES6ä¸­ä¸ä»…ä¸ºPromiseçš„åŸå‹å¯¹è±¡æ·»åŠ äº†then()å‡½æ•°å’Œcatch()å‡½æ•°ç­‰å¼‚æ­¥å¤„ç†å‡½æ•°ï¼Œè¿˜ä¸ºPromiseå¯¹è±¡è‡ªèº«æ·»åŠ äº†ä¸€ç³»åˆ—çš„é™æ€å‡½æ•°ï¼Œç”¨æ¥å¤„ç†å¤šPromiseå®ä¾‹åŒæ—¶è¿è¡Œçš„æƒ…å†µã€‚

#### Promise.all()
then()å‡½æ•°å’Œcatch()å‡½æ•°æ˜¯PromiseåŸå‹é“¾ä¸­çš„å‡½æ•°ï¼Œå› æ­¤æ¯ä¸ªPromiseçš„å®ä¾‹å¯ä»¥è¿›è¡Œå…±äº«ï¼Œè€Œall()å‡½æ•°æ˜¯Promiseæœ¬èº«çš„é™æ€å‡½æ•°ï¼Œç”¨äºå°†å¤šä¸ªPromiseå®ä¾‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ã€‚
```js
const p = Promise.all([p1, p2, p3]);
```
è¿”å›çš„æ–°Promiseå®ä¾‹pçš„çŠ¶æ€ç”±3ä¸ªPromiseå®ä¾‹p1ã€p2ã€p3å…±åŒå†³å®šï¼Œæ€»å…±ä¼šå‡ºç°ä»¥ä¸‹ä¸¤ç§æƒ…å†µã€‚
- åªæœ‰p1ã€p2ã€p3å…¨éƒ¨çš„çŠ¶æ€éƒ½å˜ä¸ºfulfilledæˆåŠŸçŠ¶æ€ï¼Œpçš„çŠ¶æ€æ‰ä¼šå˜ä¸ºfulfilledçŠ¶æ€ï¼Œæ­¤æ—¶p1ã€p2ã€p3çš„è¿”å›å€¼ç»„æˆä¸€ä¸ªæ•°ç»„ï¼Œä½œä¸ºpçš„then()å‡½æ•°çš„å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚
- åªè¦p1ã€p2ã€p3ä¸­æœ‰ä»»æ„ä¸€ä¸ªçŠ¶æ€å˜ä¸ºrejectedå¤±è´¥çŠ¶æ€ï¼Œpçš„çŠ¶æ€å°±å˜ä¸ºrejectedçŠ¶æ€ï¼Œæ­¤æ—¶ç¬¬ä¸€ä¸ªè¢«rejectçš„å®ä¾‹çš„è¿”å›å€¼ä¼šä½œä¸ºpçš„catch()å‡½æ•°çš„å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚
- å³p1 && p2 && p3
```js
const p1 = new Promise((resolve, reject) => {
    resolve('success');
}).then(result => result).catch(e => e);
const p2 = new Promise((resolve, reject) => {
    throw new Error('error');
}).then(result => result).catch(e => e);

Promise.all([p1, p2])
    .then(result => console.log(result)) // ['success', Error: error]
    .catch(e => console.log(e));
```
åœ¨ä¸Šé¢ä»£ç çš„å®ä¾‹p2ä¸­æŠ›å‡ºäº†ä¸€ä¸ªå¼‚å¸¸ï¼Œp2çš„çŠ¶æ€å˜ä¸ºrejectedï¼Œä½†æ˜¯ç”±äºp2æœ‰è‡ªå·±çš„catch()å‡½æ•°ï¼Œæ‰€ä»¥è¿™ä¸ªå¼‚å¸¸ä¼šåœ¨p2å®ä¾‹å†…éƒ¨è¢«æ¶ˆåŒ–ï¼Œå¹¶ä¸ä¼šç»§ç»­å‘å¤–æŠ›åˆ°Promise.all()å‡½æ•°ä¸­ã€‚
p2å®ä¾‹æ‰§è¡Œå®Œcatch()å‡½æ•°åï¼Œp2çš„çŠ¶æ€å®é™…æ˜¯å˜ä¸ºfulfilledï¼Œåªä¸è¿‡å®ƒçš„è¿”å›å€¼æ˜¯Errorçš„ä¿¡æ¯ã€‚
p1å®ä¾‹è°ƒç”¨resolve()å‡½æ•°æ‰§è¡ŒæˆåŠŸï¼Œå› æ­¤p1çš„çŠ¶æ€ä¹Ÿæ˜¯fulfilledï¼Œè¿”å›å€¼ä¸ºå­—ç¬¦ä¸²'success'ã€‚
å› æ­¤Promise.all()å‡½æ•°è¿è¡Œåçš„ç»“æœä¸ºè¾“å‡ºä¸€ä¸ªåŒ…å«p1ã€p2è¿”å›å€¼çš„æ•°ç»„â€œ ['success',Error: error]â€ã€‚
**å¦‚æœæƒ³è¦Promise.all()å‡½æ•°èƒ½è§¦å‘catch()å‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¸è¦åœ¨p1ã€p2å®ä¾‹ä¸­å®šä¹‰catch()å‡½æ•°ã€‚**
```js
const p1 = new Promise((resolve, reject) => {
    resolve('success');
}).then(result => result);
const p2 = new Promise((resolve, reject) => {
    throw new Error('error');
}).then(result => result);

Promise.all([p1, p2])
    .then(result => console.log(result))
    .catch(e => console.log(e)); // æŠ›å‡ºå¼‚å¸¸ï¼ŒError: error
```
#### Promise.race()å‡½æ•°
Promise.all()å‡½æ•°ä½œç”¨äºå¤šä¸ªPromiseå®ä¾‹ä¸Šï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Promiseå®ä¾‹ï¼Œè¡¨ç¤ºçš„æ˜¯å¦‚æœå¤šä¸ªPromiseå®ä¾‹ä¸­æœ‰ä»»ä½•ä¸€ä¸ªå®ä¾‹çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°å®ä¾‹çš„çŠ¶æ€å°±éšä¹‹æ”¹å˜ï¼Œè€Œæœ€å…ˆæ”¹å˜çš„é‚£ä¸ªPromiseå®ä¾‹çš„è¿”å›å€¼å°†ä½œä¸ºæ–°å®ä¾‹çš„å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚
```js
const p = Promise.race([p1, p2, p3]);
```
å½“p1ã€p2ã€p3è¿™3ä¸ªPromiseå®ä¾‹ä¸­æœ‰ä»»ä½•ä¸€ä¸ªæ‰§è¡ŒæˆåŠŸæˆ–è€…å¤±è´¥æ—¶ï¼Œç”±Promise.race()å‡½æ•°ç”Ÿæˆçš„å®ä¾‹pçš„çŠ¶æ€å°±ä¸ä¹‹ä¿æŒä¸€è‡´ï¼Œå¹¶ä¸”æœ€å…ˆé‚£ä¸ªæ‰§è¡Œå®Œçš„å®ä¾‹çš„è¿”å›å€¼å°†ä¼šæˆä¸ºpçš„å›è°ƒå‡½æ•°çš„å‚æ•°ã€‚

> ä½¿ç”¨Promise.race()å‡½æ•°å¯ä»¥å®ç°è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šå‡å¦‚å‘é€ä¸€ä¸ªAjaxè¯·æ±‚ï¼Œåœ¨3ç§’åè¿˜æ²¡æœ‰æ”¶åˆ°è¯·æ±‚æˆåŠŸçš„å“åº”æ—¶ï¼Œä¼šè‡ªåŠ¨å¤„ç†æˆè¯·æ±‚å¤±è´¥ã€‚

å®ç°çš„æ€è·¯å¦‚ä¸‹ï¼š
- å°†Ajaxè¯·æ±‚å¤„ç†æˆä¸€ä¸ªPromiseï¼Œç§°ä¹‹ä¸ºp1ã€‚
- åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰çš„Promiseå®ä¾‹ï¼Œç§°ä¹‹ä¸ºp2ï¼Œåœ¨p2ä¸­é€šè¿‡setTimeout()å‡½æ•°æ§åˆ¶3ç§’åæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ã€‚
- å°†p1å’Œp2ä¸¤ä¸ªå®ä¾‹æ”¾å…¥Promise.race()å‡½æ•°ä¸­ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹pï¼Œå¦‚æœåœ¨3ç§’å†…æ¥æ”¶åˆ°Ajaxè¯·æ±‚çš„è¿”å›å€¼ï¼Œè¡¨ç¤ºå®ä¾‹p1æ‰§è¡ŒæˆåŠŸï¼Œåˆ™pé€šè¿‡è°ƒç”¨then()å‡½æ•°å¯ä»¥æ¥æ”¶åˆ°p1çš„è¿”å›å€¼ï¼›å¦‚æœåœ¨3ç§’åè¿˜æ²¡æœ‰æ¥æ”¶åˆ°Ajaxè¯·æ±‚çš„è¿”å›å€¼ï¼Œåˆ™ä¼šæ‰§è¡Œp2ä¸­çš„setTimeout()å‡½æ•°ï¼ŒæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè¡¨ç¤ºp2æ‰§è¡Œå¤±è´¥ï¼Œåˆ™pé€šè¿‡è°ƒç”¨catch()å‡½æ•°å¯ä»¥æ¥æ”¶åˆ°p2çš„è¿”å›å€¼ã€‚
```js
// æ ¹æ®ä»¥ä¸Šåˆ†æï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹ä»£ç ã€‚
const p1 = ajaxGetPromise('/testUrl');
const p2 = new Promise(function (resolve, reject) {
      setTimeout(() => reject(new Error('request timeout')), 5000)
});
const p = Promise.race([p1, p2]);
p.then(console.log).catch(console.error);
```
#### Promise.resolve()å‡½æ•°
Promiseæä¾›äº†ä¸€ä¸ªé™æ€å‡½æ•°resolve()ï¼Œç”¨äºå°†ä¼ å…¥çš„å˜é‡è½¬æ¢ä¸ºPromiseå¯¹è±¡ï¼Œå®ƒç­‰ä»·äºåœ¨Promiseå‡½æ•°ä½“å†…è°ƒç”¨resolve()å‡½æ•°ã€‚
Promise.resolve()å‡½æ•°æ‰§è¡Œåï¼ŒPromiseçš„çŠ¶æ€ä¼šç«‹å³å˜ä¸ºfulfilledï¼Œç„¶åè¿›å…¥then()å‡½æ•°ä¸­åšå¤„ç†ã€‚
```js
Promise.resolve('hello');
// ç­‰ä»·äº
new Promise(resolve => resolve('hello'));
```
åœ¨Promise.resolve(param)å‡½æ•°ä¸­ä¼ é€’çš„å‚æ•°paramï¼Œä¼šä½œä¸ºåç»­then()å‡½æ•°çš„å›è°ƒå‡½æ•°æ¥æ”¶çš„å‚æ•°ã€‚
```js
Promise.resolve('success').then(result => console.log(result)); 
```
æ‰§è¡Œä¸Šé¢çš„ä»£ç åï¼Œä¼šè¾“å‡ºå­—ç¬¦ä¸²â€œsuccessâ€ã€‚
#### Promise.reject()å‡½æ•°
Promise.reject()å‡½æ•°ç”¨äºè¿”å›ä¸€ä¸ªçŠ¶æ€ä¸ºrejectedçš„Promiseå®ä¾‹ï¼Œå‡½æ•°åœ¨æ‰§è¡ŒåPromiseçš„çŠ¶æ€ä¼šç«‹å³å˜ä¸ºrejectedï¼Œä»è€Œä¼šç«‹å³è¿›å…¥catch()å‡½æ•°ä¸­åšå¤„ç†ï¼Œç­‰ä»·äºåœ¨Promiseå‡½æ•°ä½“å†…è°ƒç”¨reject()å‡½æ•°ã€‚
```js
const p = Promise.reject('å‡ºé”™äº†');
// ç­‰ä»·äº
const p = new Promise((resolve, reject) => reject('å‡ºé”™äº†'));
```
åœ¨Promise. reject (param)å‡½æ•°ä¸­ä¼ é€’çš„å‚æ•°paramï¼Œä¼šä½œä¸ºåç»­catch()å‡½æ•°çš„å›è°ƒå‡½æ•°æ¥æ”¶çš„å‚æ•°ã€‚
```js
Promise.reject('fail').catch(result => console.log(result));
```
æ‰§è¡Œä¸Šé¢çš„ä»£ç åï¼Œä¼šè¾“å‡ºå­—ç¬¦ä¸²â€œfailâ€ã€‚
### ç”¨æ³•å®ä¾‹
#### åœºæ™¯1ï¼šPromiseä»£ç ä¸åŒæ­¥ä»£ç åœ¨ä¸€èµ·æ‰§è¡Œ
```js
const promise = new Promise((resolve, reject) => {
    console.log(1);
    resolve();
    console.log(2);
});
promise.then(() => {
    console.log(3);
});
console.log(4);
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œè€ƒå¯Ÿçš„æ˜¯å¯¹Promiseå¯¹è±¡æ‰§è¡Œæ—¶æœºçš„ç†è§£ï¼Œå¤§è‡´ä¼šåˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªè¿‡ç¨‹ã€‚
- Promiseåœ¨åˆ›å»ºåä¼šç«‹å³æ‰§è¡Œï¼Œæ‰€æœ‰åŒæ­¥ä»£ç æŒ‰ç…§ä¹¦å†™çš„é¡ºåºä»ä¸Šå¾€ä¸‹æ‰§è¡Œï¼ŒåŒ…æ‹¬Promiseå¤–çš„åŒæ­¥ä»£ç ï¼Œå› æ­¤ä¼šå…ˆè¾“å‡ºâ€œ1 2 4â€ã€‚
- resolve()å‡½æ•°æˆ–è€…reject()å‡½æ•°ä¼šåœ¨åŒæ­¥ä»£ç æ‰§è¡Œå®Œæ¯•åå†å»æ‰§è¡Œã€‚
- å½“resolve()å‡½æ•°æˆ–è€…reject()å‡½æ•°æ‰§è¡Œåï¼Œè¿›å…¥then()å‡½æ•°æˆ–è€…catch()å‡½æ•°ä¸­æ‰§è¡Œï¼Œå®ä¾‹ä¸­è°ƒç”¨äº†resolve()å‡½æ•°ï¼Œä¼šè¿›è¡Œåˆ°then()å‡½æ•°ä¸­ï¼Œå› æ­¤ä¼šå†è¾“å‡ºâ€œ3â€ã€‚

ä»£ç çš„è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
1 2 4 3
```
#### åœºæ™¯2ï¼šåŒä¸€ä¸ªPromiseå®ä¾‹å†…ï¼Œresolve()å‡½æ•°å’Œreject()å‡½æ•°å…ˆåæ‰§è¡Œ
ä¼šåœ¨åŒä¸€ä¸ªPromiseå®ä¾‹å†…è¿ç»­å¤šæ¬¡æ‰§è¡Œresolve()å‡½æ•°å’Œreject()å‡½æ•°ï¼Œç„¶ååœ¨then()å‡½æ•°å’Œcatch()å‡½æ•°ä¸­å„è‡ªè¾“å‡ºç‰¹å®šä¿¡æ¯ï¼Œçœ‹çœ‹æœ€ç»ˆçš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆã€‚
```js
const promise2 = new Promise((resolve, reject) => {
    resolve('success1');
    reject('error');
    resolve('success2');
});

promise2
    .then((res) => {
        console.log('then: ', res);
    })
    .catch((err) => {
        console.log('catch: ', err);
    });
```
ä¸€ä¸ªPromiseçš„å®ä¾‹åªèƒ½æœ‰ä¸€æ¬¡çŠ¶æ€çš„å˜æ›´ï¼Œå½“æ‰§è¡Œäº†resolve()å‡½æ•°åï¼Œåç»­å…¶ä»–çš„reject()å‡½æ•°å’Œresolve()å‡½æ•°éƒ½ä¸ä¼šæ‰§è¡Œï¼Œç„¶åPromiseè¿›å…¥then()å‡½æ•°ä¸­åšå¤„ç†ã€‚
å› æ­¤åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæ‰§è¡Œäº†resolve('success1')åä¼šç«‹å³è¿›å…¥then()å‡½æ•°ä¸­ï¼Œè¾“å‡ºâ€œthen:success1â€ï¼Œè€Œä¸ä¼šå†æ‰§è¡Œå…¶ä»–çš„reject()å‡½æ•°æˆ–è€…resolve()å‡½æ•°ã€‚

ä»£ç çš„è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
then: success1
```
#### åœºæ™¯3ï¼šåŒä¸€ä¸ªPromiseå®ä¾‹è‡ªèº«é‡å¤æ‰§è¡Œ
ç”Ÿæˆä¸€ä¸ªPromiseçš„å®ä¾‹ï¼Œé’ˆå¯¹è¿™ä¸ªå®ä¾‹é‡å¤è°ƒç”¨then()å‡½æ•°ï¼Œåœ¨then()å‡½æ•°ä¸­è¾“å‡ºä¸€ä¸ªæ—¶é—´å·®å€¼ï¼Œçœ‹çœ‹æœ€ç»ˆçš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆã€‚
```js
1  const promise3 = new Promise((resolve, reject) => {
2      setTimeout(() => {
3          console.log('once');
4          resolve('success');
5      }, 1000);
6  });
7  const start = Date.now();
8  promise3.then((res) => {
9      console.log(res, Date.now() - start);
10 });
11 promise3.then((res) => {
12     console.log(res, Date.now() - start);
13 });
```
åŒä¸€ä¸ªPromiseçš„å®ä¾‹åªèƒ½æœ‰ä¸€æ¬¡çŠ¶æ€å˜æ¢çš„è¿‡ç¨‹ï¼Œåœ¨çŠ¶æ€å˜æ¢å®Œæˆåï¼Œå¦‚æœæˆåŠŸä¼šè§¦å‘æ‰€æœ‰çš„then()å‡½æ•°ï¼Œå¦‚æœå¤±è´¥ä¼šè§¦å‘æ‰€æœ‰çš„catch()å‡½æ•°ã€‚

åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œç¬¬1ï½6è¡Œç”Ÿæˆpromise3å®ä¾‹ï¼Œé€šè¿‡setTimeout()å‡½æ•°å»¶è¿Ÿæ‰§è¡Œresolve()å‡½æ•°ï¼Œä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œåˆ°ç¬¬7è¡Œä»£ç ï¼Œå¾—åˆ°ä¸€ä¸ªstartæ—¶é—´æˆ³ã€‚

å½“ç­‰å¾…ä¸€ç§’åï¼Œæ‰§è¡Œç¬¬2è¡Œçš„setTimeout()å‡½æ•°ï¼Œé¦–å…ˆè¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²'once'ï¼Œç„¶åæ‰§è¡Œresolve()å‡½æ•°å¹¶ä¼ é€’å­—ç¬¦ä¸²'success'ï¼Œå¼€å§‹è¿›å…¥ç¬¬8è¡Œçš„then()å‡½æ•°ä¸­ï¼Œè®¡ç®—å½“å‰æ—¶é—´æˆ³ä¸startæ—¶é—´æˆ³çš„å·®å€¼ã€‚ç”±
äºPromiseçš„çŠ¶æ€åªèƒ½æ”¹å˜ä¸€æ¬¡ï¼Œç¬¬10è¡Œçš„then()å‡½æ•°ä¸ç¬¬8è¡Œçš„then()å‡½æ•°éƒ½ä¼šæ‰§è¡Œï¼Œè€Œä¸”ä¼šæ¥æ”¶ç›¸åŒçš„å‚æ•°ï¼Œç„¶åé‡æ–°è®¡ç®—æ—¶é—´æˆ³çš„å·®å€¼ã€‚

å¾—åˆ°çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
once
success 1001
success 1002
```
#### åœºæ™¯4ï¼šåœ¨then()å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªå¼‚å¸¸
ä¼šåœ¨ä¸€ä¸ªPromiseå®ä¾‹çš„then()å‡½æ•°ä¸­è¿”å›ä¸€ä¸ªå¼‚å¸¸ï¼Œç„¶åé“¾å¼è°ƒç”¨then()å‡½æ•°å’Œcatch()å‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­è¾“å‡ºå…³é”®ä¿¡æ¯ï¼Œçœ‹çœ‹æœ€ç»ˆçš„è¾“å‡ºç»“æœæ˜¯ä»€ä¹ˆã€‚
```js
Promise.resolve()
    .then(() => {
        console.log(1);
        return new Error('error!!!'); // no throw, no catch
    })
    .then((res) => {
        console.log(2);
        console.log('then: ', res);
    })
    .catch((err) => {
        console.log(3);
        console.log('catch: ', err);
    });
```
å¾—åˆ°çš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
1
2
Error: error!!!
    at Promise.resolve.then (<anonymous>:4:16)
```
#### åœºæ™¯5ï¼šthen()å‡½æ•°æ¥æ”¶çš„å‚æ•°ä¸æ˜¯ä¸€ä¸ªå‡½æ•°
then()å‡½æ•°æ¥æ”¶çš„å‚æ•°æ˜¯å‡½æ•°çš„å½¢å¼ï¼Œå¦‚æœthen()å‡½æ•°æ¥æ”¶çš„å‚æ•°ä¸æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œä¼šäº§ç”Ÿä»€ä¹ˆæ ·çš„æƒ…å†µå‘¢ï¼Ÿ
```js
Promise.resolve(1)
    .then(2)
    .then(Promise.resolve(3))
    .then(console.log);
```
å¾ˆå¤šäººä¹ä¸€çœ‹è¿™æ®µä»£ç ï¼Œä¼šæƒ³å½“ç„¶åœ°ä»¥ä¸ºè¿”å›â€œ3â€ï¼Œä½†æ˜¯ç»“æœå´ä¸æ˜¯è¿™æ ·çš„ã€‚

è¿™æ®µä»£ç çš„è¿è¡Œç»“æœæ˜¯åªè¾“å‡ºä¸€ä¸ªâ€œ1â€ï¼Œä¸ºä»€ä¹ˆä¼šè¿™æ ·å‘¢ï¼Ÿ

åœ¨Promiseçš„then()å‡½æ•°æˆ–è€…catch()å‡½æ•°ä¸­ï¼Œæ¥æ”¶çš„æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°çš„å‚æ•°æ˜¯resolve()å‡½æ•°æˆ–è€…reject()å‡½æ•°çš„è¿”å›å€¼ã€‚**è€Œå¦‚æœä¼ å…¥çš„å€¼æ˜¯éå‡½æ•°ï¼Œé‚£ä¹ˆå°±ä¼šäº§ç”Ÿå€¼ç©¿é€ç°è±¡**ã€‚

ä½•ä¸ºå€¼ç©¿é€ç°è±¡ï¼Ÿç®€å•ç‚¹ç†è§£å°±æ˜¯ä¼ é€’çš„å€¼ä¼šè¢«ç›´æ¥å¿½ç•¥æ‰ï¼Œç»§ç»­æ‰§è¡Œé“¾å¼è°ƒç”¨åç»­çš„å‡½æ•°ã€‚

åœºæ™¯5ä¸­ï¼Œç¬¬ä¸€ä¸ªthen()å‡½æ•°æ¥æ”¶ä¸€ä¸ªå€¼â€œ2â€ï¼Œç¬¬äºŒä¸ªthen()å‡½æ•°æ¥æ”¶ä¸€ä¸ªPromiseï¼Œéƒ½ä¸æ˜¯éœ€è¦çš„å‡½æ•°å½¢å¼ï¼Œå› æ­¤è¿™ä¸¤ä¸ªthen()å‡½æ•°ä¼šå‘ç”Ÿå€¼ç©¿é€ç°è±¡ã€‚
è€Œç¬¬ä¸‰ä¸ªthen()å‡½æ•°å› ä¸ºæ¥æ”¶åˆ°console.log()å‡½æ•°ï¼Œå› æ­¤ä¼šæ‰§è¡Œï¼Œæ­¤æ—¶æ¥æ”¶çš„æ˜¯æœ€å¼€å§‹çš„resolve(1)çš„å€¼ï¼Œå› æ­¤åœºæ™¯5æœ€ç»ˆä¼šè¾“å‡ºâ€œ1â€ã€‚
#### åœºæ™¯6ï¼šä¸¤ç§æ–¹æ³•å¤„ç†rejectedçŠ¶æ€çš„Promise
**å¤„ç†Promiseå¤±è´¥çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä½¿ç”¨then()å‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨catch()å‡½æ•°ã€‚**
åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•å¤„ç†æŠ›å‡ºå¼‚å¸¸çš„Promiseï¼Œå¯ä»¥é€šè¿‡è¾“å‡ºçš„ç»“æœæ¥çœ‹çœ‹ä¸¤ç§æ–¹æ³•çš„å·®å¼‚æ˜¯ä»€ä¹ˆã€‚
```js
Promise.resolve()
    .then(function success (res) {
        throw new Error('error');
    }, function fail1 (e) {
        console.error('fail1: ', e);
    })
    .catch(function fail2 (e) {
        console.error('fail2: ', e);
    });
```
è™½ç„¶è¿™ä¸¤ç§æ–¹æ³•éƒ½èƒ½å¤„ç†PromiseçŠ¶æ€å˜ä¸ºrejectedæ—¶çš„å›è°ƒï¼Œä½†æ˜¯then()å‡½æ•°çš„ç¬¬äºŒä¸ªå‡½æ•°å´ä¸èƒ½æ•è·ç¬¬ä¸€ä¸ªå‡½æ•°ä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œè€Œcatch()å‡½æ•°å´èƒ½æ•è·åˆ°ç¬¬ä¸€ä¸ªå‡½æ•°ä¸­æŠ›å‡ºçš„å¼‚å¸¸ã€‚
```bash
# è¾“å‡ºçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
fail2: Error: error
```
> æ¨èä½¿ç”¨catch()å‡½æ•°å»å¤„ç†PromiseçŠ¶æ€å¼‚å¸¸å›è°ƒçš„åŸå› ã€‚

## Iteratorä¸for...ofå¾ªç¯
### Iteratoræ¦‚è¿°
Iteratorç§°ä¸ºéå†å™¨ï¼Œæ˜¯ES6ä¸ºä¸åŒæ•°æ®ç»“æ„éå†æ‰€æ–°å¢çš„ç»Ÿä¸€è®¿é—®æ¥å£ï¼Œå®ƒæœ‰ä»¥ä¸‹å‡ ä¸ªä½œç”¨ã€‚
- ä¸ºä»»ä½•éƒ¨ç½²äº†Iteratoræ¥å£çš„æ•°æ®ç»“æ„æä¾›ç»Ÿä¸€çš„è®¿é—®æœºåˆ¶ã€‚
- ä½¿å¾—æ•°æ®ç»“æ„çš„æˆå‘˜èƒ½å¤ŸæŒ‰ç…§æŸç§æ¬¡åºæ’åˆ—ã€‚
- ä¸ºæ–°çš„éå†æ–¹å¼for...ofæä¾›åŸºç¡€ã€‚

ä¸€ä¸ªåˆæ³•çš„Iteratoræ¥å£éƒ½ä¼šå…·æœ‰ä¸€ä¸ªnext()å‡½æ•°ï¼Œåœ¨éå†çš„è¿‡ç¨‹ä¸­ï¼Œä¾æ¬¡è°ƒç”¨next()å‡½æ•°ï¼Œè¿”å›ä¸€ä¸ªå¸¦æœ‰valueå’Œdoneå±æ€§çš„å¯¹è±¡ã€‚valueå€¼è¡¨ç¤ºå½“å‰éå†åˆ°çš„å€¼ï¼Œdoneå€¼è¡¨ç¤ºè¿­ä»£æ˜¯å¦ç»“æŸï¼Œtrueè¡¨ç¤ºè¿­ä»£å®Œæˆï¼ŒIteratoræ‰§è¡Œç»“æŸï¼›falseè¡¨ç¤ºè¿­ä»£æœªå®Œæˆï¼Œç»§ç»­æ‰§è¡Œnext()å‡½æ•°ï¼Œè¿›å…¥ä¸‹ä¸€è½®éå†ä¸­ï¼Œç›´åˆ°doneå€¼ä¸ºtrueã€‚

å…ˆä½¿ç”¨æ•°ç»„æ¥æ¨¡æ‹ŸIteratoræ¥å£çš„å®ç°ã€‚
```js
function makeIterator(array) {
    let index = 0;
    return {
        next: function () {
            if (index < array.length) {
                return { value: array[index++], done: false };
            } else {
                return { value: undefined, done: true };
            }
        }
    };
}
const arr = ['one', 'two'];
const iter = makeIterator(arr);
iter.next(); // { value: "one", done: false }
iter.next(); // { value: "two", done: false }
iter.next(); // { value: undefined, done: true }
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå°†æ•°ç»„ä½œä¸ºå‚æ•°ä¼ é€’åˆ°makeIterator()å‡½æ•°ä¸­ï¼Œç”¨äºç”Ÿæˆä¸€ä¸ªå¸¦æœ‰next()å‡½æ•°çš„éå†å™¨å¯¹è±¡ã€‚

æ¯æ¬¡è°ƒç”¨next()å‡½æ•°æ—¶ï¼Œä¼šè¿”å›ä¸€ä¸ªå¸¦æœ‰valueå’Œdoneå±æ€§çš„å¯¹è±¡ï¼Œå¦‚æœå½“å‰ç´¢å¼•å€¼indexå°äºæ•°ç»„çš„é•¿åº¦ï¼Œåˆ™valueå€¼ä¸ºæ•°ç»„ä¸­å¯¹åº”ç´¢å¼•ä½ç½®çš„å€¼ï¼Œdoneå€¼ä¸ºfalseå¹¶ä¸”indexå€¼ä¼šé€’å¢ï¼›ç›´åˆ°indexçš„å€¼ç­‰äºæ•°ç»„çš„é•¿åº¦æ‰ç»“æŸéå†ï¼Œæ­¤æ—¶valueå€¼ä¸ºundefinedï¼Œdoneå€¼ä¸ºtrueã€‚

### é»˜è®¤Iteratoræ¥å£
åªæœ‰éƒ¨ç½²äº†Iteratoræ¥å£çš„æ•°æ®ç»“æ„æ‰èƒ½ä½¿ç”¨for...oféå†ï¼Œä¸¾ä¾‹å¦‚ä¸‹ã€‚
```js
// å¯¹è±¡é»˜è®¤ä¸èƒ½ä½¿ç”¨for...ofå¾ªç¯
const obj = {
    name: 'ming',
    age: 11
};
for (let key of obj) {
    console.log(key); // TypeError: obj[Symbol.iterator] is not a function
}
// æ•°ç»„èƒ½æ­£å¸¸ä½¿ç”¨for...ofå¾ªç¯
const arr = ['one', 'two'];
for (let key in arr) {
    console.log(key); // 0, 1
}
```
å¯¹è±¡ç±»å‹çš„æ•°æ®ä½¿ç”¨for...ofå¾ªç¯æ—¶ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¡¨ç¤ºå¯¹è±¡ä¸æ”¯æŒä½¿ç”¨for...ofå¾ªç¯ï¼›è€Œå¯¹æ•°ç»„ç±»å‹çš„æ•°æ®ä½¿ç”¨for...ofå¾ªç¯æ—¶ï¼Œå¯ä»¥æ­£å¸¸è¾“å‡ºç»“æœï¼Œè¡¨ç¤ºæ•°ç»„æ”¯æŒfor...ofå¾ªç¯ã€‚

åŸç”Ÿå…·å¤‡Iteratoræ¥å£ï¼ˆå¯ç›´æ¥ä½¿ç”¨for...ofå¾ªç¯è¿›è¡Œéå†ï¼‰çš„æ•°æ®ç»“æ„æœ‰ä»¥ä¸‹å‡ ä¸ªã€‚
- Arrayã€‚
- Mapã€‚
- Setã€‚
- Stringã€‚
- å‡½æ•°çš„argumentså¯¹è±¡ã€‚
- NodeListå¯¹è±¡ã€‚

æƒ³è¦è‡ªå®šä¹‰ä¸€äº›å¯ä»¥ä½¿ç”¨for...ofå¾ªç¯çš„æ•°æ®ç»“æ„ï¼Œé‚£ä¹ˆè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

æ–¹æ³•å°±æ˜¯ä¸ºæ•°æ®ç»“æ„æ·»åŠ ä¸ŠIteratoræ¥å£ï¼ŒIteratoræ¥å£æ˜¯éƒ¨ç½²åœ¨Symbol.iteratorå±æ€§ä¸Šçš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå› æ­¤åªéœ€è¦å¯¹ç‰¹å®šçš„æ•°æ®ç»“æ„åŠ ä¸ŠSymbol.iteratorå±æ€§å³å¯ã€‚

åœ¨Symbol.iteratorå±æ€§å¯¹åº”çš„å‡½æ•°ä¸­ä¸€å®šè¦è¿”å›ä¸€ä¸ªå¸¦æœ‰next()å‡½æ•°çš„å¯¹è±¡ï¼Œåœ¨next()å‡½æ•°ä¸­éœ€è¦è¿”å›å¸¦æœ‰valueå’Œdoneå±æ€§çš„å¯¹è±¡ï¼Œä»¥æ­¤æ¥æ»¡è¶³Iteratorçš„æ‰§è¡Œè¿‡ç¨‹ã€‚

æ¥ä¸‹æ¥å°±é€šè¿‡è‡ªå®šä¹‰çš„æ‰‹æ®µï¼Œä¸ºå¯¹è±¡ç±»å‹çš„æ•°æ®æ·»åŠ Iteratoræ¥å£ï¼Œä½¿å¾—å®ƒä¹Ÿå¯ä»¥ä½¿ç”¨for...ofå¾ªç¯ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
function Person(name, age) {
    this.name = name;
    this.age = age;
}
// åœ¨åŸå‹ä¸­æ·»åŠ [Symbol.iterator]å±æ€§
Person.prototype[Symbol.iterator] = function () {
    // è®¾ç½®å˜é‡ï¼Œè®°å½•éå†çš„æ¬¡æ•°
    let count = 0;
    // é€šè¿‡Object.keys()å‡½æ•°è·å–å®ä¾‹è‡ªèº«çš„æ‰€æœ‰å±æ€§
    let propArr = Object.keys(this);
    return {
        next: function () {
            // æ¯æ‰§è¡Œä¸€æ¬¡éå†ï¼Œcountå€¼åŠ 1
            // å½“countå€¼å°äºå±æ€§çš„é•¿åº¦æ—¶ï¼Œè¡¨ç¤ºä»ç„¶å¯ä»¥éå†ï¼Œè®¾ç½®doneå€¼ä¸ºfalse
            if (count < propArr.length) {
                let index = count++;
                return { value: propArr[index], done: false };
            } else {
                // å½“countå€¼ç­‰äºå±æ€§çš„é•¿åº¦æ—¶ï¼Œéå†ç»“æŸï¼Œè®¾ç½®doneå€¼ä¸ºtrue
                return { value: undefined, done: true };
            }
        }
    }
};
const person = new Person('ming', 12);
for (let key of person) {
    console.log(key, ':', person[key]);
}
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå°†Symbol.iteratorå±æ€§è®¾ç½®åœ¨Personçš„prototypeåŸå‹ä¸Šï¼Œè¿™æ ·æ¯ä¸ªå®ä¾‹éƒ½ä¼šå…±äº«è¿™ä¸ªSymbol.iterator()å‡½æ•°ã€‚

åœ¨æ¯æ¬¡æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œå…ˆåˆ¤æ–­éå†çš„æ¬¡æ•°ä¸å±æ€§é•¿åº¦æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰åˆ™è¡¨ç¤ºéå†ç»“æŸï¼Œè®¾ç½®doneå€¼ä¸ºtrueï¼›å¦‚æœä¸ç›¸ç­‰ï¼Œåˆ™è¡¨ç¤ºä»ç„¶å¯ä»¥ç»§ç»­éå†ï¼Œè®¾ç½®doneå€¼ä¸ºfalseã€‚

è¾“å‡ºçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
name : ming
age : 12
```
### for...ofå¾ªç¯
ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ç»Ÿä¸€æ‰€æœ‰æ•°æ®ç»“æ„çš„éå†æ–¹å¼ã€‚

å¦‚ä¸Šæ–‡æ‰€è®²åˆ°çš„ï¼Œéƒ¨ç½²äº†Iteratoræ¥å£çš„æ•°æ®ç»“æ„éƒ½å¯ä»¥ä½¿ç”¨for...ofå¾ªç¯ï¼Œå› æ­¤æ•°ç»„ã€Setå’ŒMapã€ç±»æ•°ç»„å¯¹è±¡ç­‰éƒ½å¯ä»¥ç›´æ¥ä½¿ç”¨for...ofå¾ªç¯ã€‚

æ¥ä¸‹æ¥å°±é’ˆå¯¹è¿™äº›æ•°æ®ç»“æ„æ¥çœ‹çœ‹å®ƒä»¬åœ¨ä½¿ç”¨for...ofå¾ªç¯æ—¶çš„è¡¨ç°æ˜¯ä»€ä¹ˆæ ·çš„ã€‚

#### æ•°ç»„ç»“æ„
å¯¹äºæ•°ç»„ç±»å‹æ•°æ®ï¼Œfor...ofå¾ªç¯ä¼šè¿”å›æ•°ç»„ä¸­çš„æ¯ä¸ªå€¼ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„ç´¢å¼•ã€‚
```js
const arr = ['one', 'two', 'three'];
for (let key of arr) {
    console.log(key); // one, two, three
}
```
#### Setå’ŒMapæ•°æ®ç»“æ„
éƒ½åŸç”Ÿå…·å¤‡Iteratoræ¥å£ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨for...ofå¾ªç¯ã€‚
```js
let set = new Set(['one', 'two', 'three']);
for (let key of set) {
    console.log(key); // one, two, three
}

let map = new Map();
map.set('name', 'ming');
map.set('age', 12);
map.set('address', 'beijing');
for (let prop of map) {
    console.log(prop);
    // [ 'name', 'ming' ]
    // [ 'age', 12 ]
    // [ 'address', 'beijing' ]
}
```
éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š
- ä¸€ä¸ªæ˜¯for...ofå¾ªç¯éå†çš„é¡ºåºä¸å€¼æ·»åŠ è¿›æ•°æ®ç»“æ„çš„é¡ºåºä¸€è‡´ï¼›
- å¦ä¸€ä¸ªæ˜¯Setæ•°æ®ç»“æ„éå†çš„è¿”å›å€¼åªæœ‰ä¸€ä¸ªï¼Œè€ŒMapæ•°æ®ç»“æ„éå†çš„è¿”å›å€¼æœ‰ä¸¤ä¸ªï¼Œæ˜¯ç”±é”®ã€å€¼ç»„æˆçš„æ•°ç»„ã€‚

#### NodeListç»“æ„
```html
<p>è¿™æ˜¯ç¬¬ä¸€ä¸ªæ®µè½</p>
<p>è¿™æ˜¯ç¬¬äºŒä¸ªæ®µè½</p>
<p>è¿™æ˜¯ç¬¬ä¸‰ä¸ªæ®µè½</p>

<script>
    const pList = document.querySelectorAll(â€˜pâ€™);
    for (let p of pList) {
        console.log(p.innerText);
        // è¿™æ˜¯ç¬¬ä¸€ä¸ªæ®µè½
        // è¿™æ˜¯ç¬¬äºŒä¸ªæ®µè½
        // è¿™æ˜¯ç¬¬ä¸‰ä¸ªæ®µè½
    }
</script>
```
#### å‡½æ•°å‚æ•°argumentså¯¹è±¡
```js
function foo() {
    for (let arg of arguments) {
        console.log(arg); // name age address
    }
}
foo('name', 'age', 'address');
```
#### ç‰¹å®šå‡½æ•°çš„è¿”å›å€¼
> å¯¹è±¡ç±»å‹çš„æ•°æ®æ— æ³•ç›´æ¥ä½¿ç”¨for...ofå¾ªç¯è¿›è¡Œéå†

å€ŸåŠ©ES6ä¸­Objectå¯¹è±¡æ–°å¢çš„å‡ ä¸ªå‡½æ•°æ¥é—´æ¥åœ°å®ç°for...ofå¾ªç¯ï¼Œè¿™å‡ ä¸ªå‡½æ•°å¦‚ä¸‹æ‰€ç¤ºã€‚
- Object.entries()å‡½æ•°ï¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”±é”®ã€å€¼æ„æˆçš„å¯¹è±¡æ•°ç»„ã€‚
- Object.keys()å‡½æ•°ï¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”±æ‰€æœ‰çš„é”®æ„æˆçš„æ•°ç»„ã€‚
- Object.values()å‡½æ•°ï¼šè¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”±æ‰€æœ‰çš„å€¼æ„æˆçš„æ•°ç»„ã€‚

```js
const obj = {
    name: 'ming',
    age: 12,
    address: 'beijing'
};
for (let key of Object.keys(obj)) {
    console.log(key);  // name, age, address
}
for (let value of Object.values(obj)) {
    console.log(value); // ming, 12, beijing
}
for (let [key, value] of Object.entries(obj)) {
    console.log(key, ':', value);
}
// name : 'ming',
// age : 12,
// address : 'beijing'
```
### for...ofå¾ªç¯ä¸å…¶ä»–å¾ªç¯æ–¹å¼çš„æ¯”è¾ƒ
ä¸`forEach()`å‡½æ•°å¾ªç¯å’Œ`for...in`å¾ªç¯è¿›è¡Œæ¯”è¾ƒã€‚

forEach()å‡½æ•°å¾ªç¯çš„ä¸»è¦é—®é¢˜åœ¨äºæ— æ³•è·³å‡ºå¾ªç¯ï¼Œ**ä¸æ”¯æŒbreakå’Œcontinueå…³é”®å­—**ï¼Œå¦‚æœä½¿ç”¨äº†breakæˆ–continueå…³é”®å­—åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½¿ç”¨returnå…³é”®å­—ä¼šè·³è¿‡å½“å‰å¾ªç¯ï¼Œä½†ä»ä¼šæ‰§è¡Œåç»­çš„å¾ªç¯ã€‚
```js
const arr = ['one', 'two', 'three'];
arr.forEach(function (item, index) {
    if (index === 1) {
        return item; // è¿™é‡Œå¦‚æœä½¿ç”¨breakå’Œcontinueå…³é”®å­—ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œä½¿ç”¨return 
                     // å…³é”®å­—ä¼šè·³è¿‡å½“å‰å¾ªç¯
    }
    console.log(item); // one three
});
```

for...inå¾ªç¯çš„ä¸»è¦é—®é¢˜åœ¨äºï¼Œå®ƒä¸»è¦æ˜¯ä¸ºéå†å¯¹è±¡è®¾è®¡çš„ï¼Œå¯¹æ•°ç»„éå†å¹¶ä¸å‹å¥½ï¼Œä¸»è¦å­˜åœ¨ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ã€‚
- ç¬¬ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œåœ¨ä½¿ç”¨for...inå¾ªç¯éå†æ•°ç»„æ—¶ï¼Œè¿”å›çš„é”®æ˜¯å­—ç¬¦ä¸²è¡¨ç¤ºçš„æ•°ç»„çš„ç´¢å¼•ï¼Œå¦‚â€œ0â€ â€œ1â€ â€œ2â€ï¼Œå¹¶ä¸æ˜¯æ•°ç»„é¡¹çš„å€¼ã€‚
- ç¬¬äºŒä¸ªé—®é¢˜æ˜¯ï¼Œé€šè¿‡æ‰‹åŠ¨ç»™æ•°ç»„å®ä¾‹æ·»åŠ çš„å±æ€§ï¼ŒåŒæ ·ä¼šè¢«éå†å‡ºæ¥ï¼Œè€Œäº‹å®ä¸Šå¹¶ä¸å¸Œæœ›è¿™äº›é¢å¤–çš„å±æ€§è¢«éå†å‡ºæ¥ã€‚
```js
const arr = ['one', 'two', 'three'];
arr.name = 'myArr';
for (let key in arr) {
    console.log(key, typeof key);
}
```
ä»£ç è¾“å‡ºçš„ç»“æœå¦‚ä¸‹æ‰€ç¤ºã€‚
```bash
0 string
1 string
2 string
name string
```
é€šè¿‡ç»“æœå¯ä»¥çœ‹å‡ºï¼Œè¾“å‡ºçš„keyå€¼æ˜¯æ•°ç»„çš„ç´¢å¼•â€œ0â€â€œ1â€â€œ2â€å¹¶ä¸”æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œè€Œä¸”ä¸ºæ•°ç»„æ–°å¢çš„nameå±æ€§åŒæ ·è¢«éå†è¾“å‡ºï¼Œè¿™å¹¶ä¸æ˜¯æƒ³è¦çš„ç»“æœã€‚

ç›¸æ¯”äºforEach()å‡½æ•°å¾ªç¯å’Œfor...inå¾ªç¯ï¼Œfor...ofå¾ªç¯å°±æœ‰ä¸€äº›æ˜¾è‘—çš„ä¼˜ç‚¹ã€‚
1. ä¼˜ç‚¹1ï¼šå’Œfor...inå¾ªç¯æœ‰åŒæ ·çš„è¯­æ³•ï¼Œä½†æ²¡æœ‰for...inå¾ªç¯çš„ç¼ºç‚¹ï¼Œéå†æ•°ç»„æ—¶ï¼Œè¿”å›çš„æ˜¯æ•°ç»„æ¯é¡¹çš„å€¼ï¼Œè€Œä¸”ç»™æ•°ç»„å®ä¾‹æ–°å¢çš„å±æ€§å¹¶ä¸ä¼šè¢«éå†å‡ºæ¥ã€‚
```js
const arr = ['one', 'two', 'three'];
arr.name = 'myArr';
for (let key of arr) {
    console.log(key); // one two three
}
```
2. ä¼˜ç‚¹2ï¼šåœ¨for...ofå¾ªç¯ä¸­ï¼Œå¯ä»¥ä½¿ç”¨breakã€continueå’Œreturnç­‰å…³é”®å­—ã€‚
```js
const arr = ['one', 'two', 'three'];
for (let key of arr) {
    if (key === 'two') {
        break;
    }
    console.log(key); // one
}
```
## Generator()å‡½æ•°
### æ¦‚è¿°ä¸ç‰¹å¾
#### æ¦‚è¿°
> æ˜¯ES6æä¾›çš„ä¸€ç§å¼‚æ­¥ç¼–ç¨‹è§£å†³æ–¹æ¡ˆã€‚

ä»è¯­æ³•ä¸Šå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªçŠ¶æ€æœºï¼Œå‡½æ•°å†…éƒ¨ç»´æŠ¤å¤šä¸ªçŠ¶æ€ï¼Œå‡½æ•°æ‰§è¡Œçš„ç»“æœè¿”å›ä¸€ä¸ªéƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡å¯ä»¥ä¾æ¬¡è·å–Generator()å‡½æ•°å†…éƒ¨çš„æ¯ä¸€ä¸ªçŠ¶æ€ã€‚
#### ç‰¹å¾
æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè°ƒç”¨æ–¹æ³•ä¹Ÿä¸æ™®é€šå‡½æ•°ç›¸åŒï¼Œä½†æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ˜æ˜¾çš„ç‰¹å¾ã€‚
- functionå…³é”®å­—ä¸å‡½æ•°åä¹‹é—´æœ‰ä¸€ä¸ªæ˜Ÿå·ï¼ˆ*ï¼‰ã€‚
- å‡½æ•°ä½“å†…éƒ¨ä½¿ç”¨yieldå…³é”®å­—æ¥å®šä¹‰ä¸åŒçš„å†…éƒ¨çŠ¶æ€ã€‚
```js
function* helloWorldGenerator() {
      yield 'hello';
      yield 'world';
}
const hw = helloWorldGenerator();
```
è¿”å›ä¸€ä¸ªéƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡hwï¼Œç›´åˆ°è°ƒç”¨next()å‡½æ•°æ—¶ï¼Œæ‰å¼€å§‹ä»å‡½æ•°å¤´éƒ¨å‘ä¸‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°yieldè¡¨è¾¾å¼æˆ–è€…returnè¯­å¥æ‰ä¼šåœæ­¢ã€‚
```js
function* helloWorldGenerator() {
    console.log('Generatoræ‰§è¡Œ');
    yield 'hello';
    yield 'world';
}

const hw = helloWorldGenerator();
console.log('è¿™æ˜¯æµ‹è¯•æ‰§è¡Œå…ˆåé¡ºåºçš„è¯­å¥');
hw.next();
// è¿™æ˜¯æµ‹è¯•æ‰§è¡Œå…ˆåé¡ºåºçš„è¯­å¥
// Generatoræ‰§è¡Œ
```
å› ä¸ºåœ¨è°ƒç”¨helloWorldGenerator()å‡½æ•°æ—¶ï¼Œå¹¶ä¸ä¼šç«‹å³æ‰§è¡Œå‡½æ•°ä½“ï¼Œè€Œæ˜¯ä¼˜å…ˆå¾€ä¸‹æ‰§è¡Œï¼Œè¾“å‡ºâ€œè¿™æ˜¯æµ‹è¯•æ‰§è¡Œå…ˆåé¡ºåºçš„è¯­å¥â€ï¼Œç­‰åˆ°æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œæ‰å¼€å§‹æ‰§è¡Œå‡½æ•°ä½“ï¼Œè¾“å‡ºâ€œGeneratoræ‰§è¡Œâ€ã€‚

#### yieldè¡¨è¾¾å¼ä¸next()å‡½æ•°çš„å…³ç³»
Generator()å‡½æ•°è¿”å›çš„æ˜¯éƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œè€Œè¯¥å¯¹è±¡æ˜¯é€šè¿‡è°ƒç”¨next()å‡½æ•°æ¥éå†å†…éƒ¨çŠ¶æ€çš„ï¼Œæ‰€ä»¥åœ¨æ²¡æœ‰è°ƒç”¨ä¸‹ä¸€è½®next()å‡½æ•°æ—¶ï¼Œå‡½æ•°å¤„äºæš‚åœçŠ¶æ€ï¼Œè€Œè¿™ä¸ªæš‚åœçŠ¶æ€å°±æ˜¯é€šè¿‡yieldè¡¨è¾¾å¼æ¥ä½“ç°çš„ï¼Œ**å› æ­¤Generator()å‡½æ•°å¯¹å¼‚æ­¥çš„æ§åˆ¶æ˜¯é€šè¿‡yieldè¡¨è¾¾å¼æ¥å®ç°çš„ã€‚**

é€šè¿‡Iteratoræ¥å£çš„next()å‡½æ•°æ‰§è¡Œè¿‡ç¨‹å¯ä»¥çœ‹å‡ºnext()å‡½æ•°ä¸yieldè¡¨è¾¾å¼çš„å…³ç³»ã€‚
- next()å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå…·æœ‰valueå’Œdoneå±æ€§çš„å¯¹è±¡ï¼Œnext()å‡½æ•°è°ƒç”¨åï¼Œå¦‚æœé‡åˆ°yieldè¡¨è¾¾å¼ï¼Œå°±ä¼šæš‚åœåé¢çš„æ“ä½œï¼Œå¹¶å°†yieldè¡¨è¾¾å¼æ‰§è¡Œçš„ç»“æœä½œä¸ºvalueå€¼è¿›è¡Œè¿”å›ï¼Œæ­¤æ—¶doneå±æ€§çš„å€¼ä¸ºfalseã€‚
- å½“å†æ¬¡æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œä¼šå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°ä¸‹ä¸€ä¸ªyieldè¡¨è¾¾å¼ã€‚
- å½“æ‰€æœ‰çš„yieldè¯­å¥æ‰§è¡Œå®Œæ¯•æ—¶ï¼Œä¼šç›´æ¥è¿è¡Œè‡³å‡½æ•°æœ«å°¾ï¼Œå¦‚æœæœ‰returnè¯­å¥ï¼Œå°†returnè¯­å¥çš„è¡¨è¾¾å¼å€¼ä½œä¸ºvalueå€¼è¿”å›ï¼›å¦‚æœæ²¡æœ‰returnè¯­å¥ï¼Œåˆ™valueä»¥undefinedå€¼è¿›è¡Œè¿”å›ï¼Œè¿™ä¸¤ç§æƒ…å†µä¸‹çš„doneå±æ€§çš„å€¼éƒ½ä¸ºtrueï¼Œéå†ç»“æŸã€‚
```js
function* helloWorldGenerator() {
    yield 'hello';
    yield 'world';
    return 'success';
}

const hw = helloWorldGenerator();
hw.next();  // {value: "hello", done: false}
hw.next();  // {value: "world", done: false}
hw.next();  // {value: "success", done: true}
```

##### next()å‡½æ•°å‚æ•°çš„ä½œç”¨
```js
1  function* foo(x) {
2      let y = 3 * (yield (x + 2));
3      let z = yield (y / 4);
4      return (x + y + z);
5  }
6
7  let a = foo(5);
8  a.next(); // { value:7, done:false }
9  a.next(); // { value:NaN, done:false }
10 a.next(); // { value:NaN, done:true }
11
12 let b = foo(5);
13 b.next(); // { value:7, done:false }
14 b.next(8); // { value:6, done:false }
15 b.next(9); // { value:38, done:true }
```
ç¬¬ä¸€ç»„å€¼ï¼ˆç¬¬7ï½10è¡Œä»£ç ï¼‰çš„è®¡ç®—è¿‡ç¨‹ï¼š
- ç¬¬7è¡Œä»£ç è°ƒç”¨foo()å‡½æ•°ï¼Œxå€¼ä¸º5ï¼Œè·å–ä¸€ä¸ªéƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡aã€‚
- ç¬¬8è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œé‡åˆ°yieldè¡¨è¾¾å¼ï¼Œæ‰€ä»¥åœæ­¢ï¼Œæ­¤æ—¶ä¸º`yield 5 + 2 = yield 7`ï¼Œå› æ­¤ç¬¬8è¡Œä»£ç ä¼šè¾“å‡ºâ€œ{ value:7,done:false }â€ã€‚
- ç¬¬9è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œå› ä¸ºnext()å‡½æ•°æ²¡æœ‰ä¼ é€’å‚æ•°å€¼ï¼Œyieldè¡¨è¾¾å¼çš„è¿”å›å€¼ä¸ºâ€œundefinedâ€ï¼Œå³yçš„å€¼ä¸º`3 Ã— undefined = NaN`ï¼Œåœ¨è®¡ç®—y /4æ—¶ï¼Œè¿”å›â€œNaNâ€ã€‚
- åŒç†ç¬¬10è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œä¹Ÿä¼šè¿”å›â€œNaNâ€ã€‚

ç¬¬äºŒç»„å€¼ï¼ˆç¬¬12ï½15è¡Œä»£ç ï¼‰çš„è®¡ç®—è¿‡ç¨‹ã€‚
- ç¬¬12è¡Œä»£ç è°ƒç”¨foo()å‡½æ•°ï¼Œxå€¼ä¸º5ï¼Œè·å–ä¸€ä¸ªéƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡bã€‚
- ç¬¬13è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œé‡åˆ°yieldè¡¨è¾¾å¼ï¼Œåˆ™åœæ­¢ï¼Œæ­¤æ—¶ä¸º`yield 5 + 2 = yield 7`ï¼Œå› æ­¤ç¬¬13è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶ä¼šè¾“å‡ºâ€œ{ value:7, done:false }â€ã€‚
- ç¬¬14è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œä¼ é€’äº†å‚æ•°8ï¼Œè¡¨ç¤ºä¸Šä¸€è½®yieldçš„è¿”å›å€¼ä¸ºâ€œ8â€ï¼Œé‚£ä¹ˆy = 3Ã—8 = 24ï¼Œæ‰§è¡Œåˆ°yield y / 4 =yield 6ï¼Œç¬¬14è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶çš„è¿”å›å€¼ä¸ºâ€œ{ value:6,done:false }â€ã€‚
- ç¬¬15è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶ï¼Œä¼ é€’äº†å‚æ•°9ï¼Œè¡¨ç¤ºä¸Šä¸€è½®yieldçš„è¿”å›å€¼ä¸ºâ€œ9â€ï¼Œå³z = 9ï¼Œx = 5ï¼Œy = 24ï¼Œx + y + z = 38ï¼Œç¬¬15è¡Œä»£ç æ‰§è¡Œnext()å‡½æ•°æ—¶è¿”å›å€¼ä¸ºâ€œ{ value:38,done:true }â€ã€‚
#### for...ofå¾ªç¯éå†Generator()å‡½æ•°çš„è¿”å›å€¼
Generator()å‡½æ•°çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªéƒ¨ç½²äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œå¯ä»¥ä½¿ç”¨for...ofå¾ªç¯è¿›è¡Œéå†ï¼Œå¹¶ä¸”ä¸éœ€è¦æ‰‹åŠ¨è°ƒç”¨next()å‡½æ•°ï¼Œéå†çš„ç»“æœå°±æ˜¯yieldè¡¨è¾¾å¼çš„è¿”å›å€¼ã€‚
```js
function* testGenerator() {
    yield 'hello';
    yield 'world';
}

const t = testGenerator();
for (let key of t) {
    console.log(key); // å…ˆåè¾“å‡º"hello""world"
}
```
> å¯¹è±¡ç±»å‹çš„å€¼åœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸èƒ½ä½¿ç”¨for...ofå¾ªç¯è¿›è¡Œéå†çš„ï¼Œä½†æ˜¯å€ŸåŠ©äºGenerator()å‡½æ•°å¯ä»¥å®ç°for...ofå¾ªç¯çš„éå†ã€‚

ä¸»è¦æ€è·¯æ˜¯ç»™å¯¹è±¡çš„Symbol.iteratorå±æ€§è®¾ç½®ä¸€ä¸ªGenerator()å‡½æ•°ï¼Œåœ¨Generator()å‡½æ•°å†…é€šè¿‡yieldæ§åˆ¶éå†çš„è¿”å›å€¼ã€‚
```js
function* propGenerator() {
    let propArr = Object.keys(this);
    for (let prop of propArr) {
     // é€šè¿‡yieldæ§åˆ¶æ¯è½®å¾ªç¯çš„è¿”å›å€¼ä¸ºç”±å±æ€§åå’Œå±æ€§å€¼æ„æˆçš„æ•°ç»„
        yield [prop, this[prop]];
    }
}
let obj = {
    name: 'ming',
    age: 12
};
// ä¸ºobjå¯¹è±¡æ·»åŠ Symbol.iteratorå±æ€§
obj[Symbol.iterator] = propGenerator;
// å¯¹yieldçš„è¿”å›å€¼
for (let [key, value] of obj) {
    console.log(key, ':', value);
}
```
### æ³¨æ„äº‹é¡¹
#### é»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ä½¿ç”¨newå…³é”®å­—
```js
function* testGenerator() {
    yield 'test';
}
const tg = new testGenerator(); // TypeError: testGenerator is not a constructor
```
#### yieldè¡¨è¾¾å¼ä¼šå»¶è¿Ÿæ‰§è¡Œ
åœ¨Generator()å‡½æ•°ä¸­ï¼Œyieldè¡¨è¾¾å¼åªæœ‰åœ¨è°ƒç”¨next()å‡½æ•°æ—¶æ‰ä¼šå»æ‰§è¡Œï¼Œå› æ­¤èµ·åˆ°äº†å»¶è¿Ÿæ‰§è¡Œçš„æ•ˆæœã€‚
```js
function* testGenerator() {
    yield 1 + 2;
}
const tg = testGenerator();
tg.next(); // {value: 3, done: false}
```
#### yieldè¡¨è¾¾å¼åªèƒ½åœ¨Generator()å‡½æ•°ä¸­è°ƒç”¨
å¦‚æœå‡ºç°åœ¨æ™®é€šå‡½æ•°æˆ–è€…åŒ¿åå‡½æ•°ä¸­åˆ™ä¼šæŠ›å‡ºè¯­æ³•å¼‚å¸¸ã€‚
```js
function foo() {
    yield 'foo'; // æŠ›å‡ºSyntaxErrorå¼‚å¸¸
}
```
#### yieldè¡¨è¾¾å¼éœ€è¦å°æ‹¬å·æ‹¬èµ·æ¥
å½“ä¸€ä¸ªyieldè¡¨è¾¾å¼å‡ºç°åœ¨å…¶ä»–è¡¨è¾¾å¼ä¸­æ—¶ï¼Œéœ€è¦ç”¨å°æ‹¬å·å°†yieldè¡¨è¾¾å¼æ‹¬èµ·æ¥ï¼Œå¦åˆ™ä¼šæŠ›å‡ºè¯­æ³•å¼‚å¸¸ã€‚
```js
function* demo() {
    console.log('Hello' + yield 123); // æŠ›å‡ºSyntaxErrorå¼‚å¸¸
    console.log('Hello' + (yield 123)); // æ­£ç¡®
}
```
#### Generator()å‡½æ•°ä¸­çš„thisç‰¹æ®Šå¤„ç†
åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸èƒ½ä½¿ç”¨newå…³é”®å­—ç”ŸæˆGeneratorçš„å®ä¾‹ï¼Œå› æ­¤Generator()å‡½æ•°ä¸­çš„thisæ˜¯æ— æ•ˆçš„ã€‚
```js
function* testGenerator() {
    this.name = 'ming'; // åœ¨thisä¸Šç»‘å®šçš„nameå±æ€§ä¸ä¼šç”Ÿæ•ˆï¼Œè®¿é—®çš„æ—¶å€™ä¼šè¿”å›â€œundefinedâ€ã€‚
    yield 'hello';
    yield 'world';
}

const t = testGenerator();
t.next();
console.log(t.name);  // undefined
```
å¦‚æœæ—¢æƒ³ä½¿ç”¨Generator()å‡½æ•°çš„ç‰¹æ€§ï¼Œåˆæƒ³ä½¿ç”¨thisçš„ç‰¹æ€§ï¼Œé‚£è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ

ä½¿ç”¨call()å‡½æ•°æ”¹å˜Generator()å‡½æ•°çš„æ‰§è¡Œä¸»ä½“ä¸ºGenerator()å‡½æ•°çš„prototypeå±æ€§ï¼Œä½¿å¾—thisæŒ‡å‘åŸå‹å±æ€§ï¼Œè¿™æ ·å°±å¯ä»¥è®¿é—®åˆ°åŸå‹ä¸Šæ·»åŠ çš„å±æ€§ã€‚
```js
function* testGenerator() {
    this.name = 'ming';
    yield 'hello';
    yield 'world';
}
// ä½¿ç”¨call()å‡½æ•°æ”¹å˜æ‰§è¡Œä¸»ä½“ä¸ºtestGeneratorçš„prototypeå±æ€§
let t = testGenerator.call(testGenerator.prototype);
t.next();
console.log(t.name);  // ming
```
#### Generator()å‡½æ•°åµŒå¥—ä½¿ç”¨
åœ¨ä¸ä½¿ç”¨yield* è¯­å¥çš„æƒ…å†µä¸‹ï¼Œéœ€è¦æ‰‹åŠ¨éå†ä¸Šä¸€ä¸ªGenerator()å‡½æ•°ï¼Œå¹¶åœ¨éå†å®Œæˆåè¿›å…¥å½“å‰Generator()å‡½æ•°ä¸­ã€‚

```js
// ä¸€èˆ¬çš„å†™æ³•å¦‚ä¸‹æ‰€ç¤ºã€‚
function* fn1() {
    yield 'test1';
}
function* fn2() {
    yield 'test2';
    // æ‰‹åŠ¨éå†åµŒå¥—çš„Generator()å‡½æ•° 
    for(let key of fn1()) {
          console.log(key);
    }
    yield 'test3';
}

let f = fn2();
for (let key of f) {
    console.log(key);
}
```
å½“åµŒå¥—çš„Generator()å‡½æ•°å±‚çº§å¾ˆæ·±æ—¶ï¼Œå†™èµ·æ¥ä¼šéå¸¸éº»çƒ¦ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒES6æä¾›äº†ä¸€ç§æ–°çš„å†™æ³•ï¼Œé‚£å°±æ˜¯ä½¿ç”¨yield* è¡¨è¾¾å¼ï¼Œä»¥æ”¯æŒGenerator()å‡½æ•°çš„åµŒå¥—ä½¿ç”¨ã€‚

ä¸Šé¢å®ä¾‹ä½¿ç”¨yield* è¡¨è¾¾å¼çš„å†™æ³•åçš„ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
function* fn1() {
    yield 'test1';
}
function* fn2() {
    yield 'test2';
    // è°ƒç”¨å¦å¤–ä¸€ä¸ªGenerator()å‡½æ•°ï¼Œä½¿ç”¨yield*å…³é”®å­—
    yield* fn1();
    yield 'test3';
}

let f = fn2();
for (let key of f) {
    console.log(key);
}
```
æ‰§è¡Œç»“æœ
```bash
test2
test1
test3
```
## ClassğŸ‘ğŸ‘ğŸ‘
### åŸºæœ¬ç”¨æ³•
ä¸ºäº†è®©JavaScriptå…·æœ‰æ›´æ¥è¿‘é¢å‘å¯¹è±¡è¯­è¨€çš„å†™æ³•ï¼ŒES6å¼•å…¥äº†Classï¼ˆç±»ï¼‰çš„æ¦‚å¿µï¼Œé€šè¿‡classå…³é”®å­—å®šä¹‰ç±»ã€‚

ä¸ç®¡æ˜¯ES5è¿˜æ˜¯ES6çš„å†™æ³•ï¼Œæƒ³è¦ç”Ÿæˆå¯¹è±¡çš„å®ä¾‹ï¼Œéƒ½éœ€è¦é€šè¿‡newå…³é”®å­—è°ƒç”¨æ„é€ å‡½æ•°ï¼Œä½†æ˜¯åœ¨å…·ä½“å®ç°ä¸Šæœ‰ä¸€äº›å·®å¼‚ã€‚
ES5éœ€è¦å®šä¹‰æ„é€ å‡½æ•°ï¼Œåœ¨æ„é€ å‡½æ•°ä¸­å®šä¹‰å®ä¾‹å±æ€§ï¼Œç„¶ååœ¨prototypeåŸå‹ä¸Šæ·»åŠ åŸå‹å±æ€§æˆ–è€…å‡½æ•°ã€‚
ES6åˆ™ä½¿ç”¨classå…³é”®å­—å®šä¹‰ç±»çš„åç§°ï¼Œç„¶ååœ¨ç±»çš„constructoræ„é€ å‡½æ•°ä¸­å®šä¹‰å®ä¾‹å±æ€§ï¼ŒåŸå‹å±æ€§åœ¨classå†…éƒ¨ç›´æ¥å£°æ˜å¹¶èµ‹å€¼ï¼ŒåŸå‹å‡½æ•°çš„å£°æ˜ä¸æ„é€ å‡½æ•°å¤„äºåŒä¸€å±‚çº§ï¼Œå¹¶ä¸”çœç•¥functionå…³é”®å­—ã€‚
```js
// es5çš„å†™æ³•
function Person1(name, age) {
  // å®ä¾‹å±æ€§
  this.name = name;
  this.age = age;
}
// åŸå‹å±æ€§
Person1.prototype.publicCount = 1;
// åŸå‹å‡½æ•°
Person1.prototype.getName = function () {
  return this.name;
}
const p1 = new Person('ming', 22);
console.log(p1.getName()); // ming

// es6
class Person2 {
  // åŸå‹å±æ€§
  publicCount = 1;
  constructor(name, age) {
    // å®ä¾‹å±æ€§
    this.name = name;
    this.age = age;
  }
  getName() {
    return this.name;
  }
}
const p2 = new Person('ming', 22);
console.log(p2.getName()); // ming
```
classçš„æœ¬è´¨è¿˜æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåªä¸è¿‡æ˜¯å‡½æ•°çš„å¦ä¸€ç§å†™æ³•ï¼Œè¿™ç§å†™æ³•å¯ä»¥è®©å¯¹è±¡çš„åŸå‹å±æ€§å’Œå‡½æ•°æ›´åŠ æ¸…æ™°ã€‚
```js
console.log(typeof Person2); // function
```
äº‹å®ä¸Šï¼Œclassä¸­çš„æ‰€æœ‰å±æ€§å’Œå‡½æ•°éƒ½æ˜¯å®šä¹‰åœ¨prototypeå±æ€§ä¸­çš„ï¼Œä½†æ˜¯å´æ²¡æœ‰ä½¿ç”¨è¿‡prototypeå±æ€§ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ
å…¶å®è¿™æ˜¯å› ä¸ºES6å°†prototypeç›¸å…³çš„æ“ä½œå°è£…åœ¨äº†classä¸­ï¼Œé¿å…æˆ‘ä»¬ç›´æ¥å»ä½¿ç”¨prototypeå±æ€§ã€‚
```js
// p2å®ä¾‹çš„getNameå±æ€§ä¸Person2ç±»åŸå‹ä¸­çš„getNameå±æ€§æ˜¯ä¸¥æ ¼ç›¸ç­‰çš„ã€‚
console.log(p2.getName === Person2.prototype.getName); // true
```
#### é‡ç‚¹ç†è§£çš„å†…å®¹
##### constructor()å‡½æ•°
æ˜¯ä¸€ä¸ªç±»å¿…é¡»å…·æœ‰çš„å‡½æ•°ï¼Œå¯ä»¥æ‰‹åŠ¨æ·»åŠ ï¼Œå¦‚æœæ²¡æœ‰æ‰‹åŠ¨æ·»åŠ ï¼Œåˆ™ä¼šè‡ªåŠ¨éšå¼æ·»åŠ ä¸€ä¸ªç©ºçš„constructor()å‡½æ•°ã€‚
constructor()å‡½æ•°é»˜è®¤ä¼šè¿”å›å½“å‰å¯¹è±¡çš„å®ä¾‹ï¼Œå³é»˜è®¤çš„thisæŒ‡å‘ï¼Œå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹è¿”å›å€¼ã€‚
```js
class Person3 {
    constructor(name) {
        this.name = name;
        return {};
    }
    getName() {
        return this.name;
    }
}
const p = new Person3('ming');
console.log(p.getName()); // TypeError: p.getName is not a function
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œä¿®æ”¹äº†constructor()å‡½æ•°çš„è¿”å›å€¼ä¸ºä¸€ä¸ªç©ºå¯¹è±¡â€œ{}â€ï¼Œæ‰€ä»¥å®ä¾‹på®é™…ä¸ºä¸€ä¸ªç©ºå¯¹è±¡ï¼Œåœ¨è°ƒç”¨getName()å‡½æ•°æ—¶ä¼šæŠ›å‡ºä¸€ä¸ªå¼•ç”¨å¼‚å¸¸ã€‚
##### é™æ€å±æ€§å’Œå‡½æ•°
é™æ€å±æ€§å’Œå‡½æ•°åŒæ ·å­˜åœ¨äºç±»å†…éƒ¨ï¼Œä½¿ç”¨staticå…³é”®å­—ä¿®é¥°æ—¶ï¼Œé™æ€å±æ€§å’Œå‡½æ•°æ— æ³•è¢«å®ä¾‹è®¿é—®ï¼Œåªèƒ½é€šè¿‡ç±»è‡ªèº«ä½¿ç”¨ã€‚
```js
class Foo {
    static classProp = 'staticProp';
    static classMethod() {
        return 'hello';
    }
}
// ç±»è‡ªèº«å¯ä»¥æ­£å¸¸è®¿é—®é™æ€å±æ€§å’Œå‡½æ•°
Foo.classProp;  // 'staticProp'
Foo.classMethod(); // 'hello'

const foo = new Foo();
// é€šè¿‡å®ä¾‹è®¿é—®é™æ€å±æ€§ï¼Œè¿”å›undefined
foo.classProp; // undefined
// é€šè¿‡å®ä¾‹è®¿é—®é™æ€å‡½æ•°ï¼ŒæŠ›å‡ºå¼‚å¸¸
foo.classMethod(); // TypeError: foo.classMethod is not a function
```
**é™æ€å‡½æ•°ä¸­çš„thisæŒ‡å‘çš„æ˜¯ç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯ç±»çš„å®ä¾‹**ï¼Œä¹Ÿæ­£å› ä¸ºé™æ€å‡½æ•°å’Œå®ä¾‹å‡½æ•°ä¸­çš„thisæ˜¯éš”ç¦»çš„ï¼Œæ‰€ä»¥åŒä¸€ä¸ªç±»ä¸­å¯ä»¥å­˜åœ¨å‡½æ•°åç›¸åŒçš„é™æ€å‡½æ•°å’Œå®ä¾‹å‡½æ•°ã€‚
```js
class MyClassroom {
    constructor(number) {
        this.number = number;
    }
    // é™æ€å‡½æ•°ï¼ŒåŒ…å«çš„thiså…³é”®å­—æŒ‡å‘çš„æ˜¯ç±»æœ¬èº«ï¼Œè€Œä¸æ˜¯å®ä¾‹
    static get1() {
        return this.number;
    }
    // å®ä¾‹å‡½æ•°ï¼ŒåŒ…å«çš„thisæŒ‡å‘å®ä¾‹
    get1() {
        return this.number;
    }
}

console.log(MyClassroom.get1()); // undefined
// ä¸ºç±»æœ¬èº«æ·»åŠ å˜é‡
MyClassroom.number = 60;
console.log(MyClassroom.get1()); // 60

const classroom = new MyClassroom(20);
console.log(classroom.get1()); // 20
```
#### ä½¿ç”¨ç¤ºä¾‹
ä½¿ç”¨Classå®šä¹‰ä¸€ä¸ªç±»ï¼Œæ¥å®Œæˆä¸€ä¸ªç®€å•çš„ç‰ˆæœ¬æ§åˆ¶åŠŸèƒ½ï¼Œä¸»è¦æœ‰ä»¥ä¸‹æ“ä½œã€‚
- ä½¿ç”¨ä¸€ä¸ªäºŒç»´æ•°ç»„ä½œä¸ºæ‰€æœ‰å†å²æäº¤è®°å½•çš„é›†åˆï¼Œæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ä¸ºä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œè¡¨ç¤ºæŸæ¬¡commitæ—¶è®°å½•çš„ä¿¡æ¯ã€‚
- ä½¿ç”¨ä¸€ä¸ªä¸€ç»´æ•°ç»„è£…ä¸‹ç”¨æˆ·æ‰€æœ‰çš„å†å²ä¿®æ”¹å€¼ï¼Œå½“è°ƒç”¨commit()å‡½æ•°æ—¶ï¼Œä¼šå°†å†å²ä¿®æ”¹å€¼æ·»åŠ è‡³å†å²è®°å½•å¯¹åº”çš„äºŒç»´æ•°ç»„ä¸­ã€‚
- å½“è°ƒç”¨revert()å‡½æ•°æ—¶ï¼Œä¼šå›æ»šåˆ°æœ€è¿‘ä¸€æ¬¡commitçš„ç‰ˆæœ¬ã€‚
```js
class VersionedArray {
    constructor() {
        super();
        // æ‰€æœ‰çš„å†å²æäº¤å€¼
        this.arr = [];
        // åˆå§‹çŠ¶æ€ç©ºçš„äºŒç»´æ•°ç»„
        this.history = [[]];
    }
    commit() {
        // æ¯æ¬¡commitæ—¶ï¼Œå…ˆæ‰§è¡Œslice()å‡½æ•°è·å–ä¸€æ¬¡ï¼Œç„¶åæ·»åŠ åˆ°historyäºŒç»´æ•°ç»„ä¸­
        this.history.push(this.arr.slice());
    }
    revert() {
        // æ‰§è¡Œrevert()å‡½æ•°æ—¶ï¼Œä¼šå°†è·ç¦»æœ€è¿‘ä¸€æ¬¡commitã€æ–°å¢çš„ä½†æ˜¯æ²¡æœ‰commitçš„å†…å®¹å…¨éƒ¨æ¸…ç©º
        // è¿”å›åˆ°ä¸Šä¸€æ¬¡commitçš„çŠ¶æ€
        this.arr.splice(0, this.arr.length, ...this.history[this.history.
length - 1]);
    }
}

let x = new VersionedArray();

// ç¬¬ä¸€æ¬¡ä¿®æ”¹äº†1
x.arr.push(1);

// ç¬¬äºŒæ¬¡ä¿®æ”¹äº†2
x.arr.push(2);
console.log(x.arr); // [1, 2]
// æ­¤æ—¶å¹¶æ²¡æœ‰commitï¼Œå†å²è®°å½•ä»ç„¶ä¸ºç©º
console.log(x.history); // [[]]
// æ‰§è¡Œcommit()å‡½æ•°ï¼Œæ·»åŠ è‡³å†å²è®°å½•ä¸­
x.commit();
console.log(x.history); // [[], [1, 2]]

// ç¬¬ä¸‰æ¬¡ä¿®æ”¹äº†3
x.arr.push(3);
console.log(x.arr); // [1, 2, 3]
// å†æ¬¡æ‰§è¡Œcommit()å‡½æ•°ï¼Œå°†å½“å‰arrå€¼æ·»åŠ è‡³å†å²è®°å½•ä¸­
x.commit();
console.log(x.history); // [ [], [ 1, 2 ], [ 1, 2, 3 ] ]

// ç¬¬å››æ¬¡ä¿®æ”¹äº†4
x.arr.push(4);
// ç”±äºæ²¡æœ‰commitï¼Œç›´æ¥å›æ»šåˆ°æœ€è¿‘çš„ä¸€ä¸ªå†å²ç‰ˆæœ¬
x.revert();
console.log(x.arr); // [1, 2, 3]
```
#### ä½¿ç”¨æ³¨æ„ç‚¹
1. åªèƒ½ä¸newå…³é”®å­—é…åˆä½¿ç”¨
```js
class Person {}

const p1 = new Person(); // æ­£å¸¸
const p2 = Person(); // TypeError: Class constructor Person cannot be invoked 
without 'new'
```
2. ä¸å­˜åœ¨å˜é‡æå‡
letå…³é”®å­—å’Œconstå…³é”®å­—å£°æ˜çš„å˜é‡ä¸å­˜åœ¨å˜é‡æå‡ï¼Œclasså®šä¹‰çš„ç±»åŒæ ·ä¸å­˜åœ¨å˜é‡æå‡ï¼Œå› æ­¤å¦‚æœåœ¨å®šä¹‰ç±»ä¹‹å‰å»ä½¿ç”¨å®ƒï¼Œä¼šæŠ›å‡ºå¼•ç”¨å¼‚å¸¸ã€‚
```js
const p = new Person(); // ReferenceError: Person is not defined
class Person {}
```
3. åœ¨ç±»ä¸­å£°æ˜å‡½æ•°æ—¶ï¼Œä¸è¦åŠ functionå…³é”®å­—
```js
class Person3 {
    getName function() {  // SyntaxError: Unexpected token function
        return 'ming';
    }
}
```
4. thisæŒ‡å‘ä¼šå‘ç”Ÿå˜åŒ–
ç±»å†…éƒ¨çš„thisé»˜è®¤æŒ‡å‘çš„æ˜¯ç±»çš„å®ä¾‹ï¼Œåœ¨è°ƒç”¨å®ä¾‹å‡½æ•°æ—¶ï¼Œä¸€å®šè¦æ³¨æ„thisçš„æŒ‡å‘æ€§é—®é¢˜ã€‚å¦‚æœå•ç‹¬ä½¿ç”¨å®ä¾‹å‡½æ•°æ—¶ï¼Œthisçš„æŒ‡å‘ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå¾ˆå®¹æ˜“å¸¦æ¥ä¸€å®šçš„é—®é¢˜ã€‚
```js
class Person4 {
    constructor(name) {
        this.name = name;
    }
    getName() {
        return this.name;
    }
}
const p = new Person4('ming');
let { getName } = p; // ä½¿ç”¨è§£æ„è·å–åˆ°getName()å‡½æ•°
getName(); // TypeError: Cannot read property 'name' of undefined
```
è¿™æ˜¯å› ä¸ºgetName()å‡½æ•°æ˜¯åœ¨å…¨å±€ç¯å¢ƒä¸­æ‰§è¡Œçš„ï¼ŒthisæŒ‡å‘çš„æ˜¯å…¨å±€ç¯å¢ƒï¼Œè€Œåœ¨ES6çš„classå…³é”®å­—ä¸­ä½¿ç”¨äº†ä¸¥æ ¼æ¨¡å¼ã€‚**åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹thisä¸èƒ½æŒ‡å‘å…¨å±€ç¯å¢ƒï¼Œè€Œæ˜¯æŒ‡å‘undefined**ï¼Œæ‰€ä»¥getName()å‡½æ•°åœ¨æ‰§è¡Œæ—¶ï¼Œthiså®é™…ä¸ºundefinedï¼Œé€šè¿‡undefinedå¼•ç”¨nameå±æ€§å°±ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
// ä¸ºäº†è§£å†³ä¸Šè¿°é—®é¢˜ï¼Œå¯ä»¥åœ¨æ„é€ å‡½æ•°ä¸­ä½¿ç”¨bindå…³é”®å­—é‡æ–°ç»‘å®šthisã€‚
class Person4 {
    constructor(name) {
        this.name = name;
        // é‡æ–°ç»‘å®šgetName()å‡½æ•°ä¸­thisçš„æŒ‡å‘ä¸ºå½“å‰å®ä¾‹
        this.getName = this.getName.bind(this);
    }
    getName() {
        return this.name;
    }
}
const p = new Person4('ming');
let { getName } = p;
getName(); // ming
```
### classç»§æ‰¿
ES6æ–°å¢äº†extendså…³é”®å­—ï¼Œå¯ä»¥å¿«é€Ÿå®ç°ç±»çš„ç»§æ‰¿ã€‚

åœ¨å­ç±»çš„constructoræ„é€ å‡½æ•°ä¸­ï¼Œéœ€è¦é¦–å…ˆè°ƒç”¨super()å‡½æ•°æ‰§è¡Œçˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå†æ‰§è¡Œå­ç±»çš„å‡½æ•°ä¿®é¥°thisã€‚
```js
// çˆ¶ç±»
class Animal {
    constructor(type) {
        this.type = type;
    }
}
// å­ç±»
class Cat extends Animal {
    constructor(name, type) { 
        // ä¼˜å…ˆè°ƒç”¨super()å‡½æ•°æ‰§è¡Œçˆ¶ç±»æ„é€ å‡½æ•°
        super(type);
        this.name = name;
    }
    getName() {
        return this.name;
    }
}

const cat = new Cat('tom', 'cat');
console.log(cat.type); // cat
console.log(cat.getName()); // tom
```
ä½¿ç”¨extendså…³é”®å­—ä¸ä»…å¯ä»¥ç»§æ‰¿è‡ªå®šä¹‰çš„ç±»ï¼Œè¿˜å¯ä»¥ç»§æ‰¿åŸç”Ÿçš„å†…ç½®æ„é€ å‡½æ•°ã€‚
```js
class MyArr extends Array {
    constructor() {
        super();
    }
    pushItem(item) {
        // å› ä¸ºç»§æ‰¿äº†Array()æ„é€ å‡½æ•°ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡thisè®¿é—®åˆ°æ•°ç»„çš„push()å‡½æ•°
        this.push(item);
    }
}

let arr = new MyArr();
arr.pushItem({ name: 'ming' });
```
çˆ¶ç±»çš„é™æ€å‡½æ•°æ— æ³•è¢«å®ä¾‹ç»§æ‰¿ï¼Œä½†å¯ä»¥è¢«å­ç±»ç»§æ‰¿ã€‚å­ç±»åœ¨è®¿é—®æ—¶åŒæ ·æ˜¯é€šè¿‡æœ¬èº«å»è®¿é—®ï¼Œè€Œä¸æ˜¯é€šè¿‡å­ç±»å®ä¾‹å»è®¿é—®ã€‚
```js
class Parent {
    static staticMethod() {
        return 'hello';
    }
}
class Child extends Parent {}
// é€šè¿‡å­ç±»æœ¬èº«å¯ä»¥è®¿é—®åˆ°çˆ¶ç±»çš„é™æ€å‡½æ•°ï¼Œè¾“å‡ºâ€œhelloâ€
console.log(Child.staticMethod());
```
## Module
### æ¦‚è¿°
ES6æä¾›äº†æ¨¡å—åŒ–çš„è®¾è®¡ï¼Œå¯ä»¥å°†å…·æœ‰æŸä¸€ç±»ç‰¹å®šåŠŸèƒ½çš„ä»£ç æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œåœ¨ä½¿ç”¨æ—¶ï¼Œåªéœ€è¦å¼•å…¥ç‰¹å®šçš„æ–‡ä»¶ï¼Œä¾¿å¯ä»¥é™ä½æ–‡ä»¶ä¹‹é—´çš„è€¦åˆæ€§ã€‚

ç›¸æ¯”äºæ—©æœŸåˆ¶å®šçš„CommonJSè§„èŒƒï¼ŒES6çš„æ¨¡å—åŒ–è®¾è®¡æœ‰3ç‚¹ä¸åŒã€‚
- CommonJSåœ¨è¿è¡Œæ—¶å®Œæˆæ¨¡å—çš„åŠ è½½ï¼Œè€ŒES6æ¨¡å—æ˜¯åœ¨ç¼–è¯‘æ—¶å®Œæˆæ¨¡å—çš„åŠ è½½ï¼Œæ•ˆç‡è¦æ›´é«˜ã€‚
- CommonJSæ¨¡å—æ˜¯å¯¹è±¡ï¼Œè€ŒES6æ¨¡å—å¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç±»å‹ï¼Œé€šè¿‡exportå‘½ä»¤æŒ‡å®šè¾“å‡ºçš„å†…å®¹ï¼Œå¹¶é€šè¿‡importå‘½ä»¤å¼•å…¥å³å¯ã€‚
- CommonJSæ¨¡å—ä¼šåœ¨requireåŠ è½½æ—¶å®Œæˆæ‰§è¡Œï¼Œè€ŒES6çš„æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œåªåœ¨æ‰§è¡Œæ—¶è·å–æ¨¡å—ä¸­çš„å€¼ã€‚

ES6æ¨¡å—æ ¸å¿ƒçš„å†…å®¹åœ¨äºexportå‘½ä»¤å’Œimportå‘½ä»¤çš„ä½¿ç”¨ï¼Œä¸¤è€…ç›¸è¾…ç›¸æˆï¼Œå…±åŒä¸ºæ¨¡å—åŒ–æœåŠ¡ã€‚
### exportå‘½ä»¤
exportå‘½ä»¤ç”¨äºå®šä¹‰æ¨¡å—å¯¹å¤–è¾“å‡ºçš„å†…å®¹ï¼Œä»»ä½•ä½ æƒ³é€šè¿‡å¤–éƒ¨æ–‡ä»¶è¿›è¡Œè®¿é—®çš„å†…å®¹ï¼Œåªéœ€è¦é€šè¿‡exportå…³é”®å­—å°±å¯ä»¥å®Œæˆã€‚
#### exportå‘½ä»¤çš„ç‰¹æ€§
1. exportçš„æ˜¯æ¥å£ï¼Œè€Œä¸æ˜¯å€¼
ä¸èƒ½ç›´æ¥é€šè¿‡exportè¾“å‡ºå˜é‡å€¼ï¼Œè€Œæ˜¯éœ€è¦å¯¹å¤–æä¾›æ¥å£ï¼Œå¿…é¡»ä¸æ¨¡å—å†…éƒ¨çš„å˜é‡å»ºç«‹ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œä¾‹å¦‚ä»¥ä¸‹å†™æ³•éƒ½æ˜¯é”™è¯¯çš„ã€‚
```js
let obj = {};
let a = 1;
function foo() {}

export obj;  // é”™è¯¯å†™æ³•
export a;  // é”™è¯¯å†™æ³•
export foo; // é”™è¯¯å†™æ³•

// éœ€è¦ä¿®æ”¹æˆå¯¹è±¡è¢«æ‹¬èµ·æ¥æˆ–è€…ç›´æ¥å¯¼å‡ºçš„å½¢å¼ã€‚
let obj = {};
function foo() {}

export let a = 1; // æ­£ç¡®å†™æ³•
export {obj}; // æ­£ç¡®å†™æ³•
export {foo}; // æ­£ç¡®å†™æ³•
```
2. exportå€¼çš„å®æ—¶æ€§
exportå¯¹å¤–è¾“å‡ºçš„æ¥å£ï¼Œåœ¨å¤–éƒ¨æ¨¡å—å¼•ç”¨æ—¶ï¼Œæ˜¯å®æ—¶è·å–çš„ï¼Œå¹¶ä¸æ˜¯importé‚£ä¸ªæ—¶åˆ»çš„å€¼ã€‚

å‡å¦‚åœ¨æ–‡ä»¶ä¸­exportä¸€ä¸ªå˜é‡ï¼Œç„¶åé€šè¿‡å®šæ—¶å™¨ä¿®æ”¹è¿™ä¸ªå˜é‡çš„å€¼ï¼Œé‚£ä¹ˆåœ¨å…¶ä»–æ–‡ä»¶ä¸­ä¸åŒæ—¶åˆ»ä½¿ç”¨importçš„å˜é‡ï¼Œå€¼ä¹Ÿä¼šä¸åŒã€‚
```js
// å¯¼å‡ºæ–‡ä»¶export1.js
const name = 'ming2';
// ä¸€ç§’åä¿®æ”¹å˜é‡nameçš„å€¼
setTimeout(() => name = 'ming3', 1000);
export { name };

// å¯¼å…¥æ–‡ä»¶import1.js
import { name } from './export1.js';
console.log(name); // ming2
setTimeout(() => {
  console.log(name); // 'ming3'
}, 1000);
```
### exportå‘½ä»¤çš„å¸¸è§ç”¨æ³•
1. ä½¿ç”¨aså…³é”®å­—è®¾ç½®åˆ«å
å¦‚æœä¸æƒ³å¯¹å¤–æš´éœ²å†…éƒ¨å˜é‡çš„çœŸå®åç§°ï¼Œå¯ä»¥ä½¿ç”¨aså…³é”®å­—è®¾ç½®åˆ«åï¼ŒåŒä¸€ä¸ªå±æ€§å¯ä»¥è®¾ç½®å¤šä¸ªåˆ«åã€‚
```js
const _name = 'ming';
export { _name as name };
export { _name as name2 };
```
åœ¨å¤–éƒ¨æ–‡ä»¶è¿›è¡Œå¼•å…¥æ—¶ï¼Œé€šè¿‡nameå’Œname2ä¸¤ä¸ªå˜é‡éƒ½å¯ä»¥è®¿é—®åˆ°â€œmingâ€å€¼ã€‚
2. ç›¸åŒå˜é‡ååªèƒ½å¤Ÿexportä¸€æ¬¡
åœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­ï¼ŒåŒä¸€ä¸ªå˜é‡ååªèƒ½å¤Ÿexportä¸€æ¬¡ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
```js
const _name = 'ming';
const name = 'ming';

export { _name as name };
export { name }; // æŠ›å‡ºå¼‚å¸¸ï¼Œnameä½œä¸ºå¯¹å¤–è¾“å‡ºçš„å˜é‡ï¼Œåªèƒ½exportä¸€æ¬¡
```
3. å°½é‡ç»Ÿä¸€export
å¦‚æœæ–‡ä»¶exportçš„å†…å®¹æœ‰å¾ˆå¤šï¼Œå»ºè®®éƒ½æ”¾åœ¨æ–‡ä»¶æœ«å°¾å¤„ç»Ÿä¸€è¿›è¡Œexportï¼Œè¿™æ ·å¯¹exportçš„å†…å®¹èƒ½ä¸€ç›®äº†ç„¶ã€‚
```js
const name = 'ming';
const age = 12;
const sayHello = function () {
    console.log('hello');
};

export { name, age, sayHello };
```
### importå‘½ä»¤
ä¸€ä¸ªæ¨¡å—ä¸­ä½¿ç”¨exportå‘½ä»¤å¯¼å‡ºçš„å†…å®¹ï¼Œé€šè¿‡importå‘½ä»¤å¯ä»¥å¼•åˆ°å¦ä¸€ä¸ªæ¨¡å—ä¸­ï¼Œä¸¤è€…å¯ä»¥ç›¸äº’é…åˆä½¿ç”¨ã€‚
å¦‚æœæƒ³è¦åœ¨HTMLé¡µé¢ä¸­ä½¿ç”¨importå‘½ä»¤ï¼Œéœ€è¦åœ¨scriptæ ‡ç­¾ä¸Šä½¿ç”¨ä»£ç type="module"ã€‚
```html
<script type="module"></script>
```
#### importå‘½ä»¤çš„ç‰¹æ€§
1. ä¸exportçš„å˜é‡åç›¸åŒ
importå‘½ä»¤å¼•å…¥çš„å˜é‡éœ€è¦æ”¾åœ¨ä¸€ä¸ªå¤§æ‹¬å·é‡Œï¼Œæ‹¬æˆå¯¹è±¡çš„å½¢å¼ï¼Œè€Œä¸”importçš„å˜é‡åå¿…é¡»ä¸exportçš„å˜é‡åä¸€è‡´ã€‚
è¿™ç‚¹ç‰¹æ€§åœ¨ä½¿ç”¨äº†export defaultå‘½ä»¤æ—¶ä¼šæœ‰æ–°çš„è¡¨ç°å½¢å¼ï¼Œåœ¨åé¢æˆ‘ä»¬ä¼šå…·ä½“è®²åˆ°ã€‚
```js
// export.js
const _name = 'ming';
export { _name as name };

// import.js
import { _name } from './export.js'; // æŠ›å‡ºå¼‚å¸¸
import { name } from './export.js'; // å¼•å…¥æ­£å¸¸
```
2. ç›¸åŒå˜é‡åçš„å€¼åªèƒ½importä¸€æ¬¡
```js
// export1.js
export const name = 'ming';

// export2.js
export const name = 'cat';

// åŒæ—¶ä»ä¸¤ä¸ªæ¨¡å—ä¸­å¼•å…¥nameå˜é‡ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚
import { name } from './export1.js';
import { name } from './export2.js'; // æŠ›å‡ºå¼‚å¸¸
```
3. importå‘½ä»¤å…·æœ‰æå‡çš„æ•ˆæœâœ¨
ä¼šå°†importçš„å†…å®¹æå‡åˆ°æ–‡ä»¶å¤´éƒ¨ã€‚
```js
// export.js
export const name = 'ming';

// import.js
console.log(name);  // ming
import {name} from './export.js';
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œimportè¯­å¥å‡ºç°åœ¨è¾“å‡ºè¯­å¥çš„åé¢ï¼Œä½†æ˜¯ä»ç„¶èƒ½æ­£å¸¸è¾“å‡ºã€‚æœ¬è´¨ä¸Šæ˜¯å› ä¸ºimportæ˜¯åœ¨ç¼–è¯‘æœŸè¿è¡Œçš„ï¼Œåœ¨æ‰§è¡Œè¾“å‡ºä»£ç ä¹‹å‰å·²ç»æ‰§è¡Œäº†importè¯­å¥ã€‚
4. å¤šæ¬¡importæ—¶ï¼Œåªä¼šä¸€æ¬¡åŠ è½½
æ¯ä¸ªæ¨¡å—åªåŠ è½½ä¸€æ¬¡ï¼Œæ¯ä¸ªJSæ–‡ä»¶åªæ‰§è¡Œä¸€æ¬¡ï¼Œå¦‚æœåœ¨åŒä¸€ä¸ªæ–‡ä»¶ä¸­å¤šæ¬¡importç›¸åŒçš„æ¨¡å—ï¼Œåˆ™åªä¼šæ‰§è¡Œä¸€æ¬¡æ¨¡å—æ–‡ä»¶ï¼Œåç»­ç›´æ¥ä»å†…å­˜è¯»å–ã€‚
```js
// export.js
console.log('å¼€å§‹æ‰§è¡Œ');
export const name = 'ming';
export const age = 12;

// import.js
import { name } from './export.js';
import { age } from './export.js';
```
åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œimportä¸¤æ¬¡export.jsæ–‡ä»¶ï¼Œä½†æ˜¯æœ€ç»ˆåªè¾“å‡ºäº†ä¸€æ¬¡â€œå¼€å§‹æ‰§è¡Œâ€ï¼Œ**å¯ä»¥ç†è§£ä¸ºimportå¯¼å…¥çš„æ¨¡å—æ˜¯ä¸ªå•ä¾‹æ¨¡å¼**ã€‚
5. importçš„å€¼æœ¬èº«æ˜¯åªè¯»çš„ï¼Œä¸å¯ä¿®æ”¹
ä½¿ç”¨importå‘½ä»¤å¯¼å…¥çš„å€¼ï¼Œå¦‚æœæ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å€¼æ˜¯ä¸å¯ä»¥ä¿®æ”¹çš„ï¼Œç›¸å½“äºä¸€ä¸ªconstå¸¸é‡ï¼›å¦‚æœæ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å€¼ï¼Œé‚£ä¹ˆå®ƒä»¬çš„å¼•ç”¨æœ¬èº«æ˜¯ä¸èƒ½ä¿®æ”¹çš„ï¼Œåªèƒ½ä¿®æ”¹å¼•ç”¨å¯¹åº”çš„å€¼æœ¬èº«ã€‚
```js
// export.js
const obj = {
    name: 'ming5'
};
const age = 15;

export { obj, age };

// import.js
import { obj, age } from './export.js';

obj.name = 'ming6'; // ä¿®æ”¹å¼•ç”¨æŒ‡å‘çš„å€¼ï¼Œæ­£å¸¸
obj = {}; // æŠ›å‡ºå¼‚å¸¸ï¼Œä¸å¯ä¿®æ”¹å¼•ç”¨æŒ‡å‘
age = 15; // æŠ›å‡ºå¼‚å¸¸ï¼Œä¸å¯ä¿®æ”¹å€¼æœ¬èº«
```
#### importå‘½ä»¤çš„å¸¸è§ç”¨æ³•
1. è®¾ç½®å¼•å…¥å˜é‡çš„åˆ«å
åŒæ ·å¯ä»¥ä½¿ç”¨aså…³é”®å­—ä¸ºå˜é‡è®¾ç½®åˆ«åï¼Œå¯ä»¥ç”¨äºè§£å†³ä¸Šä¸€éƒ¨åˆ†ä¸­ç›¸åŒå˜é‡åimportä¸€æ¬¡çš„é—®é¢˜ã€‚
```js
// export1.js
export const name = 'ming';

// export2.js
export const name = 'cat';

// ä½¿ç”¨aså…³é”®å­—è®¾ç½®ä¸¤ä¸ªä¸åŒçš„åˆ«åï¼Œè§£å†³äº†é—®é¢˜
import { name as personName } from './export1.js';
import { name as animalName } from './export2.js';
```
2. æ¨¡å—æ•´ä½“åŠ è½½
å½“éœ€è¦åŠ è½½æ•´ä¸ªæ¨¡å—çš„å†…å®¹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨æ˜Ÿå·ï¼ˆ*ï¼‰é…åˆaså…³é”®å­—æŒ‡å®šä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡å¯¹è±¡å»è®¿é—®å„ä¸ªè¾“å‡ºå€¼ã€‚
```js
// export.js
const obj = {
    name: 'ming'
};

export const a = 1;
export { obj };

// import.js
import * as a from './export.js';
```
éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨äº†æ˜Ÿå·ï¼Œå°±ä¸èƒ½å†ä½¿ç”¨å¤§æ‹¬å·{}æ‹¬èµ·æ¥ã€‚ä»¥ä¸‹å†™æ³•æ˜¯é”™è¯¯çš„ã€‚
```js
import { * as a } from './export.js'; // é”™è¯¯çš„å†™æ³•
```
### export defaultå‘½ä»¤
åœ¨ä¹‹å‰çš„è®²è§£ä¸­ï¼Œä½¿ç”¨importå¼•å…¥çš„å˜é‡åéœ€è¦å’Œexportå¯¼å‡ºçš„å˜é‡åä¸€æ ·ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¸Œæœ›ä¸è®¾ç½®å˜é‡åä¹Ÿèƒ½ä¾›importä½¿ç”¨ï¼Œimportçš„å˜é‡åç”±ä½¿ç”¨æ–¹è‡ªå®šä¹‰ï¼Œè¿™æ—¶å°±è¦ä½¿ç”¨åˆ°export defaultå‘½ä»¤äº†ã€‚
```js
// export.js
const defaultParam = 1;

export default defaultParam;

// import.js
import param from './export.js';
console.log(param); // 1
```
1. å•æ–‡ä»¶å”¯ä¸€æ€§ 
```js
let defaultParam = 1;

export default defaultParam;
export default 2;  // æŠ›å‡ºå¼‚å¸¸
```
2. importçš„å†…å®¹ä¸éœ€è¦ä½¿ç”¨å¤§æ‹¬å·æ‹¬èµ·æ¥
```js
// è¡¨ç¤ºå¼•å…¥export.jsä¸­é»˜è®¤è¾“å‡ºçš„å€¼
import param from './export.js';  
// è¡¨ç¤ºå¼•å…¥export.jsæ–‡ä»¶ä¸­è¾“å‡ºçš„å˜é‡åä¸ºparamçš„å€¼
import { param } from './export.jsæ–‡ä»¶ä¸­';
```
### ModuleåŠ è½½çš„å®è´¨
> ES6æ¨¡å—çš„è¿è¡Œæœºåˆ¶æ˜¯è¿™æ ·çš„ï¼šå½“é‡åˆ°importå‘½ä»¤æ—¶ï¼Œä¸ä¼šç«‹é©¬å»æ‰§è¡Œæ¨¡å—ï¼Œè€Œæ˜¯ç”Ÿæˆä¸€ä¸ªåŠ¨æ€çš„æ¨¡å—åªè¯»å¼•ç”¨ï¼Œç­‰åˆ°éœ€è¦ç”¨åˆ°æ—¶ï¼Œæ‰å»è§£æå¼•ç”¨å¯¹åº”çš„å€¼ã€‚

ç”±äºES6çš„æ¨¡å—è·å–çš„æ˜¯å®æ—¶å€¼ï¼Œå°±ä¸å­˜åœ¨å˜é‡çš„ç¼“å­˜ã€‚
```js
// export.js
export let counter = 1;
export function incCounter() {
    counter++;
}

// import.js
import { counter, incCounter } from './export7.js';

console.log(counter); // 1
incCounter();
console.log(counter); // 2
```
è¿™è¡¨æ˜å¯¼å…¥çš„å€¼ä»ç„¶ä¸åŸæ¥çš„æ¨¡å—å­˜åœ¨å¼•ç”¨å…³ç³»ï¼Œå¹¶ä¸æ˜¯å®Œå…¨éš”æ–­çš„ã€‚
```js
// è¿™ä¸ªå¼•ç”¨å…³ç³»æ˜¯åªè¯»çš„ï¼Œä¸èƒ½è¢«ä¿®æ”¹ã€‚
import {counter, incCounter} from './export7.js';
console.log(counter); // 1
counter++; // æŠ›å‡ºå¼‚å¸¸
```
å¦‚æœåœ¨å¤šä¸ªæ–‡ä»¶ä¸­å¼•å…¥ç›¸åŒçš„æ¨¡å—ï¼Œåˆ™å®ƒä»¬è·å–çš„æ˜¯åŒä¸€ä¸ªæ¨¡å—çš„å¼•ç”¨ã€‚

åœ¨export.jsæ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªCounteræ¨¡å—ï¼Œå¹¶å¯¼å‡ºä¸€ä¸ªCounterçš„å®ä¾‹ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚
```js
function Counter() {
    this.sum = 0;
    this.add = function () {
        this.sum += 1;
    };
    this.show = function () {
        console.log(this.sum);
    };
}

export let c = new Counter();
```
åœ¨å¦å¤–ä¸¤ä¸ªæ¨¡å—ä¸­åˆ†åˆ«å¯¼å…¥Counteræ¨¡å—ï¼Œå¹¶è¿›è¡Œä¸åŒå¤„ç†ã€‚
```js
// import1.js
import {c} from './export.js';
c.add();

// import2.js
import {c} from './export.js';
c.show();
```
åœ¨ä¸€ä¸ªhtmlæ–‡ä»¶ä¸­å¼•å…¥ä¸¤ä¸ªimportæ–‡ä»¶ã€‚
```js
import './import1.js';
import './import2.js';
```
é€šè¿‡æ§åˆ¶å°å¯ä»¥çœ‹åˆ°ï¼Œç»“æœè¾“å‡ºä¸ºâ€œ1â€ã€‚
å› ä¸ºåœ¨ä¸¤ä¸ªimportæ–‡ä»¶ä¸­ä½¿ç”¨çš„cå˜é‡æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå¼•ç”¨ï¼Œåœ¨import1.jsæ–‡ä»¶ä¸­è°ƒç”¨äº†add()å‡½æ•°ï¼Œå¢åŠ äº†sumå˜é‡çš„å€¼ï¼Œåœ¨import2.jsæ–‡ä»¶ä¸­è¾“å‡ºsumå˜é‡æ—¶ï¼Œå€¼ä¹Ÿå˜ä¸ºäº†1ã€‚
```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```
