# å¯¹è±¡
JavaScriptè™½ç„¶æ˜¯ä¸€é—¨å¼±ç±»å‹è¯­è¨€ï¼Œä½†å®ƒåŒæ ·æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œä¸¥æ ¼æ¥è¯´å®ƒæ˜¯ä¸€é—¨åŸºäºåŸå‹çš„é¢å‘å¯¹è±¡çš„è¯­è¨€ã€‚
## å¯¹è±¡çš„å±æ€§å’Œè®¿é—®æ–¹å¼
### å¯¹è±¡çš„å±æ€§ğŸ‘ğŸ‘ğŸ‘
ECMA-262è§„èŒƒæŠŠå¯¹è±¡å®šä¹‰ä¸ºï¼šæ— åºå±æ€§çš„é›†åˆï¼Œå…¶å±æ€§å€¼å¯ä»¥åŒ…å«åŸºæœ¬ç±»å‹å€¼ã€å¯¹è±¡æˆ–è€…å‡½æ•°ç­‰ã€‚
é€šä¿—ç‚¹è®²ï¼Œå¯¹è±¡æ˜¯ä¸€ç»„é”®å€¼å¯¹çš„é›†åˆï¼Œé”®è¡¨ç¤ºçš„æ˜¯å±æ€§åç§°ï¼Œå€¼è¡¨ç¤ºçš„æ˜¯å±æ€§çš„å€¼ã€‚
#### æ•°æ®å±æ€§
å…·æœ‰4ä¸ªæè¿°å…¶è¡Œä¸ºçš„ç‰¹æ€§ï¼Œå› ä¸ºè¿™äº›ç‰¹æ€§æ˜¯å†…éƒ¨å€¼ï¼Œæ‰€ä»¥ECMA-262è§„èŒƒå°†å…¶æ”¾åœ¨äº†ä¸¤å¯¹æ–¹æ‹¬å·ä¸­ã€‚
- `[[Configurable]]`ï¼šè¡¨ç¤ºå±æ€§èƒ½å¦åˆ é™¤è€Œé‡æ–°å®šä¹‰ï¼Œæˆ–è€…æ˜¯å¦å¯ä»¥ä¿®æ”¹ä¸ºè®¿é—®å™¨å±æ€§ï¼Œé»˜è®¤å€¼ä¸º**true**ã€‚
-  `[[Enumerable]]`ï¼šè¡¨ç¤ºå±æ€§æ˜¯å¦å¯æšä¸¾ï¼Œå¯æšä¸¾çš„å±æ€§èƒ½å¤Ÿé€šè¿‡for...inå¾ªç¯è¿”å›ï¼Œé»˜è®¤å€¼ä¸º**true**ã€‚
-  `[[Writable]]`ï¼šè¡¨ç¤ºå±æ€§å€¼èƒ½å¦è¢«ä¿®æ”¹ï¼Œé»˜è®¤å€¼ä¸º**true**ã€‚
-  `[[Value]]`ï¼šè¡¨ç¤ºå±æ€§çš„çœŸå®å€¼ï¼Œå±æ€§çš„è¯»å–å’Œå†™å…¥å‡é€šè¿‡æ­¤å±æ€§å®Œæˆï¼Œé»˜è®¤å€¼ä¸º**undefined**ã€‚

ä¾‹å¦‚ï¼Œé€šè¿‡ä»¥ä¸‹ä»£ç å®šä¹‰äº†ä¸€ä¸ªåŒ…å«nameå±æ€§çš„å¯¹è±¡personï¼Œnameå±æ€§çš„`[[Configurable]]`ã€`[[Enumerable]]`ã€`[[Writable]]`ç‰¹æ€§å€¼éƒ½ä¸ºtrueï¼Œ`[[Value]]`ç‰¹æ€§å€¼ä¸º'ming'ã€‚
```js
var person = {
  name: "ming"
};
```
å¦‚æœéœ€è¦ä¿®æ”¹æ•°æ®å±æ€§é»˜è®¤çš„ç‰¹æ€§ï¼Œåˆ™å¿…é¡»ä½¿ç”¨Object.defineProperty()å‡½æ•°ï¼Œè¯­æ³•å¦‚ä¸‹ã€‚
```js
Object.defineProperty(target, property, {
  configurable: true,
  enumerable: false,
  writable: false,
  value: 'ming'
});
```
- å…¶ä¸­targetè¡¨ç¤ºç›®æ ‡å¯¹è±¡
- propertyè¡¨ç¤ºå°†è¦ä¿®æ”¹ç‰¹æ€§çš„å±æ€§
- ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæè¿°ç¬¦å¯¹è±¡ï¼Œæè¿°ç¬¦å¯¹è±¡çš„å±æ€§å¿…é¡»ä¸ºconfigurableã€enumerableã€writableã€valueï¼Œä»¥åˆ†åˆ«å¯¹åº”4ä¸ªç‰¹æ€§å€¼ï¼Œå¯ä»¥åŒæ—¶è®¾ç½®å…¶ä¸­ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ã€‚

Demo
```js
var person = {
  name: 'ming'
};
// è®¾ç½®å…¶nameå±æ€§çš„writableå€¼ä¸ºfalseï¼Œè¡¨ç¤ºnameå±æ€§å€¼æ— æ³•è¢«ä¿®æ”¹ã€‚
Object.defineProperty(person, 'name', {
  writable: false,
});
person.name = 'mingli';
console.log(person.name); // 'min'
```
#### è®¿é—®å™¨å±æ€§
è®¿é—®å™¨å±æ€§åŒæ ·åŒ…å«4ä¸ªç‰¹æ€§:
- `[[Configurable]]`ï¼šè¡¨ç¤ºå±æ€§èƒ½å¦åˆ é™¤è€Œé‡æ–°å®šä¹‰ï¼Œæˆ–è€…æ˜¯å¦å¯ä»¥ä¿®æ”¹ä¸ºè®¿é—®å™¨å±æ€§ï¼Œé»˜è®¤å€¼ä¸º**true**ã€‚
- `[[Enumerable]]`ï¼šè¡¨ç¤ºå±æ€§æ˜¯å¦å¯æšä¸¾ï¼Œå¯æšä¸¾çš„å±æ€§èƒ½å¤Ÿé€šè¿‡for...inå¾ªç¯è¿”å›ï¼Œé»˜è®¤å€¼ä¸º**true**ã€‚
- `[[Get]]`ï¼šåœ¨è¯»å–å±æ€§å€¼æ—¶è°ƒç”¨çš„å‡½æ•°ï¼ˆä¸€èˆ¬ç§°ä¸ºgetter()å‡½æ•°ï¼‰ï¼Œè´Ÿè´£è¿”å›æœ‰æ•ˆçš„å€¼ï¼Œé»˜è®¤å€¼ä¸º**undefined**ã€‚
- `[[Set]]`ï¼šåœ¨å†™å…¥å±æ€§å€¼æ—¶è°ƒç”¨çš„å‡½æ•°ï¼ˆä¸€èˆ¬ç§°ä¸ºsetter()å‡½æ•°ï¼‰ï¼Œè´Ÿè´£å¤„ç†æ•°æ®ï¼Œé»˜è®¤å€¼ä¸º**undefined**ã€‚

åŒæ ·ä½¿ç”¨Object.defineProperty()å‡½æ•°

getter()å‡½æ•°å’Œsetter()å‡½æ•°çš„å­˜åœ¨åœ¨ä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥å®ç°å¯¹è±¡çš„ç§æœ‰å±æ€§ï¼Œç§æœ‰å±æ€§ä¸å¯¹å¤–æš´éœ²ã€‚å¦‚æœæƒ³è¦è¯»å–å’Œå†™å…¥ç§æœ‰å±æ€§çš„å€¼ï¼Œåˆ™éœ€è¦é€šè¿‡è®¾ç½®é¢å¤–å±æ€§çš„getter()å‡½æ•°å’Œsetter()å‡½æ•°æ¥å®ç°ï¼Œå…·ä½“å¯ä»¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚
```js
1  var person = {
2     _age: 10
3  };
4  Object.defineProperty(person, "age", {
5      get: function(){
6          return this._age;
7      },
8      set: function(newValue) {
9          if (newValue > 10) {
10             this._age = newValue;
11             console.log('è®¾ç½®æˆåŠŸ');
12     }
13 }
14 });
15 console.log(person.age); // 10
16 person.age = 9; 
17 console.log(person.age); // 10
18 person.age = 19; // â€œè®¾ç½®æˆåŠŸâ€
19 console.log(person.age); // 19
```
### å±æ€§çš„è®¿é—®æ–¹å¼
å¯¹è±¡å±æ€§çš„è®¿é—®æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ç‚¹æ“ä½œç¬¦ï¼ˆ.ï¼‰ï¼Œå¦ä¸€ç§æ˜¯ä½¿ç”¨ä¸­æ‹¬å·æ“ä½œç¬¦ï¼ˆ[]ï¼‰ã€‚
#### ä½¿ç”¨â€œ.â€æ¥è®¿é—®å±æ€§
```js
ObjectName.propertyName // è¯­æ³•
```
å…¶ä¸­objectNameä¸ºå¯¹è±¡åç§°ï¼ŒpropertyNameä¸ºå±æ€§åç§°ã€‚
ä¾‹å¦‚person.nameï¼Œè¡¨ç¤ºè®¿é—®personå¯¹è±¡çš„nameå±æ€§å€¼ã€‚
#### ä½¿ç”¨â€œ[]â€æ¥è®¿é—®å±æ€§
```js
ObjectName[propertyName] // è¯­æ³•
```
ä¸­objectNameä¸ºå¯¹è±¡åç§°ï¼ŒpropertyNameä¸ºå±æ€§åç§°ã€‚
ä¾‹å¦‚person['name']ï¼Œè¡¨ç¤ºè®¿é—®personå¯¹è±¡çš„nameå±æ€§å€¼ã€‚

#### äºŒè€…ä¸åŒä¹‹å¤„
ç¬¬ä¸€ç‚¹ï¼Œç‚¹æ“ä½œç¬¦æ˜¯**é™æ€**çš„ï¼Œåªèƒ½æ˜¯ä¸€ä¸ªä»¥å±æ€§åç§°å‘½åçš„ç®€å•æè¿°ç¬¦ï¼Œè€Œä¸”æ— æ³•ä¿®æ”¹ï¼›è€Œä¸­æ‹¬å·æ“ä½œç¬¦æ˜¯**åŠ¨æ€**çš„ï¼Œå¯ä»¥ä¼ é€’å­—ç¬¦ä¸²æˆ–è€…å˜é‡ï¼Œå¹¶ä¸”æ”¯æŒåœ¨è¿è¡Œæ—¶ä¿®æ”¹ã€‚
```js
var obj = {};
obj.name = 'å¼ ä¸‰';
var myName = 'name';
console.log(obj.myName); // undefined
console.log(obj[myName]); // å¼ ä¸‰
```
ç¬¬äºŒç‚¹ï¼Œç‚¹æ“ä½œç¬¦ä¸èƒ½ä»¥æ•°å­—ä½œä¸ºå±æ€§åï¼Œè€Œä¸­æ‹¬å·æ“ä½œç¬¦å¯ä»¥ã€‚
```js
var obj = {};
obj.1 = 1; // Unexpected number
obj[2] = 2;
console.log(obj.1); // missing ) after argument list
console.log(obj[2]); // 2
```
ç¬¬ä¸‰ç‚¹ï¼Œå¦‚æœå±æ€§åä¸­åŒ…å«ä¼šå¯¼è‡´è¯­æ³•é”™è¯¯çš„å­—ç¬¦ï¼Œæˆ–è€…**å±æ€§åä¸­å«æœ‰å…³é”®å­—æˆ–è€…ä¿ç•™å­—**ï¼Œå¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·æ“ä½œç¬¦ï¼Œè€Œä¸èƒ½ä½¿ç”¨ç‚¹æ“ä½œç¬¦ã€‚
```js
var person = {};
person['first name'] = 'ming';
console.log(person['first name']); // ming
console.log(person.first name); // missing ) after argument list
```
## åˆ›å»ºå¯¹è±¡
åœ¨JavaScriptä¸­ï¼Œ**å¯¹è±¡æ˜¯ä¸€ç³»åˆ—æ— åºå±æ€§çš„é›†åˆ**ï¼Œå±æ€§å€¼å¯ä»¥ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ã€å¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œå› æ­¤å¯¹è±¡å®é™…å°±æ˜¯ä¸€ç»„é”®å€¼å¯¹çš„ç»„åˆã€‚
```js
// å¯¹è±¡
var person = {
  // åŸºæœ¬æ•°æ®ç±»å‹çš„å±æ€§
  name: 'ming', age: 11,
  // å‡½æ•°ç±»å‹çš„å±æ€§
  getName: function () {
    return this.name;
  },
  // å¯¹è±¡ç±»å‹çš„å±æ€§
  address: {
    name: 'åŒ—äº¬å¸‚',
    code: '100000'
  }
};
```
### åŸºäºObject()æ„é€ å‡½æ•°
é€šè¿‡Objectå¯¹è±¡çš„æ„é€ å‡½æ•°ç”Ÿæˆä¸€ä¸ªå®ä¾‹ï¼Œç„¶åç»™å®ƒå¢åŠ éœ€è¦çš„å„ç§å±æ€§ã€‚
```js
// Object()æ„é€ å‡½æ•°ç”Ÿæˆå®ä¾‹
var person = new Object();
// ä¸ºå®ä¾‹æ–°å¢å„ç§å±æ€§
person.name = 'ming';
person.age = 11;
person.getName = function () {
  return this.name;
}
person.address = {
  name: 'åŒ—äº¬å¸‚',
  code: '100000'
}
```
### åŸºäºå¯¹è±¡å­—é¢é‡
å¯¹è±¡å­—é¢é‡æœ¬èº«å°±æ˜¯ä¸€ç³»åˆ—é”®å€¼å¯¹çš„ç»„åˆï¼Œæ¯ä¸ªå±æ€§ä¹‹é—´é€šè¿‡é€—å·åˆ†éš”ã€‚
```js
var person = {
   name: 'kingx',
   age: 11,
   getName: function () {
       return this.name;
   },
   address: {
       name: 'åŒ—äº¬å¸‚',
       code: '100000'
   }
};
```
æ–¹æ³•1ä¸æ–¹æ³•2åœ¨åˆ›å»ºå¯¹è±¡æ—¶éƒ½å…·æœ‰ç›¸åŒçš„ä¼˜ç‚¹ï¼Œå³ç®€å•ã€å®¹æ˜“ç†è§£ã€‚ä½†æ˜¯å¯¹è±¡çš„å±æ€§å€¼æ˜¯é€šè¿‡å¯¹è±¡è‡ªèº«è¿›è¡Œè®¾ç½®çš„ï¼Œå¦‚æœéœ€è¦åŒæ—¶åˆ›å»ºè‹¥å¹²ä¸ªå±æ€§åç›¸åŒï¼Œè€Œåªæ˜¯å±æ€§å€¼ä¸åŒçš„å¯¹è±¡æ—¶ï¼Œåˆ™ä¼šäº§ç”Ÿå¾ˆå¤šçš„é‡å¤ä»£ç ï¼Œé€ æˆä»£ç å†—ä½™ï¼Œå› æ­¤ä¸æ¨èä½¿ç”¨æ–¹æ³•1ä¸æ–¹æ³•2æ¥æ‰¹é‡åˆ›å»ºå¯¹è±¡ã€‚
### åŸºäºå·¥å‚æ–¹æ³•æ¨¡å¼
å·¥å‚æ–¹æ³•æ¨¡å¼æ˜¯ä¸€ç§æ¯”è¾ƒé‡è¦çš„è®¾è®¡æ¨¡å¼ï¼Œç”¨äºåˆ›å»ºå¯¹è±¡ï¼Œæ—¨åœ¨æŠ½è±¡å‡ºåˆ›å»ºå¯¹è±¡å’Œå±æ€§èµ‹å€¼çš„è¿‡ç¨‹ï¼Œåªå¯¹å¤–æš´éœ²å‡ºéœ€è¦è®¾ç½®çš„å±æ€§å€¼ã€‚
```js
// å·¥å‚æ–¹æ³•ï¼Œå¯¹å¤–æš´éœ²æ¥æ”¶çš„nameã€ageã€addresså±æ€§å€¼
function createPerson(name, age, address) {
  // å†…éƒ¨é€šè¿‡Object()æ„é€ å‡½æ•°ç”Ÿæˆä¸€ä¸ªå¯¹è±¡ï¼Œå¹¶æ·»åŠ å„ç§å±æ€§
  var o = new Object();
  o.name = name;
  o.age = age;
  o.address = address;
  o.getName = function () {
    return this.name;
  }
  return o; // è¿”å›åˆ›å»ºçš„å¯¹è±¡
}
var person = createPerson('ming', 11, {
  name: 'åŒ—äº¬å¸‚',
  code: '100000'
});
```
> ä½¿ç”¨å·¥å‚æ–¹æ³•å¯ä»¥å‡å°‘å¾ˆå¤šé‡å¤çš„ä»£ç ï¼Œä½†æ˜¯**åˆ›å»ºçš„æ‰€æœ‰å®ä¾‹éƒ½æ˜¯Objectç±»å‹**ï¼Œæ— æ³•æ›´è¿›ä¸€æ­¥åŒºåˆ†å…·ä½“çš„ç±»å‹ã€‚
### åŸºäºæ„é€ å‡½æ•°æ¨¡å¼
æ„é€ å‡½æ•°æ˜¯é€šè¿‡thisä¸ºå¯¹è±¡æ·»åŠ å±æ€§çš„ï¼Œå±æ€§å€¼ç±»å‹å¯ä»¥ä¸ºåŸºæœ¬ç±»å‹ã€å¯¹è±¡æˆ–è€…å‡½æ•°ï¼Œç„¶åé€šè¿‡newæ“ä½œç¬¦åˆ›å»ºå¯¹è±¡çš„å®ä¾‹ã€‚
```js
function Person(name, age, address) {
  this.name = name;
  this.age = age;
  this.address = address;
  this.getName = function () {
    return this.name;
  }
}
var p = new Person('ming', 11, { name: 'åŒ—äº¬å¸‚', code: '100000' });
console.log(p instanceof Person) // true
```
ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡å¯ä»¥ç¡®å®šå…¶æ‰€å±ç±»å‹ï¼Œè§£å†³äº†å·¥å‚æ–¹æ³•å­˜åœ¨çš„é—®é¢˜ã€‚ä½†æ˜¯ä½¿ç”¨æ„é€ å‡½æ•°åˆ›å»ºçš„å¯¹è±¡å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼Œå³ç›¸åŒå®ä¾‹çš„å‡½æ•°æ˜¯ä¸ä¸€æ ·çš„ã€‚
```js
var p1 = new Person('ming', 11, { name: 'åŒ—äº¬å¸‚', code: '100000' });
var p2 = new Person('ming', 11, { name: 'åŒ—äº¬å¸‚', code: '100000' });
console.log(p1.getName === p2.getName); // false
```
è¿™å°±æ„å‘³ç€æ¯ä¸ªå®ä¾‹çš„å‡½æ•°éƒ½ä¼šå æ®ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼Œå…¶å®è¿™æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œä¼šé€ æˆèµ„æºçš„æµªè´¹ï¼Œå¦å¤–å‡½æ•°ä¹Ÿæ²¡æœ‰å¿…è¦åœ¨ä»£ç æ‰§è¡Œå‰å°±ç»‘å®šåœ¨å¯¹è±¡ä¸Šã€‚
### åŸºäºåŸå‹å¯¹è±¡çš„æ¨¡å¼
åŸºäºåŸå‹å¯¹è±¡çš„æ¨¡å¼æ˜¯å°†æ‰€æœ‰çš„å‡½æ•°å’Œå±æ€§éƒ½å°è£…åœ¨å¯¹è±¡çš„prototypeå±æ€§ä¸Šã€‚
```js
// å®šä¹‰å‡½æ•°
function Person() {}
// é€šè¿‡prototypeå±æ€§å¢åŠ å±æ€§å’Œå‡½æ•°
Person.prototype.name = 'ming';
Person.prototype.age = 11;
Person.prototype.address = {
  name: 'åŒ—äº¬å¸‚',
  code: '100000'
}
Person.prototype.getName = function() {
  return this.name;
}
// ç”Ÿæˆä¸¤ä¸ªå®ä¾‹
var p1 = new Person();
var p2 = new Person();
console.log(p1.name === p2.name); // true
console.log(p1.getName === p2.getName); // true
```
é€šè¿‡ä¸Šé¢çš„ä»£ç å¯ä»¥å‘ç°ï¼Œä½¿ç”¨åŸºäºåŸå‹å¯¹è±¡çš„æ¨¡å¼åˆ›å»ºçš„å®ä¾‹ï¼Œå…¶å±æ€§å’Œå‡½æ•°éƒ½æ˜¯ç›¸ç­‰çš„ï¼Œä¸åŒçš„å®ä¾‹ä¼šå…±äº«åŸå‹ä¸Šçš„å±æ€§å’Œå‡½æ•°ï¼Œè§£å†³äº†åŸºäºæ„é€ å‡½æ•°å­˜åœ¨çš„é—®é¢˜ã€‚

new Q:å› ä¸ºæ‰€æœ‰çš„å®ä¾‹ä¼šå…±äº«ç›¸åŒçš„å±æ€§ï¼Œé‚£ä¹ˆæ”¹å˜å…¶ä¸­ä¸€ä¸ªå®ä¾‹çš„å±æ€§å€¼ï¼Œä¾¿ä¼šå¼•èµ·å…¶ä»–å®ä¾‹çš„å±æ€§å€¼å˜åŒ–
```js
var p1 = new Person();
var p2 = new Person();
console.log(p1.name); // ming
p2.name = 'li';
console.log(p1.name); // li
```
### æ„é€ å‡½æ•°å’ŒåŸå‹æ··åˆçš„æ¨¡å¼
> æ„é€ å‡½æ•°å’ŒåŸå‹æ··åˆçš„æ¨¡å¼æ˜¯ç›®å‰æœ€å¸¸è§çš„åˆ›å»ºè‡ªå®šä¹‰ç±»å‹å¯¹è±¡çš„æ–¹å¼ã€‚

æ„é€ å‡½æ•°ä¸­ç”¨äºå®šä¹‰å®ä¾‹çš„å±æ€§ï¼ŒåŸå‹å¯¹è±¡ä¸­ç”¨äºå®šä¹‰å®ä¾‹å…±äº«çš„å±æ€§å’Œå‡½æ•°ã€‚é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’å‚æ•°ï¼Œè¿™æ ·æ¯ä¸ªå®ä¾‹éƒ½èƒ½æ‹¥æœ‰è‡ªå·±çš„å±æ€§å€¼ï¼ŒåŒæ—¶å®ä¾‹è¿˜èƒ½å…±äº«å‡½æ•°çš„å¼•ç”¨ï¼Œæœ€å¤§é™åº¦åœ°èŠ‚çœäº†å†…å­˜ç©ºé—´ã€‚æ··åˆæ¨¡å¼å¯è°“æ˜¯é›†äºŒè€…ä¹‹æ‰€é•¿ã€‚
```js
// æ„é€ å‡½æ•°ä¸­å®šä¹‰å®ä¾‹çš„å±æ€§
function Person(name, age, address) {
  this.name = name;
  this.age = age;
  this.address = address;
}
// åŸå‹ä¸­æ·»åŠ å®ä¾‹å…±äº«çš„å‡½æ•°
Person.prototype.getName = function () {
  return this.name;
}
// ç”Ÿæˆä¸¤ä¸ªå®ä¾‹
var p1 = new Person('ming', 11, { name: 'åŒ—äº¬å¸‚', code: '100000'} );
var p2 = new Person('ming2', 11, { name: 'ä¸Šæµ·å¸‚', code: '200000'} );
// è¾“å‡ºå®ä¾‹åˆå§‹çš„nameå±æ€§å€¼
console.log(p1.name); // ming
console.log(p2.name); // ming2
// æ”¹å˜ä¸€ä¸ªå®ä¾‹çš„å±æ€§å€¼
person.address.name = 'å¹¿å·å¸‚';
person.address.code = '510000';
// ä¸å½±å“å¦ä¸€ä¸ªå®ä¾‹çš„å±æ€§å€¼
console.log(p2.address.name); // ä¸Šæµ·å¸‚
// ä¸åŒçš„å®ä¾‹å…±äº«ç›¸åŒçš„å‡½æ•°ï¼Œè‹±é›Œåœ¨æ¯”è¾ƒæ—¶æ˜¯ç›¸ç­‰çš„
console.log(p1.getName === p2.getName); // true
// æ”¹å˜ä¸€ä¸ªå®ä¾‹çš„å±æ€§ï¼Œå‡½æ•°ä»ç„¶èƒ½æ­£å¸¸æ‰§è¡Œ
p2.name = 'ming3';
console.log(p1.getName()); // ming
console.log(p2.getName()); // ming3
```
### åŸºäºåŠ¨æ€åŸå‹æ¨¡å¼
åŠ¨æ€åŸå‹æ¨¡å¼æ˜¯å°†åŸå‹å¯¹è±¡æ”¾åœ¨æ„é€ å‡½æ•°å†…éƒ¨ï¼Œé€šè¿‡å˜é‡è¿›è¡Œæ§åˆ¶ï¼Œåªåœ¨ç¬¬ä¸€æ¬¡ç”Ÿæˆå®ä¾‹çš„æ—¶å€™è¿›è¡ŒåŸå‹çš„è®¾ç½®ã€‚
åŠ¨æ€åŸå‹çš„æ¨¡å¼ç›¸å½“äºæ‡’æ±‰æ¨¡å¼ï¼Œåªåœ¨ç”Ÿæˆå®ä¾‹æ—¶è®¾ç½®åŸå‹å¯¹è±¡ï¼Œä½†æ˜¯åŠŸèƒ½ä¸æ„é€ å‡½æ•°å’ŒåŸå‹æ··åˆæ¨¡å¼æ˜¯ç›¸åŒçš„ã€‚
```js
// åŠ¨æ€åŸå‹æ¨¡å¼
function Person(name, age, address) {
  this.name = name;
  this.age = age;
  this.address = address;
}
// å¦‚æœPersonå¯¹è±¡ä¸­_initializedä¸ºundefinedï¼Œåˆ™è¡¨æ˜è¿˜æ²¡æœ‰ä¸ºPersonçš„åŸå‹å¯¹è±¡æ·»åŠ å‡½æ•°
if (typeof Person._initialized === 'undefined') {
  Person.prototype.getName = function () {
    return this.name;
  }
  Person._initialized = true;
}
// ç”Ÿæˆä¸¤ä¸ªå®ä¾‹
var p1 = new Person('ming', 11, { name: 'åŒ—äº¬å¸‚', code: '100000' });
var p2 = new Person('ming2', 11, { name: 'ä¸Šæµ·å¸‚', code: '200000' });
// æ”¹å˜å…¶ä¸­ä¸€ä¸ªå®ä¾‹çš„å±æ€§
p1.address.name = 'å¹¿å·å¸‚';
p1.address.code = '510000';
// ä¸ä¼šå½±å“åˆ°å¦ä¸€ä¸ªå®ä¾‹çš„å±æ€§
console.log(p2.address.name); // ä¸Šæµ·å¸‚
// æ”¹å˜ä¸€ä¸ªå®ä¾‹çš„å±æ€§ï¼Œå‡½æ•°ä»èƒ½æ­£å¸¸æ‰§è¡Œ
p2.name = 'ming3';
console.log(p1.getName()); // ming
console.log(p2.getName()); // ming3
```
## å¯¹è±¡å…‹éš†
å…‹éš†æ˜¯æŒ‡é€šè¿‡ä¸€å®šçš„ç¨‹åºå°†æŸä¸ªå˜é‡çš„å€¼å¤åˆ¶è‡³å¦ä¸€ä¸ªå˜é‡çš„è¿‡ç¨‹ã€‚æ ¹æ®å¤åˆ¶åçš„å˜é‡ä¸åŸå§‹å˜é‡å€¼çš„å½±å“æƒ…å†µï¼Œå…‹éš†å¯ä»¥åˆ†ä¸ºæµ…å…‹éš†å’Œæ·±å…‹éš†ä¸¤ç§æ–¹å¼ã€‚
é’ˆå¯¹ä¸åŒçš„æ•°æ®ç±»å‹ï¼Œæµ…å…‹éš†å’Œæ·±å…‹éš†ä¼šæœ‰ä¸åŒçš„è¡¨ç°ï¼Œä¸»è¦è¡¨ç°äºåŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨æ•°æ®ç±»å‹åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å€¼ä¸åŒã€‚
å¯¹äºåŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ï¼Œå˜é‡å­˜å‚¨çš„æ˜¯å€¼æœ¬èº«ï¼Œå­˜æ”¾åœ¨æ ˆå†…å­˜çš„ç®€å•æ•°æ®æ®µä¸­ï¼Œå¯ä»¥ç›´æ¥è¿›è¡Œè®¿é—®ã€‚
å¯¹äºå¼•ç”¨ç±»å‹çš„å€¼ï¼Œå˜é‡å­˜å‚¨çš„æ˜¯å€¼åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œåœ°å€æŒ‡å‘å†…å­˜ä¸­çš„æŸä¸ªä½ç½®ã€‚å¦‚æœæœ‰å¤šä¸ªå˜é‡åŒæ—¶æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ï¼Œåˆ™å…¶ä¸­ä¸€ä¸ªå˜é‡å¯¹å€¼è¿›è¡Œä¿®æ”¹æ—¶ï¼Œä¼šå½±å“åˆ°å…¶ä»–çš„å˜é‡ã€‚
ä»¥æ•°ç»„ä¸ºä¾‹æ¥çœ‹çœ‹å®é™…æ•ˆæœã€‚
```js
var arr1 = [1, 2, 3];
var arr2 = arr1;
arr2[1] = 4;
console.log(arr1); // [1, 4, 3];
console.log(arr2); // [1, 4, 3];
```
å°†arr1å’Œarr2è¿™ä¸¤ä¸ªå˜é‡æŒ‡å‘åŒä¸€ä¸ªæ•°ç»„ï¼Œå¯¹arr2å˜é‡å€¼çš„ä¿®æ”¹ï¼Œä¼šå¯¼è‡´arr1å˜é‡å€¼çš„å˜åŒ–ï¼Œæœ€åè¾“å‡ºçš„arr1ä¸arr2å˜é‡å€¼éƒ½ä¼šè¢«ä¿®æ”¹ã€‚
æ­£æ˜¯ç”±äºæ•°æ®ç±»å‹çš„å·®å¼‚æ€§ï¼Œè¿™ä¼šå¯¼è‡´å®ƒä»¬åœ¨æµ…å…‹éš†å’Œæ·±å…‹éš†çš„è¡¨ç°ä¸Šä¸åŒï¼ŒåŸºæœ¬æ•°æ®ç±»å‹ä¸ç®¡æ˜¯æµ…å…‹éš†è¿˜æ˜¯æ·±å…‹éš†éƒ½æ˜¯å¯¹å€¼æœ¬èº«çš„å…‹éš†ï¼Œå¯¹å…‹éš†åå€¼çš„ä¿®æ”¹ä¸ä¼šå½±å“åˆ°åŸå§‹å€¼ã€‚
å¼•ç”¨æ•°æ®ç±»å‹å¦‚æœæ‰§è¡Œçš„æ˜¯æµ…å…‹éš†ï¼Œå¯¹å…‹éš†åå€¼çš„ä¿®æ”¹ä¼šå½±å“åˆ°åŸå§‹å€¼ï¼›å¦‚æœæ‰§è¡Œçš„æ˜¯æ·±å…‹éš†ï¼Œåˆ™å…‹éš†çš„å¯¹è±¡å’ŒåŸå§‹å¯¹è±¡ç›¸äº’ç‹¬ç«‹ï¼Œä¸ä¼šå½¼æ­¤å½±å“ã€‚
### æµ…å…‹éš†
æµ…å…‹éš†ç”±äºåªå…‹éš†å¯¹è±¡æœ€å¤–å±‚çš„å±æ€§ï¼Œå¦‚æœå¯¹è±¡å­˜åœ¨æ›´æ·±å±‚çš„å±æ€§ï¼Œåˆ™ä¸è¿›è¡Œå¤„ç†ï¼Œè¿™å°±ä¼šå¯¼è‡´å…‹éš†å¯¹è±¡å’ŒåŸå§‹å¯¹è±¡çš„æ·±å±‚å±æ€§ä»ç„¶æŒ‡å‘åŒä¸€å—å†…å­˜ã€‚
#### ç®€å•çš„å¼•ç”¨å¤åˆ¶
å³éå†å¯¹è±¡æœ€å¤–å±‚çš„æ‰€æœ‰å±æ€§ï¼Œç›´æ¥å°†å±æ€§å€¼å¤åˆ¶åˆ°å¦ä¸€ä¸ªå˜é‡ä¸­ã€‚
```js
function shallowClone(origin) {
  var result = {};
  // éå†æœ€å¤–å±‚å±æ€§
  for (var key in origin) {
    // åˆ¤æ–­æ˜¯å¦æ˜¯å¯¹è±¡è‡ªèº«çš„å±æ€§
    if (origin.hasOwnProperty(key)) {
      result[key] = origin[key];
    }
  }
  return result;
}
```
å®šä¹‰ä¸€ä¸ªå…·æœ‰å¤åˆå±æ€§çš„å¯¹è±¡ï¼Œå¹¶è¿›è¡Œæµ‹è¯•ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹ã€‚
```js
// åŸå§‹å¯¹è±¡
var origin = {
   a: 1,
   b: [2, 3, 4],
   c: {
      d: 'name'
   }
};
// å…‹éš†åçš„å¯¹è±¡
var result = shallowClone(origin);
console.log(origin);  // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }
console.log(result);  // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }
// å…‹éš†åçš„å¯¹è±¡çš„å€¼ä¸åŸå§‹å¯¹è±¡çš„å€¼ç›¸åŒ
```
#### ES6çš„Object.assign()å‡½æ•°
ç”¨äºå°†æºå¯¹è±¡çš„å¯æšä¸¾å±æ€§å¤åˆ¶åˆ°ç›®æ ‡å¯¹è±¡ä¸­ã€‚
```js
var origin = {
   a: 1,
   b: [2, 3, 4],
   c: {
      d: 'name'
   }
};
// é€šè¿‡Object.assign()å‡½æ•°å…‹éš†å¯¹è±¡
var result = Object.assign({}, origin);
console.log(origin);  // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }
console.log(result);  // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }
```
æµ…å…‹éš†å®ç°æ–¹æ¡ˆéƒ½ä¼šå­˜åœ¨ä¸€ä¸ªç›¸åŒçš„é—®é¢˜ï¼Œå³å¦‚æœåŸå§‹å¯¹è±¡æ˜¯å¼•ç”¨æ•°æ®ç±»å‹çš„å€¼ï¼Œåˆ™å¯¹å…‹éš†å¯¹è±¡çš„å€¼çš„ä¿®æ”¹ä¼šå½±å“åˆ°åŸå§‹å¯¹è±¡çš„å€¼ã€‚
```js
// ä¿®æ”¹å…‹éš†å¯¹è±¡çš„å†…éƒ¨å±æ€§
result.c.d = 'city';
console.log(origin); // { a: 1, b: [ 2, 3, 4 ], c: { d: 'city' } }
console.log(result); // { a: 1, b: [ 2, 3, 4 ], c: { d: 'city' } }
```
### æ·±å…‹éš†
#### JSONåºåˆ—åŒ–å’Œååºåˆ—åŒ–ğŸ‘ğŸ‘ğŸ‘
**å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸­çš„å…¨éƒ¨å±æ€§éƒ½æ˜¯å¯ä»¥åºåˆ—åŒ–çš„**ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨JSON.stringify()å‡½æ•°å°†åŸå§‹å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œå†ä½¿ç”¨JSON.parse()å‡½æ•°å°†å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ ·å¾—åˆ°çš„å¯¹è±¡å°±æ˜¯æ·±å…‹éš†åçš„å¯¹è±¡ã€‚
```js
var origin = {
   a: 1,
   b: [2, 3, 4],
   c: {
       d: 'name'
   }
};
// å…ˆååºåˆ—åŒ–ä¸ºå­—ç¬¦ä¸²ï¼Œå†åºåˆ—åŒ–ä¸ºå¯¹è±¡ï¼Œå¾—åˆ°æ·±å…‹éš†åçš„å¯¹è±¡
var result = JSON.parse(JSON.stringify(origin));
console.log(origin); // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }
console.log(result); // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }
```
è¿™ç§æ–¹æ³•èƒ½å¤Ÿè§£å†³å¤§éƒ¨åˆ†JSONç±»å‹å¯¹è±¡çš„æ·±å…‹éš†é—®é¢˜ï¼Œä½†æ˜¯å¯¹äºä»¥ä¸‹å‡ ä¸ªé—®é¢˜ä¸èƒ½å¾ˆå¥½åœ°è§£å†³ã€‚
- æ— æ³•å®ç°å¯¹å‡½æ•°ã€RegExpç­‰ç‰¹æ®Šå¯¹è±¡çš„å…‹éš†ã€‚
- å¯¹è±¡çš„constructorä¼šè¢«æŠ›å¼ƒï¼Œæ‰€æœ‰çš„æ„é€ å‡½æ•°ä¼šæŒ‡å‘Objectï¼ŒåŸå‹é“¾å…³ç³»æ–­è£‚ã€‚
- å¯¹è±¡ä¸­å¦‚æœå­˜åœ¨å¾ªç¯å¼•ç”¨ï¼Œä¼šæŠ›å‡ºå¼‚å¸¸ã€‚

å®šä¹‰ä¸€ä¸ªåŸå§‹å¯¹è±¡ï¼Œå…¶ä¸­ä¸€ä¸ªå±æ€§ä¸ºå‡½æ•°ï¼Œä¸€ä¸ªå±æ€§ä¸ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ï¼Œä¸€ä¸ªå±æ€§ä¸ºæŸä¸ªå¯¹è±¡çš„å®ä¾‹ã€‚
```js
function Animal(name) {
  this.name = name;
}
var animal = new Animal('dog');
// åŸå§‹å¯¹è±¡
var origin = {
  // å±æ€§ä¸ºå‡½æ•°
  a: function () {
    return 'a';
  },
  // å±æ€§ä¸ºæ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡
  b: new RegExp('\d', 'g'),
  // å±æ€§ä¸ºæŸä¸ªå¯¹è±¡çš„å®ä¾‹
  c: animal
}
var result = JSON.parse(JSON.stringify(origin));
console.log(origin); // { a: [Function: a], b: /d/g, c: Animal { name: 'dog'}}
console.log(result); // { b: {}, c: { name: 'dog' }}
console.log(origin.c.constructor) // [Function: Animal]
console.log(result.c.constructor) // [Function: Object]
```
ä»å¾—åˆ°çš„ç»“æœä¸­ï¼ŒéªŒè¯äº†ä¸Šè¿°çš„è§‚ç‚¹ã€‚
- å€¼ä¸ºFunctionç±»å‹çš„aå±æ€§ä¸¢å¤±ã€‚
- bå±æ€§åº”è¯¥ä¸ºä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨å…‹éš†åå¾—åˆ°çš„æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ã€‚
- cå±æ€§å€¼è™½ç„¶éƒ½æ˜¯ä¸€ä¸ªå…·æœ‰nameå±æ€§çš„å¯¹è±¡ï¼Œä½†æ˜¯å…‹éš†åå¯¹è±¡çš„cå±æ€§å€¼å¯¹è±¡çš„æ„é€ å‡½æ•°å´ä¸å†æŒ‡å‘Animalï¼Œè€Œæ˜¯æŒ‡å‘Objectï¼Œæ„é€ å‡½æ•°è¢«ä¸¢å¤±ï¼Œå¯¼è‡´åŸå‹é“¾å…³ç³»çš„æ–­è£‚ã€‚

å…³äºå¾ªç¯å¼•ç”¨ï¼ŒåŒæ ·åˆ—ä¸¾ä¸€ä¸ªç‰¹å®šçš„å®ä¾‹ã€‚
å®šä¹‰ä¸€ä¸ªåŸå§‹å¯¹è±¡ï¼Œä¸ºåŸå§‹å¯¹è±¡æ·»åŠ ä¸€ä¸ªå±æ€§æŒ‡å‘è‡ªèº«ï¼Œå½¢æˆå¾ªç¯å¼•ç”¨ã€‚
```js
var origin = {
   a: 'name'
};
origin.b = origin;
// TypeError: Converting circular structure to JSON
var result = JSON.parse(JSON.stringify(origin));
```
å½“åœ¨è°ƒç”¨JSON.stringify(origin)æ—¶ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè¡¨ç¤ºâ€œå¾ªç¯å¼•ç”¨çš„ç»“æ„æ— æ³•åºåˆ—åŒ–æˆJSONå­—ç¬¦ä¸²â€ã€‚
#### è‡ªå®šä¹‰å®ç°æ·±å…‹éš†
åœ¨è‡ªå®šä¹‰å®ç°æ·±å…‹éš†æ—¶ï¼Œéœ€è¦é’ˆå¯¹ä¸åŒçš„æ•°æ®ç±»å‹åšé’ˆå¯¹æ€§çš„å¤„ç†ï¼Œå› æ­¤æˆ‘ä»¬ä¼šå…ˆå®ç°åˆ¤æ–­æ•°æ®ç±»å‹çš„å‡½æ•°ï¼Œå¹¶å°†æ‰€æœ‰å‡½æ•°å°è£…åœ¨ä¸€ä¸ªè¾…åŠ©ç±»å¯¹è±¡ä¸­ï¼Œè¿™é‡Œç”¨â€œ_â€è¡¨ç¤ºï¼ˆç±»ä¼¼äºunderscoreç±»åº“å¯¹å¤–æš´éœ²çš„å¯¹è±¡ï¼‰ã€‚
```js
/**
 * ç±»å‹åˆ¤æ–­
 */
(function(_) {
  // åˆ—ä¸¾å¯èƒ½å­˜åœ¨çš„æ•°æ®ç±»å‹
  var types = 'Array Object String Date RegExp Function Boolean Number Null Undefined Symbol Null'.split(' ');
  function type() {
    // é€šè¿‡è°ƒç”¨toStringå‡½æ•°ï¼Œä»ç´¢å¼•ä¸º8æ—¶æˆªå–å­—ç¬¦ä¸²ï¼Œå¾—åˆ°æ•°æ®ç±»å‹çš„å€¼
    return Object.prototype.toString.call(this).slice(8, -1);
  }
  for (var i = types.length; i--;) {
    _['is' + types[i]] = (function( self) {
      return function (elem) {
        return type.call(elem) === self;
      }
    })(types[i]);
  }
  return _;
})(_ = {});
```
æ‰§è¡Œä¸Šé¢çš„ä»£ç åï¼Œ_ å¯¹è±¡ä¾¿å…·æœ‰äº†isArray()å‡½æ•°ã€isObject()å‡½æ•°ç­‰ä¸€ç³»åˆ—åˆ¤æ–­æ•°æ®ç±»å‹çš„å‡½æ•°ã€‚ç„¶åå†è°ƒç”¨_.isArray(param)å‡½æ•°åˆ¤æ–­paramæ˜¯å¦æ˜¯æ•°ç»„ç±»å‹ã€è°ƒç”¨_.isObject(param)å‡½æ•°åˆ¤æ–­paramæ˜¯å¦æ˜¯å¯¹è±¡ç±»å‹ã€‚
```js
/**
 * æ·±å…‹éš†å®ç°æ–¹æ¡ˆ
 * @param source å¾…å…‹éš†çš„å¯¹è±¡
 * @returns {*} è¿”å›å…‹éš†åçš„å¯¹è±¡
 */
function deepClone(source) {
  // ç»´æŠ¤ä¸¤ä¸ªå­˜å‚¨å¾ªç¯å¼•ç”¨çš„æ•°ç»„
  var parents = [];
  var children = [];
  // ç”¨äºè·å¾—æ­£åˆ™è¡¨è¾¾å¼çš„ä¿®é¥°ç¬¦, /igm
  function getRegExp(reg) {
    var result = '';
    if (reg.ignoreCase) {
      result += 'i';
    }
    if (reg.global) {
      result += 'g';
    }
    if (reg.multiline) {
      result += 'm';
    }
    return result;
  }
  // ä¾¿äºé€’å½’çš„_cloneå‡½æ•°
  function _clone(parent) {
    if (parent === null) return null;
    if (typeof parent !== 'object') return parent;
    var child, proto;
    // å¯¹æ•°ç»„åšç‰¹æ®Šå¤„ç†
    if (_.isArray(parent)) {
      child = [];
    } else if(_.isRegExp(parent)) {
      // å¯¹æ­£åˆ™å¯¹è±¡åšç‰¹æ®Šå¤„ç†
      child = new RegExp(parent.source, getRegExp(parent));
      if (parent.lastIndex) child.lastIndex = parent.lastIndex;
    } else if (_.isDate(parent)) {
      // å¯¹Dateå¯¹è±¡åšç‰¹æ®Šå¤„ç†
      child = new Date(parent.getTime());
    } else {
      // å¤„ç†å¯¹è±¡åŸå‹
      proto = Object.getPrototypeOf(parent);
      // åˆ©ç”¨Object.create)åˆ‡æ¢åŸå‹é“¾
      child = Object.create(proto);
    }
    // å¤„ç†å¾ªç¯å¼•ç”¨
    var index = parents.indexOf(parent);
    if (index !== -1) {
      // å¦‚æœçˆ¶æ•°ç»„å­˜åœ¨æœ¬å¯¹è±¡ï¼Œè¯´æ˜ä¹‹å‰å·²ç»è¢«å¼•ç”¨è¿‡ï¼Œç›´æ¥è¿”å›æ­¤å¯¹è±¡
      return children[index];
    }
    // æ²¡æœ‰å¼•ç”¨è¿‡ï¼Œåˆ™æ·»åŠ è‡³parentså’Œchildrenæ•°ç»„ä¸­
    parents.push(parent);
    children.push(child);
    // éå†å¯¹è±¡å±æ€§
    for (var prop in parent) {
      if (parent.hasOwnProperty(prop)) {
        // é€’å½’å¤„ç†
        child[prop] = _clone(parent[prop]);
      }
    }
    return child;
  }
  return _clone(source);
}
// é¦–å…ˆæ˜¯ä½¿ç”¨æœ€åŸºæœ¬çš„JSONæ ¼å¼å¯¹è±¡è¿›è¡Œæµ‹è¯•ã€‚
var origin = {
   a: 1,
   b: [2, 3, 4],
   c: {
       d: 'name'
   }
};
var result = deepClone(origin);
console.log(origin); // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }
console.log(result); // { a: 1, b: [ 2, 3, 4 ], c: { d: 'name' } }

// ä½¿ç”¨å…·æœ‰Functionç±»å‹å±æ€§ã€RegExpç±»å‹å±æ€§ã€å®ä¾‹å±æ€§çš„å¯¹è±¡è¿›è¡Œæµ‹è¯•ã€‚
function Animal(name) {
   this.name = name;
}
var animal = new Animal('tom');
var origin = {
   a: function () {
       return 'a';
   },
   b: new RegExp('\d', 'g'),
   c: animal
};
var result = deepClone(origin);
console.log(origin); // { a: [Function: a], b: /d/g, c: Animal { name: 'tom' } }
console.log(result); // { a: [Function: a], b: /d/g, c: Animal { name: 'tom' } }

// æœ€åæ˜¯ä½¿ç”¨å…·æœ‰å¾ªç¯å¼•ç”¨å±æ€§çš„å¯¹è±¡è¿›è¡Œæµ‹è¯•ã€‚
var origin = {
   a: 'name'
};
origin.b = origin;
var result = deepClone(origin);
console.log(origin); // { a: 'name', b: [Circular] }
console.log(result); // { a: 'name', b: [Circular] }
```
#### jQueryå®ç°â€”â€”$.clone()å‡½æ•°å’Œ$.extend()
åœ¨jQueryä¸­æä¾›äº†ä¸€ä¸ª$.clone()å‡½æ•°ï¼Œä½†æ˜¯å®ƒæ˜¯ç”¨äºå¤åˆ¶DOMå¯¹è±¡çš„ã€‚
çœŸæ­£ç”¨äºå®ç°å…‹éš†çš„å‡½æ•°æ˜¯$.extend()ï¼Œä¸‹é¢æ¥çœ‹çœ‹å¯¹åº”çš„æºç 
```js
jQuery.extend = jQuery.fn.extend = function() {
    // optionsæ˜¯ä¸€ä¸ªç¼“å­˜å˜é‡ï¼Œç”¨æ¥ç¼“å­˜arguments[i]ï¼Œ
    // nameæ˜¯ç”¨æ¥æ¥æ”¶å°†è¦è¢«æ‰©å±•å¯¹è±¡çš„keyï¼Œsrcæ”¹å˜ä¹‹å‰targetå¯¹è±¡ä¸Šæ¯ä¸ªkeyå¯¹åº”çš„value
    // copyä¼ å…¥å¯¹è±¡ä¸Šæ¯ä¸ªkeyå¯¹åº”çš„valueï¼ŒcopyIsArrayåˆ¤å®šcopyæ˜¯å¦ä¸ºä¸€ä¸ªæ•°ç»„
    // cloneæ·±å…‹éš†ä¸­ç”¨æ¥ä¸´æ—¶å­˜å¯¹è±¡æˆ–æ•°ç»„çš„src
    var src, copyIsArray, copy, name, options, clone,
        target = arguments[0] || {},
        i = 1,
        length = arguments.length,
        deep = false;

     // å¦‚æœä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºbooleanç±»å‹ï¼Œä¸ºtrueä»£è¡¨æ·±å…‹éš†ï¼Œä¸ºfalseä»£è¡¨æµ…å…‹éš†
    if ( typeof target === "boolean" ) {
        deep = target;
        // å¦‚æœä¼ é€’äº†ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºbooleanå€¼ï¼Œåˆ™å¾…å…‹éš†çš„å¯¹è±¡ä¸ºç¬¬äºŒä¸ªå‚æ•°
        target = arguments[ i ] || {};
        i++;
    }
    // å¦‚æœæ˜¯ç®€å•ç±»å‹æ•°æ®
    if ( typeof target !== "object" && !jQuery.isFunction(target) ) {
        target = {};
    }
    // å¦‚æœåªä¼ é€’ä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆå…‹éš†çš„æ˜¯jQueryè‡ªèº«
    if ( i === length ) {
        target = this;
        i--;
    }
    for ( ; i < length; i++ ) {
        // ä»…éœ€è¦å¤„ç†ä¸æ˜¯nullä¸undefinedç±»å‹çš„æ•°æ®
        if ( (options = arguments[ i ]) != null ) {
            // éå†å¯¹è±¡çš„æ‰€æœ‰å±æ€§
            for ( name in options ) {
                src = target[ name ];
                copy = options[ name ];
                // é˜»æ­¢å¾ªç¯å¼•ç”¨
                if ( target === copy ) {
                    continue;
                }

                // é€’å½’å¤„ç†å¯¹è±¡å’Œæ•°ç»„
                if ( deep && copy && ( jQuery.isPlainObject(copy)                   || (copyIsArray = jQuery.isArray(copy)) ) ) {
                    if ( copyIsArray ) {
                        copyIsArray = false;
                        clone = src && jQuery.isArray(src) ? src : [];
                    } else {
                        clone = src && jQuery.isPlainObject(src) ? src : {};
                    }
                    // å°†åŸå§‹å€¼çš„nameå±æ€§å€¼èµ‹ç»™targetç›®æ ‡å¯¹è±¡
                    target[ name ] = jQuery.extend( deep, clone, copy );
                } else if ( copy !== undeï¬ned ) {
                  // å¯¹äºç®€å•ç±»å‹ï¼Œç›´æ¥èµ‹å€¼
                    target[ name ] = copy;
                }
            }
        }
   }
   // è¿”å›cloneåçš„ç›®æ ‡å¯¹è±¡
   return target;
};
```
ä½¿ç”¨$.extend()å‡½æ•°å¯ä»¥å®ç°å‡½æ•°ä¸æ­£åˆ™è¡¨è¾¾å¼ç­‰ç±»å‹çš„å…‹éš†ï¼Œè¿˜èƒ½ä¿æŒå…‹éš†å¯¹è±¡çš„åŸå‹é“¾å…³ç³»ï¼Œè§£å†³äº†æ·±å…‹éš†ä¸­å­˜åœ¨çš„3ä¸ªé—®é¢˜ä¸­çš„å‰ä¸¤ä¸ªï¼Œä½†æ˜¯å´æ— æ³•è§£å†³å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚
```js
var origin = {};
origin.d = origin;
var result = $.extend(true, {}, origin); // Uncaught RangeError: Maximum call stack size exceeded
```
## åŸå‹å¯¹è±¡
æ¯ä¸€ä¸ªå‡½æ•°åœ¨åˆ›å»ºæ—¶éƒ½ä¼šè¢«èµ‹äºˆä¸€ä¸ªprototypeå±æ€§ï¼Œå®ƒæŒ‡å‘å‡½æ•°çš„åŸå‹å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥åŒ…å«æ‰€æœ‰å®ä¾‹å…±äº«çš„å±æ€§å’Œå‡½æ•°ã€‚å› æ­¤åœ¨ä½¿ç”¨prototypeå±æ€§åï¼Œå°±å¯ä»¥å°†å®ä¾‹å…±äº«çš„å±æ€§å’Œå‡½æ•°æŠ½ç¦»å‡ºæ„é€ å‡½æ•°ï¼Œå°†å®ƒä»¬æ·»åŠ åœ¨prototypeå±æ€§ä¸­ã€‚
### åŸå‹å¯¹è±¡ã€æ„é€ å‡½æ•°ã€å®ä¾‹ä¹‹é—´çš„å…³ç³»
æ„é€ å‡½æ•°çš„prototypeå±æ€§ä¼šæŒ‡å‘å®ƒçš„åŸå‹å¯¹è±¡ï¼Œè€Œé€šè¿‡æ„é€ å‡½æ•°å¯ä»¥ç”Ÿæˆå…·ä½“çš„å®ä¾‹ã€‚
è¿™é‡Œå°±ä¼šæ¶‰åŠ3ä¸ªæ¦‚å¿µï¼Œåˆ†åˆ«æ˜¯æ„é€ å‡½æ•°ã€åŸå‹å¯¹è±¡å’Œå®ä¾‹ã€‚
- åŸå‹å¯¹è±¡ã€æ„é€ å‡½æ•°å’Œå®ä¾‹ä¹‹é—´çš„å…³ç³»æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ
- ä½¿ç”¨åŸå‹å¯¹è±¡åˆ›å»ºäº†å¯¹è±¡çš„å®ä¾‹åï¼Œå®ä¾‹çš„å±æ€§è¯»å–é¡ºåºæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ
- å‡å¦‚é‡å†™äº†åŸå‹å¯¹è±¡ï¼Œä¼šå¸¦æ¥ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Ÿ
```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```

```js

```
